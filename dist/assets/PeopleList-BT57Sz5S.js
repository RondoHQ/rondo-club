import{r as c,e as ss,c as le,j as e,L as Le}from"./vendor-CjdX6t1i.js";import{f as ts,g as as,h as rs,i as ls,j as Ae,k as M,X as C,P as ne,l as ns,L as $e,U as oe,B as De,m as is,e as Be,w as ie}from"./main-D6r1FXj6.js";import{A as Fe,a as We,T as Oe,M as cs}from"./tag-CobQv4bH.js";import{F as Me}from"./filter-Bd647nZv.js";import{S as ce}from"./star-DEP2JXYW.js";import{S as Pe}from"./square-CumeHu_S.js";import"./utils-D5Yy9kBW.js";function ze(l){var u;const f=((u=l.acf)==null?void 0:u.work_history)||[];if(f.length===0)return null;const d=f.find(o=>o.is_current&&o.company);if(d)return d.company;const y=f.filter(o=>o.company).sort((o,n)=>{const g=o.start_date?new Date(o.start_date):new Date(0);return(n.start_date?new Date(n.start_date):new Date(0))-g});return y.length>0?y[0].company:null}function os({person:l,companyName:f,workspaces:d,isSelected:y,onToggleSelection:u,isOdd:o}){var i,x;const g=(((i=l.acf)==null?void 0:i._assigned_workspaces)||[]).map(r=>{const p=typeof r=="string"?parseInt(r,10):r,h=d.find(_=>_.id===p);return h==null?void 0:h.title}).filter(Boolean).join(", ");return e.jsxs("tr",{className:`hover:bg-gray-100 ${o?"bg-gray-50":"bg-white"}`,children:[e.jsx("td",{className:"pl-4 pr-2 py-3 w-10",children:e.jsx("button",{onClick:r=>{r.preventDefault(),u(l.id)},className:"text-gray-400 hover:text-gray-600",children:y?e.jsx(Be,{className:"w-5 h-5 text-primary-600"}):e.jsx(Pe,{className:"w-5 h-5"})})}),e.jsx("td",{className:"w-10 px-2 py-3",children:e.jsx(Le,{to:`/people/${l.id}`,className:"flex items-center justify-center",children:l.thumbnail?e.jsx("img",{src:l.thumbnail,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-500",children:((x=l.first_name)==null?void 0:x[0])||"?"})})})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs(Le,{to:`/people/${l.id}`,className:"flex items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[l.first_name||"",l.is_deceased&&e.jsx("span",{className:"ml-1 text-gray-500",children:"â€ "})]}),l.is_favorite&&e.jsx(ce,{className:"w-4 h-4 ml-1 text-yellow-400 fill-current"})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:l.last_name||"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:f||"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:g||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:l.labels&&l.labels.length>0?e.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.labels.slice(0,3).map(r=>e.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-600",children:r},r)),l.labels.length>3&&e.jsxs("span",{className:"text-xs text-gray-400",children:["+",l.labels.length-3," more"]})]}):"-"})]})}function W({field:l,label:f,currentSortField:d,currentSortOrder:y,onSort:u}){const o=d===l;return e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:e.jsxs("button",{onClick:()=>u(l),className:"flex items-center gap-1 hover:text-gray-700 cursor-pointer",children:[f,o&&(y==="asc"?e.jsx(Fe,{className:"w-3 h-3"}):e.jsx(We,{className:"w-3 h-3"}))]})})}function ds({people:l,companyMap:f,workspaces:d,selectedIds:y,onToggleSelection:u,onToggleSelectAll:o,isAllSelected:n,isSomeSelected:g,sortField:i,sortOrder:x,onSort:r}){return e.jsx("div",{className:"card overflow-x-auto max-h-[calc(100vh-12rem)] overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{className:"shadow-sm",children:[e.jsx("th",{scope:"col",className:"pl-4 pr-2 py-3 w-10 bg-gray-50",children:e.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",title:n?"Deselect all":"Select all",children:n?e.jsx(Be,{className:"w-5 h-5 text-primary-600"}):g?e.jsx(cs,{className:"w-5 h-5 text-primary-600"}):e.jsx(Pe,{className:"w-5 h-5"})})}),e.jsx("th",{scope:"col",className:"w-10 px-2 bg-gray-50"}),e.jsx(W,{field:"first_name",label:"First Name",currentSortField:i,currentSortOrder:x,onSort:r}),e.jsx(W,{field:"last_name",label:"Last Name",currentSortField:i,currentSortOrder:x,onSort:r}),e.jsx(W,{field:"organization",label:"Organization",currentSortField:i,currentSortOrder:x,onSort:r}),e.jsx(W,{field:"workspace",label:"Workspace",currentSortField:i,currentSortOrder:x,onSort:r}),e.jsx(W,{field:"labels",label:"Labels",currentSortField:i,currentSortOrder:x,onSort:r})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:l.map((p,h)=>e.jsx(os,{person:p,companyName:f[p.id],workspaces:d,isSelected:y.has(p.id),onToggleSelection:u,isOdd:h%2===1},p.id))})]})})}function ms({isOpen:l,onClose:f,selectedCount:d,onSubmit:y,isLoading:u}){const[o,n]=c.useState("private");if(c.useEffect(()=>{l&&n("private")},[l]),!l)return null;const g=[{value:"private",label:"Private",description:"Only you can see these contacts",icon:$e},{value:"workspace",label:"Workspace",description:"Share with workspace members",icon:oe}];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Change Visibility"}),e.jsx("button",{onClick:f,className:"text-gray-400 hover:text-gray-600",disabled:u,children:e.jsx(C,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Select visibility for ",d," ",d===1?"person":"people",":"]}),e.jsx("div",{className:"space-y-2",children:g.map(i=>{const x=i.icon,r=o===i.value;return e.jsxs("button",{type:"button",onClick:()=>n(i.value),disabled:u,className:`w-full flex items-start gap-3 p-3 rounded-lg border-2 text-left transition-colors ${r?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(x,{className:`w-5 h-5 mt-0.5 ${r?"text-primary-600":"text-gray-400"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`text-sm font-medium ${r?"text-primary-900":"text-gray-900"}`,children:i.label}),e.jsx("div",{className:"text-xs text-gray-500",children:i.description})]}),r&&e.jsx(M,{className:"w-5 h-5 text-primary-600 mt-0.5"})]},i.value)})})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:f,className:"btn-secondary",disabled:u,children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>y(o),className:"btn-primary",disabled:u,children:u?"Applying...":`Apply to ${d} ${d===1?"person":"people"}`})]})]})})}function xs({isOpen:l,onClose:f,selectedCount:d,workspaces:y,onSubmit:u,isLoading:o}){const[n,g]=c.useState([]);if(c.useEffect(()=>{l&&g([])},[l]),!l)return null;const i=x=>{g(r=>r.includes(x)?r.filter(p=>p!==x):[...r,x])};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Assign to Workspace"}),e.jsx("button",{onClick:f,className:"text-gray-400 hover:text-gray-600",disabled:o,children:e.jsx(C,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Select workspaces for ",d," ",d===1?"person":"people",":"]}),y.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(oe,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"No workspaces available."}),e.jsx("p",{className:"text-xs",children:"Create a workspace first to use this feature."})]}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:y.map(x=>{const r=n.includes(x.id);return e.jsxs("button",{type:"button",onClick:()=>i(x.id),disabled:o,className:`w-full flex items-center gap-3 p-3 rounded-lg border-2 text-left transition-colors ${r?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:`flex items-center justify-center w-5 h-5 border-2 rounded ${r?"bg-primary-600 border-primary-600":"border-gray-300"}`,children:r&&e.jsx(M,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:[x.member_count," members"]})]})]},x.id)})})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:f,className:"btn-secondary",disabled:o,children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>u(n),className:"btn-primary",disabled:o||y.length===0,children:o?"Assigning...":`Assign to ${d} ${d===1?"person":"people"}`})]})]})})}function us({isOpen:l,onClose:f,selectedCount:d,companies:y,onSubmit:u,isLoading:o}){const[n,g]=c.useState(null),[i,x]=c.useState("");if(c.useEffect(()=>{l&&(g(null),x(""))},[l]),!l)return null;const r=(y||[]).filter(p=>p.name.toLowerCase().includes(i.toLowerCase()));return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Set Organization"}),e.jsx("button",{onClick:f,className:"text-gray-400 hover:text-gray-600",disabled:o,children:e.jsx(C,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Set current organization for ",d," ",d===1?"person":"people",":"]}),e.jsx("input",{type:"text",placeholder:"Search organizations...",value:i,onChange:p=>x(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-primary-500 focus:border-primary-500"}),e.jsxs("button",{type:"button",onClick:()=>g("clear"),disabled:o,className:`w-full flex items-center gap-3 p-3 rounded-lg border-2 text-left transition-colors ${n==="clear"?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(C,{className:`w-5 h-5 ${n==="clear"?"text-primary-600":"text-gray-400"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Clear organization"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Remove current organization from selected people"})]}),n==="clear"&&e.jsx(M,{className:"w-5 h-5 text-primary-600"})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:i?"No organizations match your search":"No organizations found"}):r.map(p=>{const h=n===p.id;return e.jsxs("button",{type:"button",onClick:()=>g(p.id),disabled:o,className:`w-full flex items-center gap-3 p-3 rounded-lg border-2 text-left transition-colors ${h?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx(De,{className:`w-5 h-5 ${h?"text-primary-600":"text-gray-400"}`}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:p.name})}),h&&e.jsx(M,{className:"w-5 h-5 text-primary-600"})]},p.id)})})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:f,className:"btn-secondary",disabled:o,children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>u(n==="clear"?null:n),className:"btn-primary",disabled:o||n===null,children:o?"Applying...":`Apply to ${d} ${d===1?"person":"people"}`})]})]})})}function ps({isOpen:l,onClose:f,selectedCount:d,labels:y,onSubmit:u,isLoading:o}){const[n,g]=c.useState("add"),[i,x]=c.useState([]);if(c.useEffect(()=>{l&&(g("add"),x([]))},[l]),!l)return null;const r=p=>{x(h=>h.includes(p)?h.filter(_=>_!==p):[...h,p])};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Manage Labels"}),e.jsx("button",{onClick:f,className:"text-gray-400 hover:text-gray-600",disabled:o,children:e.jsx(C,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[n==="add"?"Add":"Remove"," labels for ",d," ",d===1?"person":"people",":"]}),e.jsxs("div",{className:"flex rounded-lg border border-gray-200 p-1",children:[e.jsx("button",{type:"button",onClick:()=>{g("add"),x([])},className:`flex-1 px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${n==="add"?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-50"}`,children:"Add Labels"}),e.jsx("button",{type:"button",onClick:()=>{g("remove"),x([])},className:`flex-1 px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${n==="remove"?"bg-red-100 text-red-700":"text-gray-600 hover:bg-gray-50"}`,children:"Remove Labels"})]}),!y||y.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(Oe,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"No labels available."}),e.jsx("p",{className:"text-xs",children:"Create labels first to use this feature."})]}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:y.map(p=>{const h=i.includes(p.id);return e.jsxs("button",{type:"button",onClick:()=>r(p.id),disabled:o,className:`w-full flex items-center gap-3 p-3 rounded-lg border-2 text-left transition-colors ${h?n==="add"?"border-primary-500 bg-primary-50":"border-red-500 bg-red-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:`flex items-center justify-center w-5 h-5 border-2 rounded ${h?n==="add"?"bg-primary-600 border-primary-600":"bg-red-600 border-red-600":"border-gray-300"}`,children:h&&e.jsx(M,{className:"w-3 h-3 text-white"})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:p.name})]},p.id)})})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:f,className:"btn-secondary",disabled:o,children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>u(n,i),className:n==="add"?"btn-primary":"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:opacity-50",disabled:o||i.length===0,children:o?n==="add"?"Adding...":"Removing...":`${n==="add"?"Add":"Remove"} ${i.length} ${i.length===1?"label":"labels"}`})]})]})})}function ws(){var ye,ge;const[l,f]=c.useState(!1),[d,y]=c.useState(!1),[u,o]=c.useState([]),[n,g]=c.useState(""),[i,x]=c.useState(""),[r,p]=c.useState("all"),[h,_]=c.useState(""),[k,de]=c.useState("first_name"),[b,Q]=c.useState("asc"),[j,D]=c.useState(new Set),[Re,O]=c.useState(!1),[Ee,me]=c.useState(!1),[Y,z]=c.useState(!1),[Ie,H]=c.useState(!1),[Te,G]=c.useState(!1),[qe,J]=c.useState(!1),[Ve,X]=c.useState(!1),[P,S]=c.useState(!1),Z=c.useRef(null),ee=c.useRef(null),se=c.useRef(null),Ue=ss(),{data:N,isLoading:R,error:E}=ts(),{data:L=[]}=as(),I=rs(),te=(ye=window.prmConfig)==null?void 0:ye.userId,Ke=ls({onSuccess:s=>{O(!1),Ue(`/people/${s.id}`)}}),Qe=async s=>{me(!0);try{await Ke.mutateAsync(s)}finally{me(!1)}},{data:T}=le({queryKey:["person-labels"],queryFn:async()=>(await ie.getPersonLabels()).data}),xe=(T==null?void 0:T.map(s=>s.name))||[],Ye=T||[],{data:He}=le({queryKey:["companies","all"],queryFn:async()=>(await ie.getCompanies({per_page:100})).data.map(t=>({id:t.id,name:Ae(t)})).sort((t,a)=>t.name.localeCompare(a.name))}),ue=c.useMemo(()=>{if(!N)return[];const s=N.map(t=>t.birth_year).filter(t=>t!=null);return[...new Set(s)].sort((t,a)=>a-t)},[N]);c.useEffect(()=>{const s=t=>{ee.current&&!ee.current.contains(t.target)&&Z.current&&!Z.current.contains(t.target)&&f(!1),se.current&&!se.current.contains(t.target)&&z(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]);const w=c.useMemo(()=>{if(!N)return[];let s=[...N];if(d&&(s=s.filter(t=>t.is_favorite)),u.length>0&&(s=s.filter(t=>{const a=t.labels||[];return u.some(m=>a.includes(m))})),n){const t=parseInt(n,10);s=s.filter(a=>a.birth_year===t)}if(i){const t=new Date;let a;switch(i){case"7":a=new Date(t.setDate(t.getDate()-7));break;case"30":a=new Date(t.setDate(t.getDate()-30));break;case"90":a=new Date(t.setDate(t.getDate()-90));break;case"365":a=new Date(t.setDate(t.getDate()-365));break;default:a=null}a&&(s=s.filter(m=>m.modified?new Date(m.modified)>=a:!1))}return r==="mine"?s=s.filter(t=>t.author===te):r==="shared"&&(s=s.filter(t=>t.author!==te)),h&&(s=s.filter(t=>{var m;return(((m=t.acf)==null?void 0:m._assigned_workspaces)||[]).includes(parseInt(h))})),s},[N,d,u,n,i,r,h,te]),q=d||u.length>0||n||i||r!=="all"||h,pe=s=>{o(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},he=()=>{y(!1),o([]),g(""),x(""),p("all"),_("")},Ge=s=>{D(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})},Je=()=>{j.size===w.length?D(new Set):D(new Set(w.map(s=>s.id)))},B=()=>D(new Set),Xe=w.length>0&&j.size===w.length,Ze=j.size>0&&j.size<w.length;c.useEffect(()=>{D(new Set)},[d,u,n,i,r,h,N]);const V=c.useMemo(()=>{if(!w)return[];const s=w.map(t=>ze(t)).filter(Boolean);return[...new Set(s)]},[w]),{data:ae}=le({queryKey:["companies","batch",V.sort().join(",")],queryFn:async()=>V.length===0?[]:(await ie.getCompanies({per_page:100,include:V.join(",")})).data,enabled:V.length>0}),re=c.useMemo(()=>{const s={};return ae&&ae.forEach(t=>{s[t.id]=Ae(t)}),s},[ae]),U=c.useMemo(()=>{const s={};return w.forEach(t=>{const a=ze(t);a&&re[a]&&(s[t.id]=re[a])}),s},[w,re]),fe=s=>{var a;return(((a=s.acf)==null?void 0:a._assigned_workspaces)||[]).map(m=>{const F=typeof m=="string"?parseInt(m,10):m,$=L.find(K=>K.id===F);return $==null?void 0:$.title}).filter(Boolean).join(", ")},A=c.useMemo(()=>w?[...w].sort((s,t)=>{var $,K,be,je,Ne,we,ve,ke,Ce,Se;let a,m;if(k==="modified"){a=s.modified?new Date(s.modified).getTime():0,m=t.modified?new Date(t.modified).getTime():0;const v=a-m;return b==="asc"?v:-v}if(k==="organization"){if(a=(U[s.id]||"").toLowerCase(),m=(U[t.id]||"").toLowerCase(),!a&&m)return b==="asc"?1:-1;if(a&&!m)return b==="asc"?-1:1;if(!a&&!m)return 0;const v=a.localeCompare(m);return b==="asc"?v:-v}if(k==="workspace"){if(a=fe(s).toLowerCase(),m=fe(t).toLowerCase(),!a&&m)return b==="asc"?1:-1;if(a&&!m)return b==="asc"?-1:1;if(!a&&!m)return 0;const v=a.localeCompare(m);return b==="asc"?v:-v}if(k==="labels"){if(a=((($=s.labels)==null?void 0:$[0])||"").toLowerCase(),m=(((K=t.labels)==null?void 0:K[0])||"").toLowerCase(),!a&&m)return b==="asc"?1:-1;if(a&&!m)return b==="asc"?-1:1;if(!a&&!m)return 0;const v=a.localeCompare(m);return b==="asc"?v:-v}if(k==="first_name"?(a=(((be=s.acf)==null?void 0:be.first_name)||s.first_name||"").toLowerCase(),m=(((je=t.acf)==null?void 0:je.first_name)||t.first_name||"").toLowerCase()):(a=(((Ne=s.acf)==null?void 0:Ne.last_name)||s.last_name||"").toLowerCase(),m=(((we=t.acf)==null?void 0:we.last_name)||t.last_name||"").toLowerCase()),a===m){const v=k==="first_name"?(((ve=s.acf)==null?void 0:ve.last_name)||s.last_name||"").toLowerCase():(((ke=s.acf)==null?void 0:ke.first_name)||s.first_name||"").toLowerCase(),es=k==="first_name"?(((Ce=t.acf)==null?void 0:Ce.last_name)||t.last_name||"").toLowerCase():(((Se=t.acf)==null?void 0:Se.first_name)||t.first_name||"").toLowerCase(),_e=v.localeCompare(es);return b==="asc"?_e:-_e}const F=a.localeCompare(m);return b==="asc"?F:-F}):[],[w,k,b,U,L]);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 border border-gray-200 rounded-lg p-1",children:[e.jsxs("select",{value:k,onChange:s=>de(s.target.value),className:"text-sm border-0 bg-transparent focus:ring-0 focus:outline-none cursor-pointer",children:[e.jsx("option",{value:"first_name",children:"First name"}),e.jsx("option",{value:"last_name",children:"Last name"}),e.jsx("option",{value:"modified",children:"Last modified"}),e.jsx("option",{value:"organization",children:"Organization"}),e.jsx("option",{value:"workspace",children:"Workspace"}),e.jsx("option",{value:"labels",children:"Labels"})]}),e.jsx("div",{className:"h-4 w-px bg-gray-300"}),e.jsx("button",{onClick:()=>Q(b==="asc"?"desc":"asc"),className:"p-1 hover:bg-gray-100 rounded transition-colors",title:`Sort ${b==="asc"?"descending":"ascending"}`,children:b==="asc"?e.jsx(Fe,{className:"w-4 h-4 text-gray-600"}):e.jsx(We,{className:"w-4 h-4 text-gray-600"})})]}),e.jsxs("div",{className:"relative",ref:Z,children:[e.jsxs("button",{onClick:()=>f(!l),className:`btn-secondary ${q?"bg-primary-50 text-primary-700 border-primary-200":""}`,children:[e.jsx(Me,{className:"w-4 h-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Filter"}),q&&e.jsx("span",{className:"ml-2 px-1.5 py-0.5 bg-primary-600 text-white text-xs rounded-full",children:u.length+(d?1:0)+(n?1:0)+(i?1:0)})]}),l&&e.jsx("div",{ref:ee,className:"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:s=>y(s.target.checked),className:"sr-only"}),e.jsx("div",{className:`flex items-center justify-center w-5 h-5 border-2 rounded mr-3 ${d?"bg-primary-600 border-primary-600":"border-gray-300"}`,children:d&&e.jsx(M,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-4 h-4 mr-2 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Favorites only"})]})]})}),xe.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Labels"}),e.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:xe.map(s=>e.jsxs("label",{className:"flex items-center cursor-pointer hover:bg-gray-50 p-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:u.includes(s),onChange:()=>pe(s),className:"sr-only"}),e.jsx("div",{className:`flex items-center justify-center w-5 h-5 border-2 rounded mr-3 ${u.includes(s)?"bg-primary-600 border-primary-600":"border-gray-300"}`,children:u.includes(s)&&e.jsx(M,{className:"w-3 h-3 text-white"})}),e.jsx("span",{className:"text-sm text-gray-700",children:s})]},s))})]}),ue.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Birth year"}),e.jsxs("select",{value:n,onChange:s=>g(s.target.value),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"All years"}),ue.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Last modified"}),e.jsxs("select",{value:i,onChange:s=>x(s.target.value),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Any time"}),e.jsx("option",{value:"7",children:"Last 7 days"}),e.jsx("option",{value:"30",children:"Last 30 days"}),e.jsx("option",{value:"90",children:"Last 90 days"}),e.jsx("option",{value:"365",children:"Last year"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Ownership"}),e.jsx("div",{className:"space-y-1",children:[{value:"all",label:"All Contacts"},{value:"mine",label:"My Contacts"},{value:"shared",label:"Shared with Me"}].map(s=>e.jsxs("label",{className:"flex items-center cursor-pointer hover:bg-gray-50 p-1 rounded",children:[e.jsx("input",{type:"radio",name:"ownership",value:s.value,checked:r===s.value,onChange:t=>p(t.target.value),className:"sr-only"}),e.jsx("div",{className:`flex items-center justify-center w-4 h-4 border-2 rounded-full mr-3 ${r===s.value?"border-primary-600":"border-gray-300"}`,children:r===s.value&&e.jsx("div",{className:"w-2 h-2 bg-primary-600 rounded-full"})}),e.jsx("span",{className:"text-sm text-gray-700",children:s.label})]},s.value))})]}),L.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Workspace"}),e.jsxs("select",{value:h,onChange:s=>_(s.target.value),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"All Workspaces"}),L.map(s=>e.jsx("option",{value:s.id,children:s.title},s.id))]})]}),q&&e.jsx("button",{onClick:he,className:"w-full text-sm text-primary-600 hover:text-primary-700 font-medium pt-2 border-t border-gray-200",children:"Clear all filters"})]})})]}),q&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[d&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-primary-100 text-primary-800 rounded-full text-xs",children:[e.jsx(ce,{className:"w-3 h-3"}),"Favorites",e.jsx("button",{onClick:()=>y(!1),className:"hover:text-primary-600",children:e.jsx(C,{className:"w-3 h-3"})})]}),u.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs",children:[s,e.jsx("button",{onClick:()=>pe(s),className:"hover:text-gray-600",children:e.jsx(C,{className:"w-3 h-3"})})]},s)),n&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs",children:["Born ",n,e.jsx("button",{onClick:()=>g(""),className:"hover:text-gray-600",children:e.jsx(C,{className:"w-3 h-3"})})]}),i&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs",children:["Modified: ",i==="7"?"Last 7 days":i==="30"?"Last 30 days":i==="90"?"Last 90 days":"Last year",e.jsx("button",{onClick:()=>x(""),className:"hover:text-gray-600",children:e.jsx(C,{className:"w-3 h-3"})})]}),r!=="all"&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-primary-100 text-primary-800 rounded-full text-xs",children:[r==="mine"?"My Contacts":"Shared with Me",e.jsx("button",{onClick:()=>p("all"),className:"hover:text-primary-600",children:e.jsx(C,{className:"w-3 h-3"})})]}),h&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:[((ge=L.find(s=>s.id===parseInt(h)))==null?void 0:ge.title)||"Workspace",e.jsx("button",{onClick:()=>_(""),className:"hover:text-blue-600",children:e.jsx(C,{className:"w-3 h-3"})})]})]}),e.jsxs("button",{onClick:()=>O(!0),className:"btn-primary",children:[e.jsx(ne,{className:"w-4 h-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Add person"})]})]})}),R&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}),E&&e.jsx("div",{className:"card p-6 text-center",children:e.jsx("p",{className:"text-red-600",children:"Failed to load people."})}),!R&&!E&&(N==null?void 0:N.length)===0&&e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ne,{className:"w-6 h-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No people found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Get started by adding your first person."}),e.jsxs("button",{onClick:()=>O(!0),className:"btn-primary",children:[e.jsx(ne,{className:"w-4 h-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Add person"})]})]}),j.size>0&&e.jsxs("div",{className:"sticky top-0 z-20 flex items-center justify-between bg-primary-50 border border-primary-200 rounded-lg px-4 py-2 shadow-sm",children:[e.jsxs("span",{className:"text-sm text-primary-800 font-medium",children:[j.size," ",j.size===1?"person":"people"," selected"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",ref:se,children:[e.jsxs("button",{onClick:()=>z(!Y),className:"flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-primary-700 bg-white border border-primary-300 rounded-md hover:bg-primary-50",children:["Actions",e.jsx(ns,{className:`w-4 h-4 transition-transform ${Y?"rotate-180":""}`})]}),Y&&e.jsx("div",{className:"absolute right-0 mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{z(!1),H(!0)},className:"w-full flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[e.jsx($e,{className:"w-4 h-4"}),"Change visibility..."]}),e.jsxs("button",{onClick:()=>{z(!1),G(!0)},className:"w-full flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[e.jsx(oe,{className:"w-4 h-4"}),"Assign to workspace..."]}),e.jsxs("button",{onClick:()=>{z(!1),J(!0)},className:"w-full flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[e.jsx(De,{className:"w-4 h-4"}),"Set organization..."]}),e.jsxs("button",{onClick:()=>{z(!1),X(!0)},className:"w-full flex items-center gap-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[e.jsx(Oe,{className:"w-4 h-4"}),"Manage labels..."]})]})})]}),e.jsx("button",{onClick:B,className:"text-sm text-primary-600 hover:text-primary-800 font-medium",children:"Clear selection"})]})]}),!R&&!E&&(A==null?void 0:A.length)>0&&e.jsx(ds,{people:A,companyMap:U,workspaces:L,selectedIds:j,onToggleSelection:Ge,onToggleSelectAll:Je,isAllSelected:Xe,isSomeSelected:Ze,sortField:k,sortOrder:b,onSort:s=>{s===k?Q(b==="asc"?"desc":"asc"):(de(s),Q("asc"))}}),!R&&!E&&(N==null?void 0:N.length)>0&&(A==null?void 0:A.length)===0&&e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Me,{className:"w-6 h-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No people match your filters"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Try adjusting your filters to see more results."}),e.jsx("button",{onClick:he,className:"btn-secondary",children:"Clear filters"})]}),e.jsx(is,{isOpen:Re,onClose:()=>O(!1),onSubmit:Qe,isLoading:Ee}),e.jsx(ms,{isOpen:Ie,onClose:()=>H(!1),selectedCount:j.size,onSubmit:async s=>{S(!0);try{await I.mutateAsync({ids:Array.from(j),updates:{visibility:s}}),B(),H(!1)}finally{S(!1)}},isLoading:P}),e.jsx(xs,{isOpen:Te,onClose:()=>G(!1),selectedCount:j.size,workspaces:L,onSubmit:async s=>{S(!0);try{await I.mutateAsync({ids:Array.from(j),updates:{assigned_workspaces:s}}),B(),G(!1)}finally{S(!1)}},isLoading:P}),e.jsx(us,{isOpen:qe,onClose:()=>J(!1),selectedCount:j.size,companies:He||[],onSubmit:async s=>{S(!0);try{await I.mutateAsync({ids:Array.from(j),updates:{organization_id:s}}),B(),J(!1)}finally{S(!1)}},isLoading:P}),e.jsx(ps,{isOpen:Ve,onClose:()=>X(!1),selectedCount:j.size,labels:Ye,onSubmit:async(s,t)=>{S(!0);try{const a=s==="add"?{labels_add:t}:{labels_remove:t};await I.mutateAsync({ids:Array.from(j),updates:a}),B(),X(!1)}finally{S(!1)}},isLoading:P})]})}export{ws as default};
