import{u as N,j as e,L as p,c as v,b as c}from"./vendor-CjdX6t1i.js";import{c as b,H as w,p as n}from"./main-D6r1FXj6.js";import{S as A}from"./shield-alert-D6-jVMFX.js";import{L as C}from"./loader-2-CY1xq1CO.js";import{A as k}from"./arrow-left-C9KexAZo.js";import{X as h}from"./x-circle-J-4C2pqI.js";import{T as u}from"./trash-2-GMOh3z4B.js";import"./utils-D5Yy9kBW.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g=b("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);function M(){w("User Approval - Settings");const i=N();if(!((window.prmConfig||{}).isAdmin||!1))return e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx(A,{className:"w-16 h-16 mx-auto text-amber-500 mb-4"}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You don't have permission to manage user approvals. This feature is only available to administrators."}),e.jsx(p,{to:"/settings",className:"btn-primary",children:"Back to Settings"})]})});const{data:r=[],isLoading:j}=v({queryKey:["users"],queryFn:async()=>(await n.getUsers()).data}),l=c({mutationFn:s=>n.approveUser(s),onSuccess:()=>{i.invalidateQueries({queryKey:["users"]})}}),t=c({mutationFn:s=>n.denyUser(s),onSuccess:()=>{i.invalidateQueries({queryKey:["users"]})}}),a=c({mutationFn:s=>n.deleteUser(s),onSuccess:()=>{i.invalidateQueries({queryKey:["users"]})}}),y=s=>{window.confirm("Are you sure you want to approve this user?")&&l.mutate(s)},d=s=>{window.confirm("Are you sure you want to deny this user? They will not be able to access the system.")&&t.mutate(s)},o=(s,f)=>{window.confirm(`Are you sure you want to delete ${f}? This will permanently delete their account and all their related data (people, organizations, dates). This action cannot be undone.`)&&a.mutate(s)};if(j)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(C,{className:"w-8 h-8 animate-spin text-primary-600"})});const m=r.filter(s=>!s.is_approved),x=r.filter(s=>s.is_approved);return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(p,{to:"/settings",className:"btn-secondary flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Back to Settings"})]}),e.jsx("h1",{className:"text-2xl font-semibold",children:"User Approval"})]}),e.jsxs("div",{className:"space-y-6",children:[m.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Pending Approval"}),e.jsx("div",{className:"space-y-3",children:m.map(s=>e.jsxs("div",{className:"card p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Registered: ",new Date(s.registered).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>y(s.id),disabled:l.isPending||a.isPending,className:"btn-primary flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>d(s.id),disabled:t.isPending||a.isPending,className:"btn-secondary flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),"Deny"]}),e.jsxs("button",{onClick:()=>o(s.id,s.name),disabled:l.isPending||t.isPending||a.isPending,className:"btn-danger flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4"}),"Delete"]})]})]},s.id))})]}),x.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Approved Users"}),e.jsx("div",{className:"space-y-3",children:x.map(s=>e.jsxs("div",{className:"card p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium flex items-center gap-2",children:[s.name,e.jsx(g,{className:"w-4 h-4 text-green-600"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>d(s.id),disabled:t.isPending||a.isPending,className:"btn-secondary flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),"Revoke Access"]}),e.jsxs("button",{onClick:()=>o(s.id,s.name),disabled:t.isPending||a.isPending,className:"btn-danger flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4"}),"Delete"]})]})]},s.id))})]}),r.length===0&&e.jsx("div",{className:"card p-8 text-center",children:e.jsx("p",{className:"text-gray-600",children:"No Caelis users found."})})]})]})}export{M as default};
