import{r as N,j as e,L as c}from"./vendor-CjdX6t1i.js";import{c as L,u as q,a as V,b as Y,d as B,U as _,B as P,C,e as v,S as Q,A as G,P as O}from"./main-D6r1FXj6.js";import{M as J,C as W,Q as H,i as K}from"./QuickActivityModal-D0TGGdB1.js";import{S as D}from"./star-DEP2JXYW.js";import{S as X}from"./square-CumeHu_S.js";import{f as E}from"./utils-D5Yy9kBW.js";import"./link-DSACisY3.js";import"./mail-DERmFBJJ.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=L("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);function x({title:s,value:n,icon:a,href:r}){return e.jsx(c,{to:r,className:"card p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:s}),e.jsx("p",{className:"mt-1 text-3xl font-semibold",children:n})]}),e.jsx("div",{className:"p-3 bg-primary-50 rounded-lg",children:e.jsx(a,{className:"w-6 h-6 text-primary-600"})})]})})}function M({person:s,hideStar:n=!1}){var a,r;return e.jsxs(c,{to:`/people/${s.id}`,className:"flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[s.thumbnail?e.jsx("img",{src:s.thumbnail,alt:s.name,loading:"lazy",className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-gray-500",children:((a=s.first_name)==null?void 0:a[0])||"?"})}),e.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.name}),((r=s.labels)==null?void 0:r.length)>0&&e.jsx("p",{className:"text-xs text-gray-500 truncate",children:s.labels.join(", ")})]}),s.is_favorite&&!n&&e.jsx(D,{className:"w-4 h-4 text-yellow-400 fill-current"})]})}function Z({reminder:s}){var i,m,p;const n=s.days_until;let a="bg-gray-100 text-gray-700";n===0?a="bg-green-100 text-green-700":n<=3?a="bg-orange-100 text-orange-700":n<=7&&(a="bg-yellow-100 text-yellow-700");const r=(m=(i=s.related_people)==null?void 0:i[0])==null?void 0:m.id,o=((p=s.related_people)==null?void 0:p.length)>0,h=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${a}`,children:n===0?"Today":`${n}d`}),e.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-xs text-gray-500",children:E(new Date(s.next_occurrence),"MMMM d, yyyy")})]}),o&&e.jsx("div",{className:"flex -space-x-2 ml-3 flex-shrink-0",children:s.related_people.slice(0,3).map(d=>{var u;return d.thumbnail?e.jsx("img",{src:d.thumbnail,alt:d.name,loading:"lazy",className:"w-10 h-10 rounded-full border-2 border-white object-cover"},d.id):e.jsx("div",{className:"w-10 h-10 bg-gray-300 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx("span",{className:"text-sm",children:(u=d.name)==null?void 0:u[0]})},d.id)})})]});return o&&r?e.jsx(c,{to:`/people/${r}`,className:"flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors",children:h}):e.jsx("div",{className:"flex items-center p-3 rounded-lg hover:bg-gray-50 transition-colors",children:h})}function ee({todo:s,onToggle:n}){var r;const a=K(s);return e.jsxs(c,{to:`/people/${s.person_id}`,className:"flex items-start p-3 rounded-lg hover:bg-gray-50 transition-colors group",children:[e.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),n(s)},className:"mt-0.5 mr-3 flex-shrink-0",title:s.is_completed?"Mark as incomplete":"Mark as complete",children:s.is_completed?e.jsx(v,{className:"w-5 h-5 text-primary-600"}):e.jsx(X,{className:`w-5 h-5 ${a?"text-red-600":"text-gray-400"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-medium ${s.is_completed?"line-through text-gray-400":a?"text-red-600":"text-gray-900"}`,children:s.content}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.person_thumbnail?e.jsx("img",{src:s.person_thumbnail,alt:s.person_name,loading:"lazy",className:"w-5 h-5 rounded-full object-cover"}):e.jsx("div",{className:"w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:(r=s.person_name)==null?void 0:r[0]})}),e.jsx("span",{className:"text-xs text-gray-500 truncate",children:s.person_name})]})]}),s.due_date&&e.jsxs("div",{className:`ml-3 text-xs text-right flex-shrink-0 ${a&&!s.is_completed?"text-red-600 font-medium":"text-gray-500"}`,children:[e.jsx("div",{children:E(new Date(s.due_date),"MMM d")}),a&&!s.is_completed&&e.jsx("div",{className:"text-red-600",children:"overdue"})]})]})}function se(){return e.jsxs("div",{className:"card p-12 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-4 bg-primary-50 rounded-full",children:e.jsx(Q,{className:"w-12 h-12 text-primary-600"})})}),e.jsxs("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:["Welcome to ",G,"!"]}),e.jsx("p",{className:"text-gray-600 mb-8 max-w-md mx-auto",children:"Get started by adding your first contact, organization, or important date. Your dashboard will populate as you add more information."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs(c,{to:"/people/new",className:"inline-flex items-center px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(O,{className:"w-5 h-5 mr-2"}),"Add Your First Person"]}),e.jsxs(c,{to:"/companies/new",className:"inline-flex items-center px-6 py-3 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(O,{className:"w-5 h-5 mr-2"}),"Add Your First Organization"]})]})]})}function xe(){var T,k,I;const{data:s,isLoading:n,error:a}=q(),{data:r}=V(!1),o=Y(),h=B(),[i,m]=N.useState(null),[p,d]=N.useState(!1),[u,b]=N.useState(!1),[z,w]=N.useState(null),F=t=>{if(!t.is_completed){m(t),d(!0);return}o.mutate({todoId:t.id,data:{content:t.content,due_date:t.due_date,is_completed:!1}})},$=()=>{i&&(o.mutate({todoId:i.id,data:{content:i.content,due_date:i.due_date,is_completed:!0}}),d(!1),m(null))},R=()=>{if(!i)return;const t=new Date().toISOString().split("T")[0];w({content:i.content,activity_date:t,activity_type:"note",participants:[]}),d(!1),b(!0)},U=async t=>{if(i)try{await h.mutateAsync({personId:i.person_id,data:t}),await o.mutateAsync({todoId:i.id,data:{content:i.content,due_date:i.due_date,is_completed:!0}}),b(!1),m(null),w(null)}catch{alert("Failed to create activity. Please try again.")}};if(n)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})});if(a){const t=((T=a==null?void 0:a.response)==null?void 0:T.status)>=500||!(a!=null&&a.response);return e.jsx("div",{className:"card p-8 text-center",children:e.jsx("div",{className:"text-red-600 mb-2",children:t?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium mb-1",children:"Failed to load dashboard data"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Please check your connection and try refreshing the page."})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-medium mb-1",children:"Unable to load dashboard"}),e.jsx("p",{className:"text-sm text-gray-600",children:((I=(k=a==null?void 0:a.response)==null?void 0:k.data)==null?void 0:I.message)||"An error occurred while loading your data."})]})})})}const{stats:l,recent_people:g,upcoming_reminders:j,favorites:y,recently_contacted:f}=s||{};if(((l==null?void 0:l.total_people)||0)+((l==null?void 0:l.total_companies)||0)+((l==null?void 0:l.total_dates)||0)===0)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(x,{title:"Total people",value:0,icon:_,href:"/people"}),e.jsx(x,{title:"Organizations",value:0,icon:P,href:"/companies"}),e.jsx(x,{title:"Events",value:0,icon:C,href:"/dates"}),e.jsx(x,{title:"Open todos",value:0,icon:v,href:"/todos"})]}),e.jsx(se,{})]});const S=(r==null?void 0:r.slice(0,5))||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(x,{title:"Total people",value:(l==null?void 0:l.total_people)||0,icon:_,href:"/people"}),e.jsx(x,{title:"Organizations",value:(l==null?void 0:l.total_companies)||0,icon:P,href:"/companies"}),e.jsx(x,{title:"Events",value:(l==null?void 0:l.total_dates)||0,icon:C,href:"/dates"}),e.jsx(x,{title:"Open todos",value:(l==null?void 0:l.open_todos_count)||0,icon:v,href:"/todos"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("h2",{className:"font-semibold flex items-center",children:[e.jsx(C,{className:"w-5 h-5 mr-2 text-gray-500"}),"Upcoming reminders"]}),e.jsxs(c,{to:"/dates",className:"text-sm text-primary-600 hover:text-primary-700 flex items-center",children:["View all reminders",e.jsx(A,{className:"w-4 h-4 ml-1"})]})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:(j==null?void 0:j.length)>0?j.map(t=>e.jsx(Z,{reminder:t},t.id)):e.jsx("p",{className:"p-4 text-sm text-gray-500 text-center",children:"No upcoming reminders"})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("h2",{className:"font-semibold flex items-center",children:[e.jsx(v,{className:"w-5 h-5 mr-2 text-gray-500"}),"Open todos"]}),e.jsxs(c,{to:"/todos",className:"text-sm text-primary-600 hover:text-primary-700 flex items-center",children:["View all todos",e.jsx(A,{className:"w-4 h-4 ml-1"})]})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:S.length>0?S.map(t=>e.jsx(ee,{todo:t,onToggle:F},t.id)):e.jsx("p",{className:"p-4 text-sm text-gray-500 text-center",children:"No open todos"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:e.jsxs("h2",{className:"font-semibold flex items-center",children:[e.jsx(D,{className:"w-5 h-5 mr-2 text-yellow-500 fill-current"}),"Favorites"]})}),(y==null?void 0:y.length)>0?e.jsx("div",{className:"divide-y divide-gray-100",children:y.slice(0,5).map(t=>e.jsx(M,{person:t,hideStar:!0},t.id))}):e.jsx("p",{className:"p-4 text-sm text-gray-500 text-center",children:"No favorites yet"})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:e.jsxs("h2",{className:"font-semibold flex items-center",children:[e.jsx(J,{className:"w-5 h-5 mr-2 text-gray-500"}),"Recently contacted"]})}),(f==null?void 0:f.length)>0?e.jsx("div",{className:"divide-y divide-gray-100",children:f.map(t=>e.jsx(M,{person:t},t.id))}):e.jsx("p",{className:"p-4 text-sm text-gray-500 text-center",children:"No recent activities yet"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsxs("h2",{className:"font-semibold flex items-center",children:[e.jsx(_,{className:"w-5 h-5 mr-2 text-gray-500"}),"Recently edited"]}),e.jsxs(c,{to:"/people",className:"text-sm text-primary-600 hover:text-primary-700 flex items-center",children:["View all",e.jsx(A,{className:"w-4 h-4 ml-1"})]})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:(g==null?void 0:g.length)>0?g.map(t=>e.jsx(M,{person:t},t.id)):e.jsxs("p",{className:"p-4 text-sm text-gray-500 text-center",children:["No people yet. ",e.jsx(c,{to:"/people/new",className:"text-primary-600",children:"Add someone"})]})})]})]}),e.jsx(W,{isOpen:p,onClose:()=>{d(!1),m(null)},todo:i,onComplete:$,onCompleteAsActivity:R}),e.jsx(H,{isOpen:u,onClose:()=>{b(!1),m(null),w(null)},onSubmit:U,isLoading:h.isPending,personId:i==null?void 0:i.person_id,initialData:z})]})}export{xe as default};
