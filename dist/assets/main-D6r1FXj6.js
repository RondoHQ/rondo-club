const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-Dfo3frnW.js","assets/vendor-CjdX6t1i.js","assets/QuickActivityModal-D0TGGdB1.js","assets/utils-D5Yy9kBW.js","assets/link-DSACisY3.js","assets/mail-DERmFBJJ.js","assets/star-DEP2JXYW.js","assets/square-CumeHu_S.js","assets/PeopleList-BT57Sz5S.js","assets/tag-CobQv4bH.js","assets/filter-Bd647nZv.js","assets/PersonDetail-TggSwJuI.js","assets/ShareModal-C3A_SmFZ.js","assets/user-plus-B27X-obe.js","assets/trash-2-GMOh3z4B.js","assets/TodoModal-CYviMd3i.js","assets/arrow-left-C9KexAZo.js","assets/sticky-note-CFyUUpSs.js","assets/share-2-9jJxQyn6.js","assets/FamilyTree-B8-F0aNW.js","assets/rotate-ccw-DxI9kbTe.js","assets/CompaniesList-Ddodz31k.js","assets/CompanyDetail-B55uFb1z.js","assets/DatesList-D662A6Wr.js","assets/TodosList-BKwbrVei.js","assets/clock-C3q_yH8K.js","assets/Settings-CpnNxF-a.js","assets/check-circle-CgK97bW_.js","assets/loader-2-CY1xq1CO.js","assets/alert-triangle-CTx-MD4S.js","assets/shield-znEaW7R6.js","assets/RelationshipTypes-CmMDEzsh.js","assets/shield-alert-D6-jVMFX.js","assets/UserApproval-BV1gD3az.js","assets/x-circle-J-4C2pqI.js","assets/WorkspacesList-Bmm40fRK.js","assets/eye-DamYVwHf.js","assets/WorkspaceDetail-8jlgxMr1.js","assets/WorkspaceSettings-CLuOyWAh.js","assets/WorkspaceInviteAccept-B3B4AGK7.js","assets/Login-cWqDF3UL.js"])))=>i.map(i=>d[i]);
import{a as Ue,r as o,u as E,b as A,c as O,d as Te,j as e,e as Ae,L as Ve,N as Oe,f as Ce,g as V,h as Le,Q as He,R as Be,i as Ge,B as Ye}from"./vendor-CjdX6t1i.js";import{a as Xe,u as je,C as Se}from"./utils-D5Yy9kBW.js";var ge={},Pe=Ue;ge.createRoot=Pe.createRoot,ge.hydrateRoot=Pe.hydrateRoot;const Je="modulepreload",Ze=function(t){return"/"+t},qe={},H=function(s,a,n){let r=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),x=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));r=Promise.allSettled(a.map(u=>{if(u=Ze(u),u in qe)return;qe[u]=!0;const g=u.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${v}`))return;const d=document.createElement("link");if(d.rel=g?"stylesheet":Je,g||(d.as="script"),d.crossOrigin="",d.href=u,x&&d.setAttribute("nonce",x),document.head.appendChild(d),g)return new Promise((b,f)=>{d.addEventListener("load",b),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(c){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=c,window.dispatchEvent(x),!x.defaultPrevented)throw c}return r.then(c=>{for(const x of c||[])x.status==="rejected"&&i(x.reason);return s().catch(i)})};function Me(){const t=window.prmConfig||{};return o.useMemo(()=>({isLoggedIn:t.isLoggedIn||!1,userId:t.userId||null,loginUrl:t.loginUrl||"/wp-login.php",logoutUrl:t.logoutUrl||"/wp-login.php?action=logout",isLoading:!1}),[t.isLoggedIn,t.userId,t.loginUrl,t.logoutUrl])}const ve=window.prmConfig||{},l=Xe.create({baseURL:ve.apiUrl||"/wp-json",headers:{"Content-Type":"application/json","X-WP-Nonce":ve.nonce||""}});l.interceptors.request.use(t=>{var s;return(s=window.prmConfig)!=null&&s.nonce&&(t.headers["X-WP-Nonce"]=window.prmConfig.nonce),t});l.interceptors.response.use(t=>t,t=>{var s;return((s=t.response)==null?void 0:s.status)===401&&(window.location.href=ve.loginUrl||"/wp-login.php"),Promise.reject(t)});const J={getPeople:t=>l.get("/wp/v2/people",{params:t}),getPerson:(t,s={})=>l.get(`/wp/v2/people/${t}`,{params:s}),createPerson:t=>l.post("/wp/v2/people",t),updatePerson:(t,s)=>l.put(`/wp/v2/people/${t}`,s),deletePerson:(t,s={})=>l.delete(`/wp/v2/people/${t}`,{params:s}),getCompanies:t=>l.get("/wp/v2/companies",{params:t}),getCompany:(t,s={})=>l.get(`/wp/v2/companies/${t}`,{params:s}),createCompany:t=>l.post("/wp/v2/companies",t),updateCompany:(t,s)=>l.put(`/wp/v2/companies/${t}`,s),deleteCompany:(t,s={})=>l.delete(`/wp/v2/companies/${t}`,{params:s}),getDates:t=>l.get("/wp/v2/important-dates",{params:t}),getDate:t=>l.get(`/wp/v2/important-dates/${t}`),createDate:t=>l.post("/wp/v2/important-dates",t),updateDate:(t,s)=>l.put(`/wp/v2/important-dates/${t}`,s),deleteDate:t=>l.delete(`/wp/v2/important-dates/${t}`),getPersonLabels:()=>l.get("/wp/v2/person_label"),getCompanyLabels:()=>l.get("/wp/v2/company_label"),getRelationshipTypes:()=>l.get("/wp/v2/relationship_type",{params:{per_page:100,_fields:"id,name,slug,acf"}}),createRelationshipType:t=>l.post("/wp/v2/relationship_type",t),updateRelationshipType:(t,s)=>l.post(`/wp/v2/relationship_type/${t}`,s),deleteRelationshipType:t=>l.delete(`/wp/v2/relationship_type/${t}?force=true`),restoreRelationshipTypeDefaults:()=>l.post("/prm/v1/relationship-types/restore-defaults"),getDateTypes:()=>l.get("/wp/v2/date_type",{params:{per_page:100}}),uploadMedia:t=>{const s=new FormData;return s.append("file",t),l.post("/wp/v2/media",s,{headers:{"Content-Type":"multipart/form-data"}})}},_={getVersion:()=>l.get("/prm/v1/version"),getDashboard:()=>l.get("/prm/v1/dashboard"),sideloadGravatar:(t,s)=>l.post(`/prm/v1/people/${t}/gravatar`,{email:s}),bulkUpdatePeople:(t,s)=>l.post("/prm/v1/people/bulk-update",{ids:t,updates:s}),bulkUpdateCompanies:(t,s)=>l.post("/prm/v1/companies/bulk-update",{ids:t,updates:s}),getCurrentUser:()=>l.get("/prm/v1/user/me"),getUsers:()=>l.get("/prm/v1/users"),approveUser:t=>l.post(`/prm/v1/users/${t}/approve`),denyUser:t=>l.post(`/prm/v1/users/${t}/deny`),deleteUser:t=>l.delete(`/prm/v1/users/${t}`),search:t=>l.get("/prm/v1/search",{params:{q:t}}),getReminders:(t=30)=>l.get("/prm/v1/reminders",{params:{days_ahead:t}}),triggerReminders:()=>l.post("/prm/v1/reminders/trigger"),rescheduleCronJobs:()=>l.post("/prm/v1/reminders/reschedule-cron"),getNotificationChannels:()=>l.get("/prm/v1/user/notification-channels"),updateNotificationChannels:t=>l.post("/prm/v1/user/notification-channels",{channels:t}),updateSlackWebhook:t=>l.post("/prm/v1/user/slack-webhook",{webhook:t}),updateNotificationTime:t=>l.post("/prm/v1/user/notification-time",{time:t}),updateMentionNotifications:t=>l.post("/prm/v1/user/mention-notifications",{preference:t}),getSlackStatus:()=>l.get("/prm/v1/user/slack-status"),disconnectSlack:()=>l.post("/prm/v1/slack/disconnect"),getSlackChannels:()=>l.get("/prm/v1/slack/channels"),getSlackTargets:()=>l.get("/prm/v1/slack/targets"),updateSlackTargets:t=>l.post("/prm/v1/slack/targets",{targets:t}),getPersonDates:t=>l.get(`/prm/v1/people/${t}/dates`),getPersonTimeline:t=>l.get(`/prm/v1/people/${t}/timeline`),getPersonNotes:t=>l.get(`/prm/v1/people/${t}/notes`),createNote:(t,s,a="private")=>l.post(`/prm/v1/people/${t}/notes`,{content:s,visibility:a}),updateNote:(t,s,a=null)=>l.put(`/prm/v1/notes/${t}`,{content:s,...a&&{visibility:a}}),deleteNote:t=>l.delete(`/prm/v1/notes/${t}`),getPersonActivities:t=>l.get(`/prm/v1/people/${t}/activities`),createActivity:(t,s)=>l.post(`/prm/v1/people/${t}/activities`,s),updateActivity:(t,s)=>l.put(`/prm/v1/activities/${t}`,s),deleteActivity:t=>l.delete(`/prm/v1/activities/${t}`),getAllTodos:(t=!1)=>l.get("/prm/v1/todos",{params:{completed:t}}),getInvestments:t=>l.get(`/prm/v1/investments/${t}`),getPersonTodos:t=>l.get(`/prm/v1/people/${t}/todos`),createTodo:(t,s)=>l.post(`/prm/v1/people/${t}/todos`,s),updateTodo:(t,s)=>l.put(`/prm/v1/todos/${t}`,s),deleteTodo:t=>l.delete(`/prm/v1/todos/${t}`),getCompanyPeople:t=>l.get(`/prm/v1/companies/${t}/people`),setCompanyLogo:(t,s)=>l.post(`/prm/v1/companies/${t}/logo`,{media_id:s}),uploadPersonPhoto:(t,s)=>{const a=new FormData;return a.append("file",s),l.post(`/prm/v1/people/${t}/photo`,a,{headers:{"Content-Type":"multipart/form-data"}})},uploadCompanyLogo:(t,s)=>{const a=new FormData;return a.append("file",s),l.post(`/prm/v1/companies/${t}/logo/upload`,a,{headers:{"Content-Type":"multipart/form-data"}})},getCardDAVUrls:()=>l.get("/prm/v1/carddav/urls"),getAppPasswords:t=>l.get(`/wp/v2/users/${t}/application-passwords`),createAppPassword:(t,s)=>l.post(`/wp/v2/users/${t}/application-passwords`,{name:s}),deleteAppPassword:(t,s)=>l.delete(`/wp/v2/users/${t}/application-passwords/${s}`),getWorkspaces:()=>l.get("/prm/v1/workspaces"),getWorkspace:t=>l.get(`/prm/v1/workspaces/${t}`),createWorkspace:t=>l.post("/prm/v1/workspaces",t),updateWorkspace:(t,s)=>l.put(`/prm/v1/workspaces/${t}`,s),deleteWorkspace:t=>l.delete(`/prm/v1/workspaces/${t}`),addWorkspaceMember:(t,s)=>l.post(`/prm/v1/workspaces/${t}/members`,s),removeWorkspaceMember:(t,s)=>l.delete(`/prm/v1/workspaces/${t}/members/${s}`),updateWorkspaceMember:(t,s,a)=>l.put(`/prm/v1/workspaces/${t}/members/${s}`,a),searchWorkspaceMembers:async(t,s)=>{const{data:a}=await l.get("/prm/v1/workspaces/members/search",{params:{workspace_ids:t.join(","),query:s}});return a},getWorkspaceInvites:t=>l.get(`/prm/v1/workspaces/${t}/invites`),createWorkspaceInvite:(t,s)=>l.post(`/prm/v1/workspaces/${t}/invites`,s),revokeWorkspaceInvite:(t,s)=>l.delete(`/prm/v1/workspaces/${t}/invites/${s}`),validateInvite:t=>l.get(`/prm/v1/invites/${t}`),acceptInvite:t=>l.post(`/prm/v1/invites/${t}/accept`),getPostShares:(t,s)=>l.get(`/prm/v1/${s}/${t}/shares`),sharePost:(t,s,a)=>l.post(`/prm/v1/${s}/${t}/shares`,a),unsharePost:(t,s,a)=>l.delete(`/prm/v1/${s}/${t}/shares/${a}`),searchUsers:t=>l.get("/prm/v1/users/search",{params:{q:t}}),getIcalUrl:()=>l.get("/prm/v1/user/ical-url")};function et({checkInterval:t=5*60*1e3}={}){const[s,a]=o.useState(!1),[n]=o.useState(()=>{var u;return((u=window.prmConfig)==null?void 0:u.version)||null}),[r,i]=o.useState(null),c=o.useCallback(async()=>{var u;if(n)try{const v=(u=(await _.getVersion()).data)==null?void 0:u.version;v&&v!==n&&(i(v),a(!0))}catch(g){console.debug("Version check failed:",g.message)}},[n]),x=o.useCallback(()=>{window.location.reload(!0)},[]);return o.useEffect(()=>{const u=setTimeout(c,5e3);return()=>clearTimeout(u)},[c]),o.useEffect(()=>{const u=setInterval(c,t);return()=>clearInterval(u)},[c,t]),o.useEffect(()=>{const u=()=>{document.visibilityState==="visible"&&c()};return document.addEventListener("visibilitychange",u),()=>document.removeEventListener("visibilitychange",u)},[c]),{hasUpdate:s,currentVersion:n,latestVersion:r,reload:x,checkVersion:c}}/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),W=(t,s)=>{const a=o.forwardRef(({color:n="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:x="",children:u,...g},v)=>o.createElement("svg",{ref:v,...tt,width:r,height:r,stroke:n,strokeWidth:c?Number(i)*24/Number(r):i,className:["lucide",`lucide-${st(t)}`,x].join(" "),...g},[...s.map(([d,b])=>o.createElement(d,b)),...Array.isArray(u)?u:[u]]));return a.displayName=`${t}`,a};/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=W("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=W("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=W("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=W("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=W("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=W("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=W("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=W("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=W("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=W("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=W("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=W("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=W("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=W("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=W("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=W("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=W("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=W("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=W("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=W("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=W("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=W("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=W("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Z(t){if(!t)return"";const s=document.createElement("textarea");return s.innerHTML=t,s.value}function ee(t){var a;if(!t)return"";const s=((a=t.title)==null?void 0:a.rendered)||t.title||t.name||"";return Z(s)}function ye(t){var a,n;if(!t)return"";if(t.name&&typeof t.name=="string"&&!((a=t.title)!=null&&a.rendered))return Z(t.name);const s=((n=t.title)==null?void 0:n.rendered)||t.title||t.name||"";return Z(s)}function as(t,s={}){const a=["gender"],n=["contact_info","addresses","work_history","relationships","photo_gallery"],r={...t};return a.forEach(i=>{r[i]===""&&(r[i]=null)}),n.forEach(i=>{Array.isArray(r[i])||(r[i]=[])}),Object.assign(r,s),r}const $={all:["people"],lists:()=>[...$.all,"list"],list:t=>[...$.lists(),t],details:()=>[...$.all,"detail"],detail:t=>[...$.details(),t],timeline:t=>[...$.detail(t),"timeline"],dates:t=>[...$.detail(t),"dates"]};function ze(t){var r,i,c,x,u,g,v,d,b,f,w,L,M,m,N,P,Q;const s=((c=(i=(r=t._embedded)==null?void 0:r["wp:featuredmedia"])==null?void 0:i[0])==null?void 0:c.source_url)||((b=(d=(v=(g=(u=(x=t._embedded)==null?void 0:x["wp:featuredmedia"])==null?void 0:u[0])==null?void 0:g.media_details)==null?void 0:v.sizes)==null?void 0:d.thumbnail)==null?void 0:b.source_url)||null,a=((M=(L=(w=(f=t._embedded)==null?void 0:f["wp:term"])==null?void 0:w.flat())==null?void 0:L.filter(j=>(j==null?void 0:j.taxonomy)==="person_label"))==null?void 0:M.map(j=>j.name))||[],n=Z(((m=t.title)==null?void 0:m.rendered)||"");return{...t,id:t.id,name:n,first_name:((N=t.acf)==null?void 0:N.first_name)||"",last_name:((P=t.acf)==null?void 0:P.last_name)||"",is_favorite:((Q=t.acf)==null?void 0:Q.is_favorite)||!1,is_deceased:t.is_deceased||!1,birth_year:t.birth_year||null,modified:t.modified||null,thumbnail:s,labels:a}}function Ke(t={}){return O({queryKey:$.list(t),queryFn:async()=>{const s=[];let a=1;const n=100;for(;;){const r=await J.getPeople({per_page:n,page:a,_embed:!0,...t}),i=r.data.map(ze);if(s.push(...i),i.length<n)break;const c=parseInt(r.headers["x-wp-totalpages"]||r.headers["X-WP-TotalPages"]||"0",10);if(c>0&&a>=c)break;a++}return s}})}function rs(t){return O({queryKey:$.detail(t),queryFn:async()=>{const s=await J.getPerson(t,{_embed:!0});return ze(s.data)},enabled:!!t})}function ns(t){return O({queryKey:$.timeline(t),queryFn:async()=>(await _.getPersonTimeline(t)).data,enabled:!!t})}function is(t){return O({queryKey:$.dates(t),queryFn:async()=>(await _.getPersonDates(t)).data,enabled:!!t})}function ht({onSuccess:t}={}){const s=E();return A({mutationFn:async a=>{const n=[];a.email&&n.push({contact_type:"email",contact_value:a.email,contact_label:"Email"}),a.phone&&n.push({contact_type:a.phone_type||"mobile",contact_value:a.phone,contact_label:a.phone_type==="mobile"?"Mobile":"Phone"});const r={title:`${a.first_name} ${a.last_name}`.trim(),status:"publish",acf:{first_name:a.first_name,last_name:a.last_name,nickname:a.nickname,gender:a.gender||null,pronouns:a.pronouns||null,how_we_met:a.how_we_met,is_favorite:a.is_favorite,contact_info:n,_visibility:a.visibility||"private",_assigned_workspaces:a.assigned_workspaces||[]}},i=await J.createPerson(r),c=i.data.id;if(a.email)try{await _.sideloadGravatar(c,a.email)}catch{}if(a.birthday&&a.birthdayType)try{await J.createDate({title:`${a.first_name}'s Birthday`,status:"publish",date_type:[a.birthdayType.id],acf:{date_value:a.birthday,is_recurring:!0,related_people:[c],_visibility:"private"}})}catch{}return i.data},onSuccess:a=>{s.invalidateQueries({queryKey:$.lists()}),s.invalidateQueries({queryKey:["dashboard"]}),s.invalidateQueries({queryKey:["reminders"]}),t==null||t(a)}})}function ls(){const t=E();return A({mutationFn:({id:s,data:a})=>J.updatePerson(s,a),onSuccess:(s,{id:a,data:n})=>{var r;t.invalidateQueries({queryKey:$.detail(a)}),t.invalidateQueries({queryKey:$.lists()}),t.invalidateQueries({queryKey:["dashboard"]}),(r=n==null?void 0:n.acf)!=null&&r.relationships&&(Array.isArray(n.acf.relationships)?n.acf.relationships:[]).forEach(c=>{const x=c.related_person;x&&t.invalidateQueries({queryKey:$.detail(x)})})}})}function os(){const t=E();return A({mutationFn:s=>J.deletePerson(s,{force:!0}),onSuccess:()=>{t.invalidateQueries({queryKey:$.lists()}),t.invalidateQueries({queryKey:$.details()}),t.invalidateQueries({queryKey:["dashboard"]})}})}function cs(){const t=E();return A({mutationFn:({ids:s,updates:a})=>_.bulkUpdatePeople(s,a),onSuccess:async()=>{await t.refetchQueries({queryKey:$.lists()}),t.invalidateQueries({queryKey:$.details()})}})}function ds(){const t=E();return A({mutationFn:({personId:s,content:a,visibility:n="private"})=>_.createNote(s,a,n),onSuccess:(s,{personId:a})=>{t.invalidateQueries({queryKey:$.timeline(a)})}})}function us(){const t=E();return A({mutationFn:({noteId:s,personId:a})=>_.deleteNote(s),onSuccess:(s,{personId:a})=>{t.invalidateQueries({queryKey:$.timeline(a)})}})}function ps(){const t=E();return A({mutationFn:({personId:s,data:a})=>_.createActivity(s,a),onSuccess:(s,{personId:a})=>{t.invalidateQueries({queryKey:$.timeline(a)})}})}function ms(){const t=E();return A({mutationFn:({activityId:s,data:a,personId:n})=>_.updateActivity(s,a),onSuccess:(s,{personId:a})=>{a&&t.invalidateQueries({queryKey:$.timeline(a)})}})}function xs(){const t=E();return A({mutationFn:({activityId:s,personId:a})=>_.deleteActivity(s),onSuccess:(s,{personId:a})=>{a&&t.invalidateQueries({queryKey:$.timeline(a)})}})}function yt(){const t=E();return A({mutationFn:({personId:s,data:a})=>_.createTodo(s,a),onSuccess:(s,{personId:a})=>{t.invalidateQueries({queryKey:$.timeline(a)})}})}function hs(){const t=E();return A({mutationFn:({todoId:s,data:a,personId:n})=>_.updateTodo(s,a),onSuccess:(s,{personId:a})=>{a&&t.invalidateQueries({queryKey:$.timeline(a)})}})}function ys(){const t=E();return A({mutationFn:({todoId:s,personId:a})=>_.deleteTodo(s),onSuccess:(s,{personId:a})=>{a&&t.invalidateQueries({queryKey:$.timeline(a)})}})}function fs(){const t=E();return A({mutationFn:({dateId:s,personId:a})=>J.deleteDate(s),onSuccess:(s,{personId:a})=>{a&&(t.invalidateQueries({queryKey:$.dates(a)}),t.invalidateQueries({queryKey:$.detail(a)})),t.invalidateQueries({queryKey:["reminders"]})}})}function ft({onSuccess:t}={}){const s=E();return A({mutationFn:async a=>{const n={title:a.title,status:"publish",date_type:a.date_type,acf:{date_value:a.date_value,related_people:a.related_people,is_recurring:a.is_recurring,year_unknown:a.year_unknown,_visibility:"private"}};return(await J.createDate(n)).data},onSuccess:a=>{s.invalidateQueries({queryKey:["reminders"]}),t==null||t(a)}})}function gt({onSuccess:t}={}){const s=E();return A({mutationFn:async a=>{const n={title:a.title,status:"publish",parent:a.parentId||0,acf:{website:a.website,industry:a.industry,investors:a.investors||[],_visibility:a.visibility||"private",_assigned_workspaces:a.assigned_workspaces||[]}};return(await J.createCompany(n)).data},onSuccess:a=>{s.invalidateQueries({queryKey:["companies"]}),s.invalidateQueries({queryKey:["dashboard"]}),t==null||t(a)}})}function gs(){const t=E();return A({mutationFn:async({ids:s,updates:a})=>(await _.bulkUpdateCompanies(s,a)).data,onSuccess:async()=>{await t.refetchQueries({queryKey:["companies"]})}})}const xe="Caelis";function vs(t){o.useEffect(()=>{var s;if(t){const a=((s=window.prmConfig)==null?void 0:s.siteName)||xe;document.title=`${t} - ${a}`}},[t])}function vt(t){const s=t.match(/\/(?:people|companies|dates)\/(\d+)/);return s?s[1]:null}function bt(t=null){const s=Te();o.useEffect(()=>{var r;let a=t;if(!a){const i=s.pathname,c=vt(i);i==="/"?a="Dashboard":i==="/login"?a="Login":i.startsWith("/people")?i==="/people"||i==="/people/"?a="People":i==="/people/new"?a="New person":i.endsWith("/edit")?a="Edit person":c?a="Person":a="People":i.startsWith("/companies")?i==="/companies"||i==="/companies/"?a="Organizations":i==="/companies/new"?a="New organization":i.endsWith("/edit")?a="Edit organization":c?a="Organization":a="Organizations":i.startsWith("/dates")?i==="/dates"||i==="/dates/"?a="Events":i==="/dates/new"?a="New date":i.endsWith("/edit")?a="Edit date":a="Events":i.startsWith("/settings")?a="Settings":a=xe}const n=((r=window.prmConfig)==null?void 0:r.siteName)||xe;document.title=`${a} - ${n}`},[s.pathname,t])}function bs(){return O({queryKey:["dashboard"],queryFn:async()=>(await _.getDashboard()).data})}function js(t=30){return O({queryKey:["reminders",t],queryFn:async()=>(await _.getReminders(t)).data})}function ws(t=!1){return O({queryKey:["todos",t],queryFn:async()=>(await _.getAllTodos(t)).data})}function Ns(){const t=E();return A({mutationFn:({todoId:s,data:a})=>_.updateTodo(s,a),onSuccess:()=>{t.invalidateQueries({queryKey:["todos"]}),t.invalidateQueries({queryKey:["dashboard"]})}})}function _s(){const t=E();return A({mutationFn:s=>_.deleteTodo(s),onSuccess:()=>{t.invalidateQueries({queryKey:["todos"]}),t.invalidateQueries({queryKey:["dashboard"]})}})}function jt(t){const s=typeof t=="string"?t:"",a=s.length>=2;return O({queryKey:["search",s],queryFn:async()=>a?(await _.search(s)).data:{people:[],companies:[]},enabled:a})}function wt({isOpen:t,onClose:s}){const[a,n]=o.useState(""),[r,i]=o.useState(""),[c,x]=o.useState(""),[u,g]=o.useState(!1),[v,d]=o.useState(""),{data:b=[],isLoading:f}=Ke(),w=yt(),L=E(),M=o.useMemo(()=>{const y=v.toLowerCase().trim();let I=b;return y&&(I=b.filter(k=>{var F,U,R;return((F=k.name)==null?void 0:F.toLowerCase().includes(y))||((U=k.first_name)==null?void 0:U.toLowerCase().includes(y))||((R=k.last_name)==null?void 0:R.toLowerCase().includes(y))})),[...I].sort((k,F)=>(k.name||"").localeCompare(F.name||""))},[b,v]),m=o.useMemo(()=>b.find(y=>y.id===parseInt(c)),[b,c]),N=()=>new Date().toISOString().split("T")[0];if(o.useEffect(()=>{t&&(n(""),i(N()),x(""),d(""),g(!1))},[t]),!t)return null;const P=async y=>{if(y.preventDefault(),!(!a.trim()||!c))try{await w.mutateAsync({personId:parseInt(c),data:{content:a.trim(),due_date:r||null,is_completed:!1}}),L.invalidateQueries({queryKey:["todos"]}),s()}catch{}},Q=()=>{s()},j=y=>{if(!y)return"";try{return new Date(y).toISOString().split("T")[0]}catch{return""}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Add todo"}),e.jsx("button",{onClick:Q,className:"text-gray-400 hover:text-gray-600",disabled:w.isPending,children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:P,className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Person ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>g(!u),className:"w-full flex items-center justify-between px-3 py-2 border border-gray-300 rounded-md bg-white text-left focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",disabled:w.isPending,children:[m?e.jsxs("div",{className:"flex items-center gap-2",children:[m.thumbnail?e.jsx("img",{src:m.thumbnail,alt:m.name,className:"w-6 h-6 rounded-full object-cover"}):e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(ie,{className:"w-4 h-4 text-gray-500"})}),e.jsx("span",{className:"text-gray-900",children:m.name})]}):e.jsx("span",{className:"text-gray-400",children:"Select a person..."}),e.jsx(me,{className:`w-4 h-4 text-gray-400 transition-transform ${u?"rotate-180":""}`})]}),u&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[e.jsx("div",{className:"p-2 border-b border-gray-100",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:v,onChange:y=>d(y.target.value),placeholder:"Search people...",className:"w-full pl-8 pr-3 py-1.5 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-primary-500",autoFocus:!0})]})}),e.jsx("div",{className:"overflow-y-auto max-h-48",children:f?e.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Loading..."}):M.length>0?M.map(y=>e.jsxs("button",{type:"button",onClick:()=>{x(String(y.id)),g(!1),d("")},className:`w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-gray-50 transition-colors ${c===String(y.id)?"bg-primary-50":""}`,children:[y.thumbnail?e.jsx("img",{src:y.thumbnail,alt:y.name,className:"w-6 h-6 rounded-full object-cover"}):e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(ie,{className:"w-4 h-4 text-gray-500"})}),e.jsx("span",{className:"text-sm text-gray-900 truncate",children:y.name})]},y.id)):e.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"No people found"})})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"todo-content",className:"block text-sm font-medium text-gray-700 mb-2",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"todo-content",value:a,onChange:y=>n(y.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"What needs to be done?",disabled:w.isPending})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"todo-due-date",className:"block text-sm font-medium text-gray-700 mb-2",children:"Due date (optional)"}),e.jsx("input",{id:"todo-due-date",type:"date",value:j(r),onChange:y=>i(y.target.value||""),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",disabled:w.isPending})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:Q,className:"btn-secondary",disabled:w.isPending,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:w.isPending||!a.trim()||!c,children:w.isPending?"Adding...":"Add todo"})]})]})]})})}function Nt(){return O({queryKey:["workspaces"],queryFn:async()=>(await _.getWorkspaces()).data})}function ks(t){return O({queryKey:["workspaces",t],queryFn:async()=>(await _.getWorkspace(t)).data,enabled:!!t})}function Cs(){const t=E();return A({mutationFn:async s=>(await _.createWorkspace(s)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["workspaces"]})}})}function Ss(){const t=E();return A({mutationFn:async({id:s,data:a})=>(await _.updateWorkspace(s,a)).data,onSuccess:(s,{id:a})=>{t.invalidateQueries({queryKey:["workspaces"]}),t.invalidateQueries({queryKey:["workspaces",a]})}})}function Ps(){const t=E();return A({mutationFn:async s=>{await _.deleteWorkspace(s)},onSuccess:()=>{t.invalidateQueries({queryKey:["workspaces"]})}})}function qs(){const t=E();return A({mutationFn:async({workspaceId:s,userId:a})=>{await _.removeWorkspaceMember(s,a)},onSuccess:(s,{workspaceId:a})=>{t.invalidateQueries({queryKey:["workspaces",a]})}})}function Ds(){const t=E();return A({mutationFn:async({workspaceId:s,userId:a,role:n})=>(await _.updateWorkspaceMember(s,a,{role:n})).data,onSuccess:(s,{workspaceId:a})=>{t.invalidateQueries({queryKey:["workspaces",a]})}})}function $s(t){return O({queryKey:["workspaces",t,"invites"],queryFn:async()=>(await _.getWorkspaceInvites(t)).data,enabled:!!t})}function Es(){const t=E();return A({mutationFn:async({workspaceId:s,email:a,role:n})=>(await _.createWorkspaceInvite(s,{email:a,role:n})).data,onSuccess:(s,{workspaceId:a})=>{t.invalidateQueries({queryKey:["workspaces",a,"invites"]})}})}function Ts(){const t=E();return A({mutationFn:async({workspaceId:s,inviteId:a})=>{await _.revokeWorkspaceInvite(s,a)},onSuccess:(s,{workspaceId:a})=>{t.invalidateQueries({queryKey:["workspaces",a,"invites"]})}})}function As(t){return O({queryKey:["invite",t],queryFn:async()=>(await _.validateInvite(t)).data,enabled:!!t,retry:!1})}function Ls(){const t=E();return A({mutationFn:async s=>(await _.acceptInvite(s)).data,onSuccess:()=>{t.invalidateQueries({queryKey:["workspaces"]})}})}function Qe({value:t="private",workspaces:s=[],onChange:a,disabled:n=!1}){const[r,i]=o.useState(!1),{data:c=[],isLoading:x}=Nt(),u=[{value:"private",label:"Private",description:"Only you can see this",icon:it},{value:"workspace",label:"Workspace",description:"Share with workspace members",icon:Re}],g=u.find(f=>f.value===t)||u[0],v=g.icon,d=f=>{a==null||a({visibility:f,workspaces:f==="private"?[]:s}),f==="private"&&i(!1)},b=f=>{const w=s.includes(f)?s.filter(L=>L!==f):[...s,f];a==null||a({visibility:t,workspaces:w})};return e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Visibility"}),e.jsxs("button",{type:"button",onClick:()=>!n&&i(!r),disabled:n,className:"w-full flex items-center justify-between px-3 py-2 border border-gray-300 rounded-lg bg-white text-left focus:ring-2 focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-900",children:g.label})]}),e.jsx(me,{className:`w-4 h-4 text-gray-400 transition-transform ${r?"rotate-180":""}`})]}),r&&e.jsxs("div",{className:"absolute z-50 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg",children:[e.jsx("div",{className:"p-2 border-b border-gray-100",children:u.map(f=>{const w=f.icon,L=t===f.value;return e.jsxs("button",{type:"button",onClick:()=>d(f.value),className:`w-full flex items-start gap-3 p-2 rounded-md text-left hover:bg-gray-50 ${L?"bg-primary-50":""}`,children:[e.jsx(w,{className:`w-4 h-4 mt-0.5 ${L?"text-primary-600":"text-gray-400"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`text-sm font-medium ${L?"text-primary-900":"text-gray-900"}`,children:f.label}),e.jsx("div",{className:"text-xs text-gray-500",children:f.description})]}),L&&e.jsx(De,{className:"w-4 h-4 text-primary-600 mt-0.5"})]},f.value)})}),t==="workspace"&&e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2 px-2",children:"Select Workspaces"}),x?e.jsx("div",{className:"px-2 py-3 text-sm text-gray-500",children:"Loading workspaces..."}):c.length===0?e.jsx("div",{className:"px-2 py-3 text-sm text-gray-500",children:"No workspaces available. Create one first."}):e.jsx("div",{className:"max-h-48 overflow-y-auto",children:c.map(f=>{const w=s.includes(f.id);return e.jsxs("button",{type:"button",onClick:()=>b(f.id),className:"w-full flex items-center gap-3 p-2 rounded-md text-left hover:bg-gray-50",children:[e.jsx("div",{className:`flex items-center justify-center w-4 h-4 border-2 rounded ${w?"bg-primary-600 border-primary-600":"border-gray-300"}`,children:w&&e.jsx(De,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-900",children:f.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:[f.member_count," members"]})]})]},f.id)})})]}),t==="workspace"&&e.jsx("div",{className:"p-2 border-t border-gray-100",children:e.jsx("button",{type:"button",onClick:()=>i(!1),className:"w-full px-3 py-2 text-sm font-medium text-primary-600 hover:bg-primary-50 rounded-md",children:"Done"})})]}),t==="workspace"&&s.length>0&&!r&&e.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Shared with ",s.length," workspace",s.length!==1?"s":""]})]})}function _t({isOpen:t,onClose:s,onSubmit:a,isLoading:n,person:r=null}){const i=!!r,[c,x]=o.useState(!1),[u,g]=o.useState(null),[v,d]=o.useState(null),[b,f]=o.useState("private"),[w,L]=o.useState([]),{data:M=[]}=O({queryKey:["date-types"],queryFn:async()=>(await J.getDateTypes()).data,enabled:t&&!i}),m=M.find(h=>h.slug==="birthday"||h.name.toLowerCase()==="birthday"),N=A({mutationFn:async h=>{const S=new FormData;return S.append("file",h),(await l.post("/prm/v1/import/vcard/parse",S,{headers:{"Content-Type":"multipart/form-data"}})).data}}),{register:P,handleSubmit:Q,reset:j,formState:{errors:y}}=je({defaultValues:{first_name:"",last_name:"",nickname:"",gender:"",pronouns:"",email:"",phone:"",phone_type:"mobile",birthday:"",how_we_met:"",is_favorite:!1}});o.useEffect(()=>{var h,S,T,X,B,re,oe,ce,de,ue,p,q,K;if(t)if(g(null),d(null),N.reset(),r){const z=(S=(h=r.acf)==null?void 0:h.contact_info)==null?void 0:S.find(D=>D.contact_type==="email"),Y=(X=(T=r.acf)==null?void 0:T.contact_info)==null?void 0:X.find(D=>D.contact_type==="phone"||D.contact_type==="mobile");j({first_name:((B=r.acf)==null?void 0:B.first_name)||"",last_name:((re=r.acf)==null?void 0:re.last_name)||"",nickname:((oe=r.acf)==null?void 0:oe.nickname)||"",gender:((ce=r.acf)==null?void 0:ce.gender)||"",pronouns:((de=r.acf)==null?void 0:de.pronouns)||"",email:(z==null?void 0:z.contact_value)||"",phone:(Y==null?void 0:Y.contact_value)||"",phone_type:(Y==null?void 0:Y.contact_type)||"mobile",birthday:"",how_we_met:((ue=r.acf)==null?void 0:ue.how_we_met)||"",is_favorite:((p=r.acf)==null?void 0:p.is_favorite)||!1}),f(((q=r.acf)==null?void 0:q._visibility)||"private"),L(((K=r.acf)==null?void 0:K._assigned_workspaces)||[])}else j({first_name:"",last_name:"",nickname:"",gender:"",pronouns:"",email:"",phone:"",phone_type:"mobile",birthday:"",how_we_met:"",is_favorite:!1}),f("private"),L([])},[t,r,j]);const I=o.useCallback(h=>{h.preventDefault(),h.stopPropagation(),h.type==="dragenter"||h.type==="dragover"?x(!0):h.type==="dragleave"&&x(!1)},[]),k=o.useCallback(h=>{h.preventDefault(),h.stopPropagation(),x(!1),d(null),h.dataTransfer.files&&h.dataTransfer.files[0]&&F(h.dataTransfer.files[0])},[]),F=h=>{const S=h.name.split(".").pop().toLowerCase();if(S!=="vcf"&&S!=="vcard"){d("Please select a vCard file (.vcf)");return}g(h),N.mutate(h,{onSuccess:T=>{j({first_name:T.first_name||"",last_name:T.last_name||"",nickname:T.nickname||"",gender:T.gender||"",pronouns:T.pronouns||"",email:T.email||"",phone:T.phone||"",phone_type:T.phone_type||"mobile",birthday:T.birthday||"",how_we_met:T.note||"",is_favorite:!1}),T.contact_count>1&&d(`Note: File contains ${T.contact_count} contacts. Only the first contact was loaded.`)},onError:T=>{var X,B;d(((B=(X=T.response)==null?void 0:X.data)==null?void 0:B.message)||"Failed to parse vCard file"),g(null)}})},U=h=>{d(null),h.target.files&&h.target.files[0]&&F(h.target.files[0])},R=()=>{g(null),d(null),N.reset()};if(!t)return null;const C=h=>{a({...h,birthdayType:m,visibility:b,assigned_workspaces:w})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:i?"Edit person":"Add person"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",disabled:n,children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:Q(C),className:"flex flex-col flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[!i&&e.jsxs("div",{children:[e.jsxs("div",{className:`relative rounded-lg border-2 border-dashed p-3 text-center transition-colors ${c?"border-primary-500 bg-primary-50":u&&!v?"border-green-300 bg-green-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:I,onDragLeave:I,onDragOver:I,onDrop:k,children:[e.jsx("input",{type:"file",accept:".vcf,.vcard",onChange:U,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:n}),N.isPending?e.jsxs("div",{className:"flex items-center justify-center gap-2 py-1",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Parsing vCard..."})]}):u&&!v?e.jsxs("div",{className:"flex items-center justify-center gap-2 py-1",children:[e.jsx(rt,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{className:"text-sm text-green-700",children:["Loaded from ",u.name]}),e.jsx("button",{type:"button",onClick:h=>{h.preventDefault(),h.stopPropagation(),R()},className:"ml-1 p-0.5 hover:bg-green-100 rounded",children:e.jsx(ae,{className:"h-3 w-3 text-green-600"})})]}):e.jsxs("div",{className:"flex items-center justify-center gap-2 py-1",children:[e.jsx(mt,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Drop a vCard or ",e.jsx("span",{className:"text-primary-600",children:"browse"})]})]})]}),v&&e.jsxs("div",{className:"mt-2 flex items-start gap-2 text-xs text-amber-700 bg-amber-50 rounded-lg p-2",children:[e.jsx(be,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:v})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"First name *"}),e.jsx("input",{...P("first_name",{required:"First name is required"}),className:"input",placeholder:"John",disabled:n,autoFocus:!0}),y.first_name&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:y.first_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Last name"}),e.jsx("input",{...P("last_name"),className:"input",placeholder:"Doe",disabled:n})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Nickname"}),e.jsx("input",{...P("nickname"),className:"input",placeholder:"Johnny",disabled:n})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Gender"}),e.jsxs("select",{...P("gender"),className:"input",disabled:n,children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"non_binary",children:"Non-binary"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer_not_to_say",children:"Prefer not to say"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Pronouns"}),e.jsx("input",{...P("pronouns"),type:"text",className:"input",placeholder:"e.g., they/them",disabled:n})]})]}),!i&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{...P("email"),type:"email",className:"input",placeholder:"john@example.com",disabled:n}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Gravatar will be auto-fetched if available"})]}),!i&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{...P("phone_type"),className:"input w-24",disabled:n,children:[e.jsx("option",{value:"mobile",children:"Mobile"}),e.jsx("option",{value:"phone",children:"Phone"})]}),e.jsx("input",{...P("phone"),type:"tel",className:"input flex-1",placeholder:"+1 234 567 890",disabled:n})]})]}),!i&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Birthday"}),e.jsx("input",{...P("birthday"),type:"date",className:"input",disabled:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"How we met"}),e.jsx("textarea",{...P("how_we_met"),className:"input",rows:3,placeholder:"We met at...",disabled:n})]}),e.jsx(Qe,{value:b,workspaces:w,onChange:({visibility:h,workspaces:S})=>{f(h),L(S)},disabled:n}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_favorite",...P("is_favorite"),className:"w-4 h-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500",disabled:n}),e.jsx("label",{htmlFor:"is_favorite",className:"ml-2 text-sm text-gray-700 cursor-pointer",children:"Mark as favorite"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-secondary",disabled:n,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:n,children:n?"Saving...":i?"Save changes":"Create person"})]})]})]})})}function kt({isOpen:t,onClose:s,onSubmit:a,isLoading:n,company:r=null}){var ce,de,ue;const i=!!r,[c,x]=o.useState(!1),[u,g]=o.useState(""),[v,d]=o.useState(""),[b,f]=o.useState(!1),[w,L]=o.useState(""),[M,m]=o.useState([]),[N,P]=o.useState("private"),[Q,j]=o.useState([]),y=o.useRef(null),I=o.useRef(null),{data:k=[],isLoading:F}=O({queryKey:["companies","all"],queryFn:async()=>(await J.getCompanies({per_page:100,_embed:!0})).data,enabled:t}),{data:U=[],isLoading:R}=O({queryKey:["people","all"],queryFn:async()=>(await J.getPeople({per_page:100,_embed:!0})).data,enabled:t}),{register:C,handleSubmit:h,reset:S,formState:{errors:T}}=je({defaultValues:{title:"",website:"",industry:""}}),X=o.useMemo(()=>{const p=u.toLowerCase().trim();let q=k.filter(K=>!(i&&K.id===(r==null?void 0:r.id)||i&&K.parent===(r==null?void 0:r.id)));return p&&(q=q.filter(K=>{var z;return(z=ee(K))==null?void 0:z.toLowerCase().includes(p)})),[...q].sort((K,z)=>(ee(K)||"").localeCompare(ee(z)||""))},[k,u,r,i]),B=o.useMemo(()=>k.find(p=>p.id===parseInt(v)),[k,v]),re=o.useMemo(()=>{const p=w.toLowerCase().trim(),q=U.map(D=>{var G,te,se,pe;return{id:D.id,type:"person",name:Z(((G=D.title)==null?void 0:G.rendered)||""),thumbnail:(pe=(se=(te=D._embedded)==null?void 0:te["wp:featuredmedia"])==null?void 0:se[0])==null?void 0:pe.source_url}}),K=k.filter(D=>!i||D.id!==(r==null?void 0:r.id)).map(D=>{var G,te,se;return{id:D.id,type:"company",name:ee(D),thumbnail:(se=(te=(G=D._embedded)==null?void 0:G["wp:featuredmedia"])==null?void 0:te[0])==null?void 0:se.source_url}});let z=[...q,...K];p&&(z=z.filter(D=>{var G;return(G=D.name)==null?void 0:G.toLowerCase().includes(p)}));const Y=M.map(D=>`${D.type}-${D.id}`);return z=z.filter(D=>!Y.includes(`${D.type}-${D.id}`)),z.sort((D,G)=>(D.name||"").localeCompare(G.name||""))},[U,k,w,M,r,i]);if(o.useEffect(()=>{var p,q,K,z,Y;t&&(x(!1),f(!1),g(""),L(""),r?(S({title:Z(((p=r.title)==null?void 0:p.rendered)||""),website:((q=r.acf)==null?void 0:q.website)||"",industry:((K=r.acf)==null?void 0:K.industry)||""}),d(r.parent?String(r.parent):""),P(((z=r.acf)==null?void 0:z._visibility)||"private"),j(((Y=r.acf)==null?void 0:Y._assigned_workspaces)||[])):(S({title:"",website:"",industry:""}),d(""),m([]),P("private"),j([])))},[t,r,S]),o.useEffect(()=>{var p,q;if(t&&((q=(p=r==null?void 0:r.acf)==null?void 0:p.investors)==null?void 0:q.length)>0&&U.length>0&&k.length>0){const z=r.acf.investors.map(Y=>{var te,se,pe,we,Ne,_e,ke;const D=U.find(he=>he.id===Y);if(D)return{id:D.id,type:"person",name:Z(((te=D.title)==null?void 0:te.rendered)||""),thumbnail:(we=(pe=(se=D._embedded)==null?void 0:se["wp:featuredmedia"])==null?void 0:pe[0])==null?void 0:we.source_url};const G=k.find(he=>he.id===Y);return G?{id:G.id,type:"company",name:ee(G),thumbnail:(ke=(_e=(Ne=G._embedded)==null?void 0:Ne["wp:featuredmedia"])==null?void 0:_e[0])==null?void 0:ke.source_url}:null}).filter(Boolean);m(z)}else t&&!r&&m([])},[t,r,U,k]),o.useEffect(()=>{const p=q=>{y.current&&!y.current.contains(q.target)&&x(!1)};if(c)return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[c]),o.useEffect(()=>{const p=q=>{I.current&&!I.current.contains(q.target)&&f(!1)};if(b)return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[b]),!t)return null;const oe=p=>{a({...p,parentId:v?parseInt(v):0,investors:M.map(q=>q.id),visibility:N,assigned_workspaces:Q})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:i?"Edit organization":"Add organization"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",disabled:n,children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:h(oe),className:"flex flex-col flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Organization name *"}),e.jsx("input",{...C("title",{required:"Organization name is required"}),className:"input",placeholder:"Acme Inc.",disabled:n,autoFocus:!0}),T.title&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:T.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Website"}),e.jsx("input",{...C("website"),type:"url",className:"input",placeholder:"https://example.com",disabled:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Industry"}),e.jsx("input",{...C("industry"),className:"input",placeholder:"Technology",disabled:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Parent organization"}),e.jsxs("div",{className:"relative",ref:y,children:[e.jsxs("button",{type:"button",onClick:()=>x(!c),className:"w-full flex items-center justify-between px-3 py-2 border border-gray-300 rounded-md bg-white text-left focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",disabled:F||n,children:[B?e.jsxs("div",{className:"flex items-center gap-2",children:[(ue=(de=(ce=B._embedded)==null?void 0:ce["wp:featuredmedia"])==null?void 0:de[0])!=null&&ue.source_url?e.jsx("img",{src:B._embedded["wp:featuredmedia"][0].source_url,alt:ee(B),className:"w-6 h-6 rounded object-contain bg-white"}):e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded flex items-center justify-center",children:e.jsx(ne,{className:"w-4 h-4 text-gray-500"})}),e.jsx("span",{className:"text-gray-900",children:ee(B)})]}):e.jsx("span",{className:"text-gray-400",children:"No parent organization"}),e.jsx(me,{className:`w-4 h-4 text-gray-400 transition-transform ${c?"rotate-180":""}`})]}),c&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[e.jsx("div",{className:"p-2 border-b border-gray-100",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:u,onChange:p=>g(p.target.value),placeholder:"Search organizations...",className:"w-full pl-8 pr-3 py-1.5 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-primary-500",autoFocus:!0})]})}),e.jsxs("div",{className:"overflow-y-auto max-h-48",children:[e.jsx("button",{type:"button",onClick:()=>{d(""),x(!1),g("")},className:`w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-gray-50 transition-colors ${v?"":"bg-primary-50"}`,children:e.jsx("span",{className:"text-sm text-gray-500 italic",children:"No parent organization"})}),F?e.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Loading..."}):X.length>0?X.map(p=>{var q,K,z;return e.jsxs("button",{type:"button",onClick:()=>{d(String(p.id)),x(!1),g("")},className:`w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-gray-50 transition-colors ${v===String(p.id)?"bg-primary-50":""}`,children:[(z=(K=(q=p._embedded)==null?void 0:q["wp:featuredmedia"])==null?void 0:K[0])!=null&&z.source_url?e.jsx("img",{src:p._embedded["wp:featuredmedia"][0].source_url,alt:ee(p),className:"w-6 h-6 rounded object-contain bg-white"}):e.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded flex items-center justify-center",children:e.jsx(ne,{className:"w-4 h-4 text-gray-500"})}),e.jsx("span",{className:"text-sm text-gray-900 truncate",children:ee(p)})]},p.id)}):e.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"No organizations found"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select if this organization is a subsidiary or division of another"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label flex items-center",children:[e.jsx(pt,{className:"w-4 h-4 mr-2"}),"Investors"]}),M.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:M.map(p=>e.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-100 rounded-full pl-1 pr-2 py-1",children:[p.thumbnail?e.jsx("img",{src:p.thumbnail,alt:p.name,className:`w-5 h-5 object-cover ${p.type==="person"?"rounded-full":"rounded"}`}):e.jsx("div",{className:`w-5 h-5 bg-gray-300 flex items-center justify-center ${p.type==="person"?"rounded-full":"rounded"}`,children:p.type==="person"?e.jsx(ie,{className:"w-3 h-3 text-gray-500"}):e.jsx(ne,{className:"w-3 h-3 text-gray-500"})}),e.jsx("span",{className:"text-sm text-gray-700",children:p.name}),e.jsx("button",{type:"button",onClick:()=>m(q=>q.filter(K=>!(K.id===p.id&&K.type===p.type))),className:"ml-1 text-gray-400 hover:text-gray-600",disabled:n,children:e.jsx(ae,{className:"w-3.5 h-3.5"})})]},`${p.type}-${p.id}`))}),e.jsxs("div",{className:"relative",ref:I,children:[e.jsxs("button",{type:"button",onClick:()=>f(!b),className:"w-full flex items-center justify-between px-3 py-2 border border-gray-300 rounded-md bg-white text-left focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",disabled:F||R||n,children:[e.jsx("span",{className:"text-gray-400",children:"Add investor..."}),e.jsx(me,{className:`w-4 h-4 text-gray-400 transition-transform ${b?"rotate-180":""}`})]}),b&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-hidden",children:[e.jsx("div",{className:"p-2 border-b border-gray-100",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:w,onChange:p=>L(p.target.value),placeholder:"Search people and organizations...",className:"w-full pl-8 pr-3 py-1.5 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-primary-500",autoFocus:!0})]})}),e.jsx("div",{className:"overflow-y-auto max-h-48",children:F||R?e.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:"Loading..."}):re.length>0?re.map(p=>e.jsxs("button",{type:"button",onClick:()=>{m(q=>[...q,p]),L("")},className:"w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-gray-50 transition-colors",children:[p.thumbnail?e.jsx("img",{src:p.thumbnail,alt:p.name,className:`w-6 h-6 object-cover ${p.type==="person"?"rounded-full":"rounded"}`}):e.jsx("div",{className:`w-6 h-6 bg-gray-200 flex items-center justify-center ${p.type==="person"?"rounded-full":"rounded"}`,children:p.type==="person"?e.jsx(ie,{className:"w-4 h-4 text-gray-500"}):e.jsx(ne,{className:"w-4 h-4 text-gray-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm text-gray-900 truncate block",children:p.name}),e.jsx("span",{className:"text-xs text-gray-500",children:p.type==="person"?"Person":"Organization"})]})]},`${p.type}-${p.id}`)):e.jsx("div",{className:"p-3 text-center text-gray-500 text-sm",children:w?"No results found":"No people or organizations available"})})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select people or organizations that have invested in this company"})]}),e.jsx(Qe,{value:N,workspaces:Q,onChange:({visibility:p,workspaces:q})=>{P(p),j(q)},disabled:n})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-secondary",disabled:n,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:n,children:n?"Saving...":i?"Save changes":"Create organization"})]})]})]})})}function Ct({value:t=[],onChange:s,people:a=[],isLoading:n,currentPersonId:r}){const[i,c]=o.useState(""),x=o.useMemo(()=>{if(!i)return a.slice(0,10);const d=i.toLowerCase();return a.filter(b=>ye(b).toLowerCase().includes(d)).slice(0,10)},[a,i]),u=o.useMemo(()=>t.map(d=>a.find(b=>b.id===d)).filter(Boolean),[t,a]),g=d=>{t.includes(d)||s([...t,d]),c("")},v=d=>{d!==r&&s(t.filter(b=>b!==d))};return e.jsxs("div",{className:"space-y-2",children:[u.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(d=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-primary-100 text-primary-800 rounded-full text-sm",children:[ye(d),d.id!==r&&e.jsx("button",{type:"button",onClick:()=>v(d.id),className:"hover:text-primary-600",children:e.jsx(ae,{className:"w-3 h-3"})})]},d.id))}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:i,onChange:d=>c(d.target.value),placeholder:"Search for people to add...",className:"input",disabled:n}),i&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:x.length>0?x.map(d=>e.jsx("button",{type:"button",onClick:()=>g(d.id),disabled:t.includes(d.id),className:`w-full text-left px-4 py-2 hover:bg-gray-50 ${t.includes(d.id)?"opacity-50 cursor-not-allowed":""}`,children:ye(d)},d.id)):e.jsx("p",{className:"px-4 py-2 text-gray-500 text-sm",children:"No people found"})})]})]})}function St({isOpen:t,onClose:s,onSubmit:a,isLoading:n,dateItem:r=null,personId:i,allPeople:c=[],isPeopleLoading:x=!1}){const u=!!r,{data:g=[]}=O({queryKey:["date-types"],queryFn:async()=>((await J.getDateTypes()).data||[]).sort((I,k)=>{const F=I.name||"",U=k.name||"";return F.localeCompare(U)})}),{register:v,handleSubmit:d,reset:b,watch:f,setValue:w,control:L,formState:{errors:M}}=je({defaultValues:{title:"",date_value:"",date_type:"",related_people:[],is_recurring:!0,year_unknown:!1}}),m=f("related_people"),N=f("date_type"),P=f("title");if(o.useEffect(()=>{var I;if((!P||["'s ","Wedding of "].some(k=>P.includes(k)))&&(m==null?void 0:m.length)>0&&N){const k=g.find(C=>C.id===parseInt(N)),F=(k==null?void 0:k.name)||"",U=((I=k==null?void 0:k.slug)==null?void 0:I.toLowerCase())||F.toLowerCase(),R=m.map(C=>{var S,T,X;const h=c.find(B=>B.id===C);if(h){const B=Z(((S=h.acf)==null?void 0:S.first_name)||h.first_name||""),re=Z(((T=h.acf)==null?void 0:T.last_name)||h.last_name||"");return`${B} ${re}`.trim()||Z(((X=h.title)==null?void 0:X.rendered)||"")}return null}).filter(Boolean);if(R.length>0&&F){let C;U==="wedding"?C=R.length>=2?`Wedding of ${R[0]} & ${R[1]}`:`Wedding of ${R[0]}`:C=`${R[0]}'s ${F}`,w("title",C)}}},[m,N,c,g,w,P]),o.useEffect(()=>{var j,y,I,k,F,U;if(t)if(r){let R=[];const C=r.related_people||((j=r.acf)==null?void 0:j.related_people);C&&(Array.isArray(C)?R=C.map(S=>parseInt(typeof S=="object"&&S!==null?S.ID||S.id||S.post_id:S,10)).filter(S=>!isNaN(S)&&S>0):typeof C=="number"&&(R=[C]));let h="";if(((y=r.date_type)==null?void 0:y.length)>0&&r.date_type[0]!=null){const S=r.date_type[0];if(typeof S=="string"){const T=g.find(X=>X.name.toLowerCase()===S.toLowerCase());h=T?String(T.id):""}else h=String(S)}b({title:Z(((I=r.title)==null?void 0:I.rendered)||r.title||""),date_value:((k=r.acf)==null?void 0:k.date_value)||r.date_value||"",date_type:h,related_people:R,is_recurring:((F=r.acf)==null?void 0:F.is_recurring)??r.is_recurring??!0,year_unknown:((U=r.acf)==null?void 0:U.year_unknown)??r.year_unknown??!1})}else{const R=new Date().toISOString().split("T")[0];b({title:"",date_value:R,date_type:"",related_people:i?[parseInt(i)]:[],is_recurring:!0,year_unknown:!1})}},[t,r,i,b,g]),!t)return null;const Q=j=>{const y=j.date_type?parseInt(j.date_type,10):null,I=y&&!isNaN(y)?[y]:[];a({title:j.title,date_type:I,date_value:j.date_value,related_people:j.related_people,is_recurring:j.is_recurring,year_unknown:j.year_unknown})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:u?"Edit date":"Add date"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",disabled:n,children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:d(Q),className:"flex flex-col flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Related people"}),e.jsx(Se,{name:"related_people",control:L,render:({field:j})=>e.jsx(Ct,{value:j.value,onChange:j.onChange,people:c,isLoading:x,currentPersonId:parseInt(i)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date type *"}),e.jsx(Se,{name:"date_type",control:L,rules:{required:"Please select a date type"},render:({field:j})=>e.jsxs("select",{value:j.value?String(j.value):"",onChange:y=>j.onChange(y.target.value),className:"input",disabled:n,children:[e.jsx("option",{value:"",children:"Select a type..."}),g.map(y=>e.jsx("option",{value:String(y.id),children:y.name},y.id))]})}),M.date_type&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:M.date_type.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Label"}),e.jsx("input",{...v("title"),className:"input",placeholder:"e.g., Mom's Birthday",disabled:n}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-generated from person and date type. You can customize it."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date *"}),e.jsx("input",{...v("date_value",{required:"Date is required"}),type:"date",className:"input",disabled:n}),M.date_value&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:M.date_value.message})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"year_unknown",...v("year_unknown"),className:"w-4 h-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500",disabled:n}),e.jsx("label",{htmlFor:"year_unknown",className:"ml-2 text-sm text-gray-700 cursor-pointer",children:"Year unknown"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_recurring",...v("is_recurring"),className:"w-4 h-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500",disabled:n}),e.jsx("label",{htmlFor:"is_recurring",className:"ml-2 text-sm text-gray-700 cursor-pointer",children:"Repeats every year"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t bg-gray-50",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-secondary",disabled:n,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:n,children:n?"Saving...":u?"Save changes":"Add date"})]})]})]})})}const Pt=[{name:"Dashboard",href:"/",icon:nt},{name:"People",href:"/people",icon:Re},{name:"Organizations",href:"/companies",icon:ne},{name:"Dates",href:"/dates",icon:Ie},{name:"Todos",href:"/todos",icon:Fe},{name:"Workspaces",href:"/workspaces",icon:xt},{name:"Settings",href:"/settings",icon:We}];function $e({mobile:t=!1,onClose:s}){const{logoutUrl:a}=Me();return e.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-200",children:[e.jsxs(Ve,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-primary-600",children:[e.jsx(ut,{className:"w-5 h-5"}),xe]}),t&&e.jsx("button",{onClick:s,className:"p-2 -mr-2",children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1 overflow-y-auto",children:Pt.map(n=>e.jsxs(Oe,{to:n.href,onClick:t?s:void 0,className:({isActive:r})=>`flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ${r?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(n.icon,{className:"w-5 h-5 mr-3"}),n.name]},n.name))}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("a",{href:a,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(lt,{className:"w-5 h-5 mr-3"}),"Log Out"]})})]})}function qt(){var c;const[t,s]=o.useState(!1),a=o.useRef(null),{data:n,isLoading:r}=O({queryKey:["current-user"],queryFn:async()=>(await _.getCurrentUser()).data});if(o.useEffect(()=>{const x=u=>{a.current&&!a.current.contains(u.target)&&s(!1)};if(t)return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[t]),r||!n)return e.jsx("div",{className:"flex items-center ml-auto",children:e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full animate-pulse"})});const i=((c=n.name)==null?void 0:c.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2))||"?";return e.jsxs("div",{className:"relative ml-auto",ref:a,children:[e.jsxs("button",{onClick:()=>s(!t),className:"flex items-center gap-2 p-1 rounded-full hover:bg-gray-100 transition-colors","aria-label":"User menu",children:[n.avatar_url?e.jsx("img",{src:n.avatar_url,alt:n.name,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-primary-700",children:i})}),e.jsx(me,{className:`w-4 h-4 text-gray-500 transition-transform ${t?"rotate-180":""}`})]}),t&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("a",{href:n.profile_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>s(!1),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Edit profile"})]}),n.is_admin&&e.jsxs("a",{href:n.admin_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>s(!1),children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"WordPress admin"})]})]})})]})}function Dt({isOpen:t,onClose:s}){const[a,n]=o.useState(""),[r,i]=o.useState(0),c=Ae(),x=o.useRef(null),u=a.trim(),{data:g,isLoading:v}=jt(u),d=g||{people:[],companies:[]},b=[...(d.people||[]).map(m=>({...m,type:"person"})),...(d.companies||[]).map(m=>({...m,type:"company"}))],f=b.length>0,w=a.trim().length>=2;o.useEffect(()=>{t&&(n(""),i(0),setTimeout(()=>{var m;return(m=x.current)==null?void 0:m.focus()},50))},[t]),o.useEffect(()=>{i(0)},[g]);const L=m=>{if(m.key==="Escape"){s();return}if(!(!w||!f)){if(m.key==="ArrowDown")m.preventDefault(),i(N=>Math.min(N+1,b.length-1));else if(m.key==="ArrowUp")m.preventDefault(),i(N=>Math.max(N-1,0));else if(m.key==="Enter"){m.preventDefault();const N=b[r];N&&M(N.type,N.id)}}},M=(m,N)=>{s(),m==="person"?c(`/people/${N}`):m==="company"&&c(`/companies/${N}`)};return t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),e.jsx("div",{className:"relative min-h-screen flex items-start justify-center pt-[15vh] px-4",children:e.jsxs("div",{className:"relative w-full max-w-xl bg-white rounded-xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center px-4 border-b border-gray-200",children:[e.jsx(le,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),e.jsx("input",{ref:x,type:"text",value:a,onChange:m=>n(m.target.value),onKeyDown:L,placeholder:"Search people & organizations...",className:"flex-1 px-4 py-4 text-lg outline-none placeholder:text-gray-400",autoComplete:"off"}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-gray-500 font-mono",children:"esc"}),e.jsx("span",{children:"to close"})]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:w?v?e.jsxs("div",{className:"px-4 py-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-3 text-sm text-gray-500",children:"Searching..."})]}):f?e.jsxs("div",{className:"py-2",children:[d.people&&d.people.length>0&&e.jsxs("div",{className:"px-2",children:[e.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"People"}),d.people.map((m,N)=>{const Q=r===N;return e.jsxs("button",{onClick:()=>M("person",m.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors text-left ${Q?"bg-primary-50 text-primary-900":"hover:bg-gray-50"}`,children:[m.thumbnail?e.jsx("img",{src:m.thumbnail,alt:m.name,className:"w-8 h-8 rounded-full object-cover"}):e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(ie,{className:"w-4 h-4 text-gray-500"})}),e.jsx("span",{className:"text-sm font-medium flex-1 truncate",children:m.name}),Q&&e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-xs text-gray-500 font-mono",children:""})]},m.id)})]}),d.companies&&d.companies.length>0&&e.jsxs("div",{className:"px-2 mt-2",children:[e.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Organizations"}),d.companies.map((m,N)=>{var j;const P=(((j=d.people)==null?void 0:j.length)||0)+N,Q=r===P;return e.jsxs("button",{onClick:()=>M("company",m.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors text-left ${Q?"bg-primary-50 text-primary-900":"hover:bg-gray-50"}`,children:[m.thumbnail?e.jsx("img",{src:m.thumbnail,alt:m.name,className:"w-8 h-8 rounded object-contain bg-white"}):e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded flex items-center justify-center",children:e.jsx(ne,{className:"w-4 h-4 text-gray-500"})}),e.jsx("span",{className:"text-sm font-medium flex-1 truncate",children:m.name}),Q&&e.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-xs text-gray-500 font-mono",children:""})]},m.id)})]})]}):e.jsx("div",{className:"px-4 py-8 text-center text-gray-500",children:e.jsxs("p",{className:"text-sm",children:['No results found for "',a,'"']})}):e.jsxs("div",{className:"px-4 py-8 text-center text-gray-500",children:[e.jsx(le,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"Type at least 2 characters to search"})]})}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex items-center justify-between text-xs text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-white border border-gray-200 rounded font-mono",children:""}),e.jsx("kbd",{className:"px-1.5 py-0.5 bg-white border border-gray-200 rounded font-mono",children:""}),e.jsx("span",{children:"to navigate"})]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("kbd",{className:"px-1.5 py-0.5 bg-white border border-gray-200 rounded font-mono",children:""}),e.jsx("span",{children:"to select"})]})]})})]})})]}):null}function $t({onAddTodo:t,onAddPerson:s,onAddCompany:a,onAddDate:n}){const[r,i]=o.useState(!1),c=o.useRef(null);o.useEffect(()=>{const d=b=>{c.current&&!c.current.contains(b.target)&&i(!1)};if(r)return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[r]);const x=()=>{i(!1),t()},u=()=>{i(!1),s()},g=()=>{i(!1),a()},v=()=>{i(!1),n()};return e.jsxs("div",{className:"relative",ref:c,children:[e.jsx("button",{onClick:()=>i(!r),className:"flex items-center justify-center w-9 h-9 rounded-lg bg-primary-600 hover:bg-primary-700 text-white transition-colors","aria-label":"Quick add",title:"Quick add",children:e.jsx(ct,{className:"w-5 h-5"})}),r&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:u,className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors text-left",children:[e.jsx(ie,{className:"w-4 h-4 mr-3 text-gray-400"}),"New Person"]}),e.jsxs("button",{onClick:g,className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors text-left",children:[e.jsx(ne,{className:"w-4 h-4 mr-3 text-gray-400"}),"New Organization"]}),e.jsxs("button",{onClick:x,className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors text-left",children:[e.jsx(Fe,{className:"w-4 h-4 mr-3 text-gray-400"}),"New Todo"]}),e.jsxs("button",{onClick:v,className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors text-left",children:[e.jsx(Ie,{className:"w-4 h-4 mr-3 text-gray-400"}),"New Date"]})]})})]})}function Et({onMenuClick:t,onAddTodo:s,onAddPerson:a,onAddCompany:n,onAddDate:r,onOpenSearch:i}){const c=Te(),x=()=>{const u=c.pathname;return u==="/"?"Dashboard":u.startsWith("/people")?"People":u.startsWith("/companies")?"Organizations":u.startsWith("/dates")?"Important Dates":u.startsWith("/todos")?"Todos":u.startsWith("/workspaces")?"Workspaces":u.startsWith("/settings")?"Settings":""};return e.jsxs("header",{className:"sticky top-0 z-10 flex items-center h-16 px-4 bg-white border-b border-gray-200 lg:px-6",children:[e.jsx("button",{onClick:t,className:"p-2 -ml-2 lg:hidden",children:e.jsx(ot,{className:"w-5 h-5"})}),e.jsx("h1",{className:"ml-2 text-lg font-semibold lg:ml-0",children:x()}),e.jsx("div",{className:"flex-1"}),e.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-3 py-1.5 rounded-lg border border-gray-200 hover:bg-gray-50 text-gray-500 transition-colors","aria-label":"Search",title:"Search (K)",children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline text-sm",children:"Search..."}),e.jsxs("kbd",{className:"hidden sm:flex items-center gap-0.5 px-1.5 py-0.5 bg-gray-100 rounded text-xs text-gray-500 font-mono",children:[e.jsx(at,{className:"w-3 h-3"}),"K"]})]}),e.jsx("div",{className:"ml-2",children:e.jsx($t,{onAddTodo:s,onAddPerson:a,onAddCompany:n,onAddDate:r})}),e.jsx("div",{className:"ml-2",children:e.jsx(qt,{})})]})}function Tt({children:t}){const[s,a]=o.useState(!1),[n,r]=o.useState(!1),[i,c]=o.useState(!1),[x,u]=o.useState(!1),[g,v]=o.useState(!1),[d,b]=o.useState(!1),[f,w]=o.useState(!1),[L,M]=o.useState(!1),[m,N]=o.useState(!1),P=Ae();E();const{data:Q=[],isLoading:j}=Ke();bt();const y=ht({onSuccess:C=>{u(!1),P(`/people/${C.id}`)}}),I=gt({onSuccess:C=>{v(!1),P(`/companies/${C.id}`)}}),k=ft({onSuccess:()=>b(!1)}),F=async C=>{w(!0);try{await y.mutateAsync(C)}finally{w(!1)}},U=async C=>{M(!0);try{await I.mutateAsync(C)}finally{M(!1)}},R=async C=>{N(!0);try{await k.mutateAsync(C)}finally{N(!1)}};return o.useEffect(()=>{const C=h=>{(h.metaKey||h.ctrlKey)&&h.key==="k"&&(h.preventDefault(),c(!0))};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[]),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx("div",{className:"hidden lg:flex lg:w-64 lg:flex-col",children:e.jsx($e,{})}),s&&e.jsxs("div",{className:"fixed inset-0 z-40 lg:hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>a(!1)}),e.jsx("div",{className:"fixed inset-y-0 left-0 flex flex-col w-64 bg-white",children:e.jsx($e,{mobile:!0,onClose:()=>a(!1)})})]}),e.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[e.jsx(Et,{onMenuClick:()=>a(!0),onAddTodo:()=>r(!0),onAddPerson:()=>u(!0),onAddCompany:()=>v(!0),onAddDate:()=>b(!0),onOpenSearch:()=>c(!0)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 lg:p-6",children:t})]}),e.jsx(Dt,{isOpen:i,onClose:()=>c(!1)}),e.jsx(wt,{isOpen:n,onClose:()=>r(!1)}),e.jsx(_t,{isOpen:x,onClose:()=>u(!1),onSubmit:F,isLoading:f}),e.jsx(kt,{isOpen:g,onClose:()=>v(!1),onSubmit:U,isLoading:L}),e.jsx(St,{isOpen:d,onClose:()=>b(!1),onSubmit:R,isLoading:m,allPeople:Q,isPeopleLoading:j})]})}const At=o.lazy(()=>H(()=>import("./Dashboard-Dfo3frnW.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Lt=o.lazy(()=>H(()=>import("./PeopleList-BT57Sz5S.js"),__vite__mapDeps([8,1,9,10,6,7,3]))),Mt=o.lazy(()=>H(()=>import("./PersonDetail-TggSwJuI.js"),__vite__mapDeps([11,1,2,3,4,5,12,13,14,7,15,16,17,18,6]))),It=o.lazy(()=>H(()=>import("./FamilyTree-B8-F0aNW.js"),__vite__mapDeps([19,1,20,16,3]))),Ft=o.lazy(()=>H(()=>import("./CompaniesList-Ddodz31k.js"),__vite__mapDeps([21,1,9,10,7,3]))),Wt=o.lazy(()=>H(()=>import("./CompanyDetail-B55uFb1z.js"),__vite__mapDeps([22,1,12,13,14,16,18,3]))),Rt=o.lazy(()=>H(()=>import("./DatesList-D662A6Wr.js"),__vite__mapDeps([23,1,3]))),zt=o.lazy(()=>H(()=>import("./TodosList-BKwbrVei.js"),__vite__mapDeps([24,1,2,3,4,5,15,10,7,25,14]))),Kt=o.lazy(()=>H(()=>import("./Settings-CpnNxF-a.js"),__vite__mapDeps([26,1,27,28,4,17,29,13,18,30,3]))),Qt=o.lazy(()=>H(()=>import("./RelationshipTypes-CmMDEzsh.js"),__vite__mapDeps([31,1,32,14,20,3]))),Ut=o.lazy(()=>H(()=>import("./UserApproval-BV1gD3az.js"),__vite__mapDeps([33,1,32,28,16,34,14,3]))),Vt=o.lazy(()=>H(()=>import("./WorkspacesList-Bmm40fRK.js"),__vite__mapDeps([35,1,3,36,30]))),Ot=o.lazy(()=>H(()=>import("./WorkspaceDetail-8jlgxMr1.js"),__vite__mapDeps([37,1,3,5,16,13,14,36,30]))),Ht=o.lazy(()=>H(()=>import("./WorkspaceSettings-CLuOyWAh.js"),__vite__mapDeps([38,1,3,16,29,14]))),Bt=o.lazy(()=>H(()=>import("./WorkspaceInviteAccept-B3B4AGK7.js"),__vite__mapDeps([39,1,28,34,27,25,3]))),Gt=o.lazy(()=>H(()=>import("./Login-cWqDF3UL.js"),__vite__mapDeps([40,1,3]))),Ee=()=>e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})});function Yt({children:t}){const{data:s,isLoading:a,error:n}=O({queryKey:["current-user"],queryFn:async()=>(await _.getCurrentUser()).data,retry:!1});return a?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):n||!s?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-md w-full mx-4",children:e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:e.jsx(be,{className:"w-8 h-8 text-yellow-600"})})}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Account Pending Approval"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Your account is pending approval by an administrator. You will receive an email notification once your account has been approved."}),e.jsx("p",{className:"text-sm text-gray-500",children:"If you have any questions, please contact your administrator."})]})})}):s!=null&&s.is_admin||s.is_approved?t:e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-md w-full mx-4",children:e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:e.jsx(be,{className:"w-8 h-8 text-yellow-600"})})}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Account Pending Approval"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Your account is pending approval by an administrator. You will receive an email notification once your account has been approved."}),e.jsx("p",{className:"text-sm text-gray-500",children:"If you have any questions, please contact your administrator."})]})})})}function Xt({children:t}){const{isLoggedIn:s,isLoading:a}=Me();return a?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):s?e.jsx(Yt,{children:t}):e.jsx(Le,{to:"/login",replace:!0})}function Jt(){const{hasUpdate:t,latestVersion:s,reload:a}=et();return t?e.jsx("div",{className:"fixed top-0 left-0 right-0 z-[100] bg-primary-600 text-white py-2 px-4 shadow-lg",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-center gap-4 text-sm",children:[e.jsxs("span",{children:["A new version (",s,") is available."]}),e.jsxs("button",{onClick:a,className:"inline-flex items-center gap-2 px-3 py-1 bg-white text-primary-600 rounded-md font-medium hover:bg-primary-50 transition-colors",children:[e.jsx(dt,{className:"w-4 h-4"}),"Reload"]})]})}):null}function Zt(){return e.jsxs(e.Fragment,{children:[e.jsx(Jt,{}),e.jsxs(Ce,{children:[e.jsx(V,{path:"/login",element:e.jsx(o.Suspense,{fallback:e.jsx(Ee,{}),children:e.jsx(Gt,{})})}),e.jsx(V,{path:"/*",element:e.jsx(Xt,{children:e.jsx(Tt,{children:e.jsx(o.Suspense,{fallback:e.jsx(Ee,{}),children:e.jsxs(Ce,{children:[e.jsx(V,{path:"/",element:e.jsx(At,{})}),e.jsx(V,{path:"/people",element:e.jsx(Lt,{})}),e.jsx(V,{path:"/people/:id/family-tree",element:e.jsx(It,{})}),e.jsx(V,{path:"/people/:id",element:e.jsx(Mt,{})}),e.jsx(V,{path:"/companies",element:e.jsx(Ft,{})}),e.jsx(V,{path:"/companies/:id",element:e.jsx(Wt,{})}),e.jsx(V,{path:"/dates",element:e.jsx(Rt,{})}),e.jsx(V,{path:"/todos",element:e.jsx(zt,{})}),e.jsx(V,{path:"/settings",element:e.jsx(Kt,{})}),e.jsx(V,{path:"/settings/relationship-types",element:e.jsx(Qt,{})}),e.jsx(V,{path:"/settings/user-approval",element:e.jsx(Ut,{})}),e.jsx(V,{path:"/workspaces",element:e.jsx(Vt,{})}),e.jsx(V,{path:"/workspaces/:id",element:e.jsx(Ot,{})}),e.jsx(V,{path:"/workspaces/:id/settings",element:e.jsx(Ht,{})}),e.jsx(V,{path:"/workspace-invite/:token",element:e.jsx(Bt,{})}),e.jsx(V,{path:"*",element:e.jsx(Le,{to:"/",replace:!0})})]})})})})})]})]})}const es=new He({defaultOptions:{queries:{staleTime:5*60*1e3,retry:1}}}),fe=document.getElementById("root");if(fe)try{ge.createRoot(fe).render(e.jsx(Be.StrictMode,{children:e.jsx(Ge,{client:es,children:e.jsx(Ye,{children:e.jsx(Zt,{})})})}))}catch{fe.innerHTML='<div style="padding: 20px; color: red;"><h1>Error Loading Application</h1><p>Please check the browser console for details.</p></div>'}export{l as $,xe as A,ne as B,Ie as C,yt as D,hs as E,xs as F,ys as G,vs as H,Z as I,St as J,as as K,it as L,$ as M,gs as N,gt as O,ct as P,le as Q,kt as R,ut as S,pt as T,Re as U,ie as V,js as W,ae as X,ft as Y,_s as Z,wt as _,ws as a,rt as a0,mt as a1,be as a2,dt as a3,Cs as a4,Es as a5,ks as a6,$s as a7,qs as a8,Ds as a9,Ts as aa,We as ab,Ss as ac,Ps as ad,As as ae,Ls as af,Me as ag,bt as ah,Ns as b,W as c,ps as d,Fe as e,Ke as f,Nt as g,cs as h,ht as i,ee as j,De as k,me as l,_t as m,ye as n,rs as o,_ as p,ns as q,is as r,os as s,us as t,bs as u,fs as v,J as w,ls as x,ds as y,ms as z};
