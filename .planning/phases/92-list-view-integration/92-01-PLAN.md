---
phase: 92-list-view-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - includes/customfields/class-manager.php
  - includes/class-rest-custom-fields.php
autonomous: true

must_haves:
  truths:
    - "Field definitions include show_in_list_view property"
    - "Field definitions include list_view_order property"
    - "Metadata endpoint returns these new properties"
  artifacts:
    - path: "includes/customfields/class-manager.php"
      provides: "show_in_list_view and list_view_order in UPDATABLE_PROPERTIES"
      contains: "show_in_list_view"
    - path: "includes/class-rest-custom-fields.php"
      provides: "New properties exposed in metadata endpoint"
      contains: "show_in_list_view"
  key_links:
    - from: "includes/class-rest-custom-fields.php"
      to: "includes/customfields/class-manager.php"
      via: "Manager::get_fields returns fields with new properties"
      pattern: "show_in_list_view"
---

<objective>
Add backend support for list view display configuration on custom fields.

Purpose: Enable admins to configure which custom fields appear as columns in list views and in what order.
Output: Manager class and REST API support for show_in_list_view (boolean) and list_view_order (integer) field properties.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/92-list-view-integration/92-RESEARCH.md
@includes/customfields/class-manager.php
@includes/class-rest-custom-fields.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add list view properties to Manager class</name>
  <files>includes/customfields/class-manager.php</files>
  <action>
Add two new properties to the UPDATABLE_PROPERTIES constant array:
- `show_in_list_view` - Boolean indicating whether field should appear as a column in list view (default: false)
- `list_view_order` - Integer for column order (lower = leftmost, default: 999)

Location: Add after existing properties around line 87, before the closing parenthesis of UPDATABLE_PROPERTIES array.
  </action>
  <verify>
Grep the file: `grep -n "show_in_list_view" includes/customfields/class-manager.php` shows the new property.
  </verify>
  <done>Manager class accepts show_in_list_view and list_view_order as updatable field properties.</done>
</task>

<task type="auto">
  <name>Task 2: Expose list view properties in REST API</name>
  <files>includes/class-rest-custom-fields.php</files>
  <action>
Update three areas:

1. In `get_field_metadata()` method (around line 217-275), add the new properties to the `$display_props` array:
```php
// List view display settings
if ( isset( $field['show_in_list_view'] ) ) {
    $display_props['show_in_list_view'] = (bool) $field['show_in_list_view'];
}
if ( isset( $field['list_view_order'] ) ) {
    $display_props['list_view_order'] = (int) $field['list_view_order'];
}
```
Add these after the existing property extractions (around line 267, before the return statement).

2. In `get_create_params()` method (around line 451), add parameter definitions:
```php
'show_in_list_view' => array(
    'type'        => 'boolean',
    'default'     => false,
    'description' => 'Show field as column in list view',
),
'list_view_order' => array(
    'type'        => 'integer',
    'default'     => 999,
    'description' => 'Column order in list view (lower = leftmost)',
),
```

3. In `create_item()` method (around line 283-326), add the new properties to `$optional_params` array (around line 291).

4. In `update_item()` method (around line 355-398), add the new properties to `$updatable_params` array (around line 360).
  </action>
  <verify>
Test API endpoint responds with new properties:
```bash
curl -s "https://[PRODUCTION_URL]/wp-json/rondo/v1/custom-fields/person/metadata" -H "Cookie: [auth]" | grep -E "(show_in_list_view|list_view_order)"
```
  </verify>
  <done>REST API accepts show_in_list_view and list_view_order parameters and returns them in metadata endpoint.</done>
</task>

</tasks>

<verification>
1. Manager class has both new properties in UPDATABLE_PROPERTIES
2. REST API create/update endpoints accept new parameters
3. Metadata endpoint includes new properties in response
4. Existing fields still work (no regression)
</verification>

<success_criteria>
- show_in_list_view and list_view_order are stored and retrieved via ACF
- Admin can update these properties via PUT /rondo/v1/custom-fields/{post_type}/{key}
- Non-admin metadata endpoint returns these properties for list view rendering
</success_criteria>

<output>
After completion, create `.planning/phases/92-list-view-integration/92-01-SUMMARY.md`
</output>
