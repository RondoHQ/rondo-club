---
phase: 108-offline-support
plan: 02
type: execute
wave: 2
depends_on: ["108-01"]
files_modified:
  - src/components/OfflineBanner.jsx
  - src/App.jsx
autonomous: true

must_haves:
  truths:
    - "User sees 'Je bent offline' banner when network disconnected"
    - "Banner disappears when back online (after brief confirmation)"
    - "Banner is persistent at bottom of screen while offline (not auto-dismiss)"
  artifacts:
    - path: "src/components/OfflineBanner.jsx"
      provides: "Offline indicator banner component"
      exports: ["OfflineBanner"]
      min_lines: 40
  key_links:
    - from: "src/components/OfflineBanner.jsx"
      to: "src/hooks/useOnlineStatus.js"
      via: "hook import"
      pattern: "import.*useOnlineStatus"
    - from: "src/App.jsx"
      to: "src/components/OfflineBanner.jsx"
      via: "component render"
      pattern: "<OfflineBanner"
---

<objective>
Create the OfflineBanner component and mount it in App.jsx to display network status to users.

Purpose: Provide clear visual feedback when user is offline per OFF-04 requirement
Output: Persistent bottom banner showing offline state with brief "back online" confirmation
</objective>

<execution_context>
@/Users/joostdevalk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joostdevalk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/108-offline-support/108-CONTEXT.md
@.planning/phases/108-offline-support/108-RESEARCH.md
@.planning/phases/108-offline-support/108-01-SUMMARY.md

# Key files
@src/hooks/useOnlineStatus.js
@src/App.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create OfflineBanner component</name>
  <files>src/components/OfflineBanner.jsx</files>
  <action>
Create OfflineBanner component that shows:
1. When offline: Persistent bottom banner with "Je bent offline" + WifiOff icon
2. When returning online: Brief "Je bent weer online" + Wifi icon message (2.5 seconds)
3. When online and no recent state change: Nothing rendered

Implementation details from CONTEXT.md and RESEARCH.md:

Styling:
- Fixed bottom positioning (bottom-0, left-0, right-0)
- z-50 to appear above content but below modals (z-50 is high but not highest)
- Subtle/muted styling: gray background when offline, green when showing "back online"
- Dark mode support (dark: variants)
- Transition for smooth appearance

State management:
- Use useOnlineStatus hook for current state
- Track wasOffline with useState to detect offline->online transition
- Track showBackOnline with useState for 2.5s confirmation message
- useEffect to handle transitions and set timeout

Component structure:
```jsx
import { useState, useEffect } from 'react';
import { WifiOff, Wifi } from 'lucide-react';
import { useOnlineStatus } from '@/hooks/useOnlineStatus';

export function OfflineBanner() {
  const isOnline = useOnlineStatus();
  const [wasOffline, setWasOffline] = useState(false);
  const [showBackOnline, setShowBackOnline] = useState(false);

  useEffect(() => {
    if (!isOnline) {
      // Going offline
      setWasOffline(true);
      setShowBackOnline(false);
    } else if (wasOffline) {
      // Coming back online after being offline
      setShowBackOnline(true);
      setWasOffline(false);

      const timer = setTimeout(() => {
        setShowBackOnline(false);
      }, 2500);

      return () => clearTimeout(timer);
    }
  }, [isOnline, wasOffline]);

  // Don't render if online and not showing "back online" message
  if (isOnline && !showBackOnline) {
    return null;
  }

  return (
    <div
      className={`fixed bottom-0 left-0 right-0 z-50 px-4 py-3 text-sm font-medium text-center transition-colors ${
        isOnline
          ? 'bg-green-600 text-white'
          : 'bg-gray-600 text-gray-100 dark:bg-gray-700'
      }`}
    >
      <div className="flex items-center justify-center gap-2">
        {isOnline ? (
          <>
            <Wifi className="w-4 h-4" />
            <span>Je bent weer online</span>
          </>
        ) : (
          <>
            <WifiOff className="w-4 h-4" />
            <span>Je bent offline</span>
          </>
        )}
      </div>
    </div>
  );
}
```

Dutch text per CONTEXT.md decision and project localization (v7.0).
  </action>
  <verify>
- File exists: `ls src/components/OfflineBanner.jsx`
- Exports correctly: `grep -q "export function OfflineBanner" src/components/OfflineBanner.jsx`
- Uses hook: `grep -q "useOnlineStatus" src/components/OfflineBanner.jsx`
- Dutch text: `grep -q "Je bent offline" src/components/OfflineBanner.jsx`
- `npm run lint` passes
  </verify>
  <done>OfflineBanner component created with Dutch text, persistent offline state, and brief back-online confirmation</done>
</task>

<task type="auto">
  <name>Task 2: Mount OfflineBanner in App.jsx</name>
  <files>src/App.jsx</files>
  <action>
Add OfflineBanner to App.jsx so it renders globally across all routes.

Implementation:
1. Import OfflineBanner from '@/components/OfflineBanner'
2. Add <OfflineBanner /> inside the app-root div, after ReloadPrompt

The banner should be visible on all pages, including login. Place it after the existing global components (UpdateBanner, ReloadPrompt).

Location in App function return:
```jsx
return (
  <div className="app-root">
    <UpdateBanner />
    <ReloadPrompt />
    <OfflineBanner />  {/* Add this line */}
    <Routes>
      ...
    </Routes>
  </div>
);
```

Note: The OfflineBanner renders at bottom of screen (fixed positioning), so order in JSX doesn't affect visual stacking with UpdateBanner (which is at top).
  </action>
  <verify>
- Import present: `grep -q "OfflineBanner" src/App.jsx`
- Component rendered: `grep -q "<OfflineBanner" src/App.jsx`
- `npm run lint` passes
- `npm run build` succeeds
  </verify>
  <done>OfflineBanner mounted globally in App.jsx, visible across all routes</done>
</task>

</tasks>

<verification>
After all tasks:
1. `npm run lint` passes
2. `npm run build` succeeds
3. OfflineBanner component exists with correct exports
4. App.jsx imports and renders OfflineBanner
5. Dutch text present: "Je bent offline" and "Je bent weer online"
</verification>

<success_criteria>
- OfflineBanner.jsx created in src/components/
- Component uses useOnlineStatus hook
- Shows persistent banner while offline with WifiOff icon
- Shows brief (2.5s) "back online" confirmation with Wifi icon
- Dutch text used throughout
- Mounted in App.jsx after ReloadPrompt
- All lint checks pass
- Build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/108-offline-support/108-02-SUMMARY.md`
</output>
