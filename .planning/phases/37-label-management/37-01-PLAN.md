---
phase: 37-label-management
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/Settings/Labels.jsx
  - src/pages/Settings/Settings.jsx
  - src/api/client.js
  - src/App.jsx
autonomous: true
---

<objective>
Create a full CRUD interface for managing person and company labels.

Purpose: Allow users to create, edit, and delete labels from the Settings page instead of only through WordPress admin.
Output: New Labels management page at /settings/labels with tabbed interface for person/company labels.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Existing patterns to follow:
@src/pages/Settings/RelationshipTypes.jsx
@src/pages/Settings/Settings.jsx
@src/api/client.js (wpApi methods for relationship_type)
@includes/class-taxonomies.php (person_label, company_label taxonomies)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add label API methods to client.js</name>
  <files>src/api/client.js</files>
  <action>
Add CRUD methods for person_label and company_label taxonomies to the wpApi object:

```javascript
// Person labels
getPersonLabels: () => api.get('/wp/v2/person_label', { params: { per_page: 100, _fields: 'id,name,slug,count' } }),
createPersonLabel: (data) => api.post('/wp/v2/person_label', data),
updatePersonLabel: (id, data) => api.post(`/wp/v2/person_label/${id}`, data),
deletePersonLabel: (id) => api.delete(`/wp/v2/person_label/${id}?force=true`),

// Company labels
getCompanyLabels: () => api.get('/wp/v2/company_label', { params: { per_page: 100, _fields: 'id,name,slug,count' } }),
createCompanyLabel: (data) => api.post('/wp/v2/company_label', data),
updateCompanyLabel: (id, data) => api.post(`/wp/v2/company_label/${id}`, data),
deleteCompanyLabel: (id) => api.delete(`/wp/v2/company_label/${id}?force=true`),
```

Add these after the existing relationship_type methods (around line 71).
  </action>
  <verify>No syntax errors in client.js - `npm run build` succeeds</verify>
  <done>
- 8 new API methods added for person and company labels
- Methods follow same pattern as relationship_type methods
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Labels management page</name>
  <files>src/pages/Settings/Labels.jsx</files>
  <action>
Create a new Labels.jsx component following the RelationshipTypes.jsx pattern:

1. Admin-only access check (same pattern as RelationshipTypes)
2. Tabbed interface for "People Labels" and "Organization Labels"
3. Each tab displays a list of labels with:
   - Label name
   - Count of items using this label
   - Edit button (inline editing)
   - Delete button (with confirmation)
4. Add new label form at top when "Add Label" button clicked
5. Use React Query for data fetching/mutations (same pattern)

Key differences from RelationshipTypes:
- No inverse relationship field (labels are simpler)
- Add "count" display showing how many people/companies use each label
- Add tabs to switch between person_label and company_label taxonomies
- Use wpApi.getPersonLabels/getCompanyLabels etc.

Component structure:
```jsx
export default function Labels() {
  // Admin check
  // State: activeTab ('person' | 'company'), editingId, editingName, newName, isAdding
  // Queries: personLabels, companyLabels based on activeTab
  // Mutations: create, update, delete (pass taxonomy type)

  // Tab component for switching
  // Label list with inline edit mode
  // Add new form (shown when isAdding)
}
```

Use Tailwind classes matching existing Settings pages.
Import icons from lucide-react: Save, Plus, Trash2, Edit2, X, ShieldAlert, Tag
  </action>
  <verify>`npm run lint` passes, `npm run build` succeeds</verify>
  <done>
- Labels.jsx created in src/pages/Settings/
- Tabbed interface for person and company labels
- Full CRUD functionality (create, read, update, delete)
- Count display for each label
- Admin-only access enforced
  </done>
</task>

<task type="auto">
  <name>Task 3: Add route and navigation link</name>
  <files>src/App.jsx, src/pages/Settings/Settings.jsx</files>
  <action>
1. In src/App.jsx, add lazy import and route:
   - Add: `const Labels = lazy(() => import('./pages/Settings/Labels'));`
   - Add route inside Settings parent route: `<Route path="labels" element={<Labels />} />`
   (Place after the relationship-types route, around line 45)

2. In src/pages/Settings/Settings.jsx, add navigation link in AdminTab:
   - In the "Configuration" card section (around line 1175), add a Link to "/settings/labels":
   ```jsx
   <Link
     to="/settings/labels"
     className="block p-4 rounded-lg border border-gray-200 hover:bg-gray-50 hover:border-gray-300 transition-colors"
   >
     <p className="font-medium">Labels</p>
     <p className="text-sm text-gray-500">Manage labels for people and organizations</p>
   </Link>
   ```
   Add this after the existing "Relationship types" link.
  </action>
  <verify>
- `npm run build` succeeds
- Navigate to /settings/labels shows the Labels page
- Link visible in Settings > Admin > Configuration section
  </verify>
  <done>
- Route /settings/labels added to App.jsx
- Navigation link added to Settings Admin tab
- Lazy loading configured for Labels component
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] /settings/labels page loads and shows tabbed interface
- [ ] Can create, edit, delete person labels
- [ ] Can create, edit, delete company labels
- [ ] Labels show item count
- [ ] Non-admin users see access denied
- [ ] Navigation link visible in Settings > Admin > Configuration
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript/lint errors introduced
- Labels CRUD fully functional for both taxonomies
- UI matches existing Settings page patterns
</success_criteria>

<output>
After completion, create `.planning/phases/37-label-management/37-01-SUMMARY.md`
</output>
