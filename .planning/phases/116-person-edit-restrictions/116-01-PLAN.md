---
phase: 116-person-edit-restrictions
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/People/PersonDetail.jsx
autonomous: true

must_haves:
  truths:
    - "PersonDetail page has no delete button visible"
    - "PersonDetail page has no add address button visible"
    - "Address section has no edit or delete controls"
    - "Work history section has no add function button visible"
    - "Work history items have no edit or delete controls"
    - "Work history items appear as static content (no hover effects)"
    - "REST API DELETE /wp/v2/people/{id} still works"
  artifacts:
    - path: "src/pages/People/PersonDetail.jsx"
      provides: "Person detail page with restricted editing"
      contains: "No Verwijderen button, no address controls, no work history controls"
  key_links:
    - from: "PersonDetail.jsx"
      to: "REST API"
      via: "Unchanged API mutations remain available"
      pattern: "deletePerson.mutateAsync"
---

<objective>
Remove delete, address editing, and work history editing controls from PersonDetail UI

Purpose: Sportlink-synced data should not be editable through the UI while REST API remains fully functional for automation and sync processes.

Output: PersonDetail.jsx with restricted editing capabilities - no delete button, no address add/edit/delete, no work history add/edit/delete. All removed sections appear as read-only static content.
</objective>

<execution_context>
@/Users/joostdevalk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joostdevalk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/116-person-edit-restrictions/116-CONTEXT.md
@.planning/phases/116-person-edit-restrictions/116-RESEARCH.md
@src/pages/People/PersonDetail.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove delete button and handler</name>
  <files>src/pages/People/PersonDetail.jsx</files>
  <action>
Remove the delete button from the header actions area:

1. Find and REMOVE the delete button (around line 1566-1569):
```jsx
<button onClick={handleDelete} className="btn-danger-outline">
  <Trash2 className="w-4 h-4 md:mr-2" />
  <span className="hidden md:inline">Verwijderen</span>
</button>
```

2. Find and REMOVE the handleDelete function (around line 450-471):
```jsx
const handleDelete = async () => {
  if (!window.confirm('Weet je zeker dat je dit lid wilt verwijderen?')) {
    return;
  }
  // ... rest of function
};
```

Note: The deletePerson mutation hook should remain - it may be used by other parts of the app or tests. Only remove the UI control and handler function.
  </action>
  <verify>
- Grep for "Verwijderen" in PersonDetail.jsx returns no results
- Grep for "handleDelete" (exact function, not handleDeleteAddress etc) in PersonDetail.jsx shows only other handlers like handleDeleteNote, handleDeleteActivity, etc.
- File has no syntax errors: `npm run lint`
  </verify>
  <done>
Delete button no longer appears in PersonDetail header. The REST API endpoint remains functional.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove address editing controls and dead code</name>
  <files>src/pages/People/PersonDetail.jsx</files>
  <action>
Remove all address editing UI controls and related dead code:

1. REMOVE the add address button (around lines 2051-2061):
```jsx
<button
  onClick={() => {
    setEditingAddress(null);
    setEditingAddressIndex(null);
    setShowAddressModal(true);
  }}
  className="btn-secondary text-sm"
  title="Adres toevoegen"
>
  <Plus className="w-4 h-4" />
</button>
```

2. REMOVE the edit/delete controls div from each address item (around lines 2092-2111):
```jsx
<div className="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity ml-2">
  <button onClick={() => {...}} className="p-1 hover:bg-gray-100..." title="Adres bewerken">
    <Pencil className="w-4 h-4 text-gray-400 hover:text-gray-600" />
  </button>
  <button onClick={() => handleDeleteAddress(index)} className="p-1 hover:bg-red-50..." title="Adres verwijderen">
    <Trash2 className="w-4 h-4 text-gray-400 hover:text-red-600" />
  </button>
</div>
```

3. REMOVE the `group` class from address item container:
Change `<div key={index} className="flex items-start group">` to `<div key={index} className="flex items-start">`

4. UPDATE the empty state (around line 2117-2119) - remove the add link:
Change from:
```jsx
<p className="text-sm text-gray-500 text-center py-4">
  Nog geen adressen. <button onClick={() => {...}} className="text-accent-600 hover:underline">Toevoegen</button>
</p>
```
To:
```jsx
<p className="text-sm text-gray-500 text-center py-4">
  Nog geen adressen.
</p>
```

5. REMOVE dead code - these are now unused:
- State variables: `showAddressModal`, `editingAddress`, `editingAddressIndex`
- Handler functions: `handleDeleteAddress`, `handleSaveAddress`
- The AddressEditModal JSX and import (if only used for person addresses)

Check if AddressEditModal is used elsewhere in the file before removing its import.
  </action>
  <verify>
- Grep for "Adres toevoegen" in PersonDetail.jsx returns no results
- Grep for "Adres bewerken" in PersonDetail.jsx returns no results
- Grep for "showAddressModal" in PersonDetail.jsx returns no results
- Address section still displays existing addresses (visual check on any person with addresses)
- `npm run lint` passes
  </verify>
  <done>
Address section displays read-only. No add, edit, or delete controls visible. Dead code removed.
  </done>
</task>

<task type="auto">
  <name>Task 3: Remove work history editing controls and dead code</name>
  <files>src/pages/People/PersonDetail.jsx</files>
  <action>
Remove all work history editing UI controls and related dead code:

1. REMOVE the add function button (around lines 2293-2303):
```jsx
<button
  onClick={() => {
    setEditingWorkHistory(null);
    setEditingWorkHistoryIndex(null);
    setShowWorkHistoryModal(true);
  }}
  className="btn-secondary text-sm"
  title="Functie toevoegen"
>
  <Plus className="w-4 h-4" />
</button>
```

2. REMOVE the edit/delete controls div from each work history item (around lines 2343-2363):
```jsx
<div className="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity ml-2">
  <button onClick={() => {...}} className="p-1 hover:bg-gray-100..." title="Functie bewerken">
    <Pencil className="w-4 h-4 text-gray-400 hover:text-gray-600" />
  </button>
  <button onClick={() => handleDeleteWorkHistory(originalIndex)} className="p-1 hover:bg-red-50..." title="Functie verwijderen">
    <Trash2 className="w-4 h-4 text-gray-400 hover:text-red-600" />
  </button>
</div>
```

3. REMOVE the `group` class from work history item container:
Change `<div key={originalIndex} className="flex items-start group">` to `<div key={originalIndex} className="flex items-start">`

4. UPDATE the empty state (around line 2369-2371) - remove the add link:
Change from:
```jsx
<p className="text-sm text-gray-500 text-center py-4">
  Nog geen functiegeschiedenis. <button onClick={() => {...}} className="text-accent-600 hover:underline">Toevoegen</button>
</p>
```
To:
```jsx
<p className="text-sm text-gray-500 text-center py-4">
  Nog geen functiegeschiedenis.
</p>
```

5. REMOVE dead code - these are now unused:
- State variables: `showWorkHistoryModal`, `editingWorkHistory`, `editingWorkHistoryIndex`, `isSavingWorkHistory`
- Handler functions: `handleDeleteWorkHistory`, `handleSaveWorkHistory`
- The WorkHistoryEditModal JSX and import

6. REMOVE the WorkHistoryEditModal import at the top of the file:
```jsx
import WorkHistoryEditModal from '@/components/WorkHistoryEditModal';
```

And remove its JSX rendering (around lines 2909-2919).
  </action>
  <verify>
- Grep for "Functie toevoegen" in PersonDetail.jsx returns no results
- Grep for "Functie bewerken" in PersonDetail.jsx returns no results
- Grep for "showWorkHistoryModal" in PersonDetail.jsx returns no results
- Grep for "WorkHistoryEditModal" in PersonDetail.jsx returns no results
- Work history section still displays existing entries (visual check)
- Work history items have no hover effect (no pointer cursor, no opacity transition)
- `npm run lint` passes with no warnings
- `npm run build` completes successfully
  </verify>
  <done>
Work history section displays read-only as static content. No add, edit, or delete controls. No interactive hover effects. Dead code removed.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Lint check:** `npm run lint` passes with 0 warnings
2. **Build check:** `npm run build` completes successfully
3. **Visual verification on production:**
   - Navigate to any person detail page
   - Confirm NO "Verwijderen" button in header
   - Confirm address section shows addresses but NO add/edit/delete buttons
   - Confirm work history section shows jobs but NO add/edit/delete buttons
   - Confirm hovering over work history items shows NO visual change (no opacity transition)
4. **API verification:** REST API remains functional (not changed by this phase)
</verification>

<success_criteria>
- PersonDetail.jsx compiles without errors or warnings
- Delete button removed from header
- Address section is read-only (no add, edit, delete controls)
- Work history section is read-only (no add, edit, delete controls)
- Work history displays as static content (no hover interactivity)
- Empty states show simple messages without "Toevoegen" links
- All dead code (unused handlers, state, imports) removed
- Production deployment shows restricted UI
</success_criteria>

<output>
After completion, create `.planning/phases/116-person-edit-restrictions/116-01-SUMMARY.md`
</output>
