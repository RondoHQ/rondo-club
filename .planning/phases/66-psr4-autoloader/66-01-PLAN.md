---
phase: 66-psr4-autoloader
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [includes/class-post-types.php, includes/class-taxonomies.php, includes/class-access-control.php, includes/class-visibility.php, includes/class-user-roles.php, includes/class-auto-title.php, includes/class-rest-base.php, includes/class-rest-api.php, includes/class-rest-people.php, includes/class-rest-teams.php, includes/class-rest-todos.php, includes/class-rest-workspaces.php, includes/class-rest-slack.php, includes/class-rest-import-export.php, includes/class-rest-calendar.php]
autonomous: true
---

<objective>
Add PSR-4 namespaces to core WordPress integration and REST API controller classes.

Purpose: Enable Composer autoloading by adding namespace declarations to the foundational classes that other classes depend on.
Output: 15 PHP files with proper Stadion\Core and Stadion\REST namespace declarations.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/64-audit-planning/AUDIT.md
@.planning/phases/65-split-reorganize/65-01-SUMMARY.md

Namespace mapping from AUDIT.md:
- RONDO_Post_Types → Stadion\Core\PostTypes
- RONDO_Taxonomies → Stadion\Core\Taxonomies
- RONDO_Access_Control → Stadion\Core\AccessControl
- RONDO_Visibility → Stadion\Core\Visibility
- RONDO_User_Roles → Stadion\Core\UserRoles
- RONDO_Auto_Title → Stadion\Core\AutoTitle
- RONDO_REST_Base → Stadion\REST\Base
- RONDO_REST_API → Stadion\REST\Api
- RONDO_REST_People → Stadion\REST\People
- RONDO_REST_Teams → Stadion\REST\Teams
- RONDO_REST_Todos → Stadion\REST\Todos
- RONDO_REST_Workspaces → Stadion\REST\Workspaces
- RONDO_REST_Slack → Stadion\REST\Slack
- RONDO_REST_Import_Export → Stadion\REST\ImportExport
- RONDO_REST_Calendar → Stadion\REST\Calendar

Relevant source files:
@includes/class-post-types.php
@includes/class-rest-base.php
@functions.php (for understanding current class loading)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add namespaces to Core classes</name>
  <files>includes/class-post-types.php, includes/class-taxonomies.php, includes/class-access-control.php, includes/class-visibility.php, includes/class-user-roles.php, includes/class-auto-title.php</files>
  <action>
For each of the 6 core class files:

1. Add namespace declaration after the opening PHP tag and file docblock:
   ```php
   namespace Stadion\Core;
   ```

2. Rename the class to remove RONDO_ prefix:
   - `class RONDO_Post_Types` → `class PostTypes`
   - `class RONDO_Taxonomies` → `class Taxonomies`
   - `class RONDO_Access_Control` → `class AccessControl`
   - `class RONDO_Visibility` → `class Visibility`
   - `class RONDO_User_Roles` → `class UserRoles`
   - `class RONDO_Auto_Title` → `class AutoTitle`

3. Keep the ABSPATH check BEFORE the namespace declaration (WordPress security pattern).

4. Do NOT add `use` statements yet - those will be added in Plan 66-04 when updating references.

Example transformation for class-post-types.php:
```php
<?php
/**
 * Custom Post Types Registration
 */

if ( ! defined( 'ABSPATH' ) ) {
    exit;
}

namespace Stadion\Core;

class PostTypes {
    // ... rest of class unchanged
}
```
  </action>
  <verify>Each file has `namespace Stadion\Core;` and class name without RONDO_ prefix: `grep -l "namespace Stadion\\\\Core" includes/class-post-types.php includes/class-taxonomies.php includes/class-access-control.php includes/class-visibility.php includes/class-user-roles.php includes/class-auto-title.php`</verify>
  <done>6 core classes have Stadion\Core namespace and renamed class names</done>
</task>

<task type="auto">
  <name>Task 2: Add namespaces to REST classes</name>
  <files>includes/class-rest-base.php, includes/class-rest-api.php, includes/class-rest-people.php, includes/class-rest-teams.php, includes/class-rest-todos.php, includes/class-rest-workspaces.php, includes/class-rest-slack.php, includes/class-rest-import-export.php, includes/class-rest-calendar.php</files>
  <action>
For each of the 9 REST class files:

1. Add namespace declaration after ABSPATH check:
   ```php
   namespace Stadion\REST;
   ```

2. Rename the class to remove RONDO_REST_ prefix:
   - `class RONDO_REST_Base` → `class Base`
   - `class RONDO_REST_API` → `class Api`
   - `class RONDO_REST_People` → `class People`
   - `class RONDO_REST_Teams` → `class Teams`
   - `class RONDO_REST_Todos` → `class Todos`
   - `class RONDO_REST_Workspaces` → `class Workspaces`
   - `class RONDO_REST_Slack` → `class Slack`
   - `class RONDO_REST_Import_Export` → `class ImportExport`
   - `class RONDO_REST_Calendar` → `class Calendar`

3. For classes that extend RONDO_REST_Base, update the extends clause:
   - `extends RONDO_REST_Base` → `extends Base`
   (This works because they're in the same namespace)

4. Keep ABSPATH check before namespace declaration.

Example for class-rest-people.php:
```php
<?php
/**
 * People REST API
 */

if ( ! defined( 'ABSPATH' ) ) {
    exit;
}

namespace Stadion\REST;

class People extends Base {
    // ... rest unchanged
}
```
  </action>
  <verify>Each REST file has `namespace Stadion\REST;` and proper class names: `grep -l "namespace Stadion\\\\REST" includes/class-rest-*.php`</verify>
  <done>9 REST classes have Stadion\REST namespace and renamed class names, extends clauses updated</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All 15 files have namespace declarations
- [ ] All class names are renamed (no RONDO_ prefix)
- [ ] REST classes extending Base use `extends Base` (same namespace)
- [ ] ABSPATH checks remain in place before namespace
- [ ] `php -l` passes on all modified files (syntax check)
</verification>

<success_criteria>
- All tasks completed
- 6 Core classes namespaced as Stadion\Core\*
- 9 REST classes namespaced as Stadion\REST\*
- No PHP syntax errors
- Files follow PSR-4 naming convention ready for autoloading
</success_criteria>

<output>
After completion, create `.planning/phases/66-psr4-autoloader/66-01-SUMMARY.md`
</output>
