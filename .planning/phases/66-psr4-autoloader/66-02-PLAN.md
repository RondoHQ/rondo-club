---
phase: 66-psr4-autoloader
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [includes/class-calendar-connections.php, includes/class-calendar-matcher.php, includes/class-calendar-sync.php, includes/class-google-calendar-provider.php, includes/class-caldav-provider.php, includes/class-google-oauth.php, includes/class-notification-channel.php, includes/class-email-channel.php, includes/class-slack-channel.php, includes/class-comment-types.php, includes/class-workspace-members.php, includes/class-mentions.php, includes/class-mention-notifications.php, includes/class-reminders.php]
autonomous: true
---

<objective>
Add PSR-4 namespaces to calendar, notification, and collaboration feature classes.

Purpose: Enable Composer autoloading for feature modules that handle calendar sync, notifications, and team collaboration.
Output: 14 PHP files with proper Caelis\Calendar, Caelis\Notifications, and Caelis\Collaboration namespace declarations.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/64-audit-planning/AUDIT.md

Namespace mapping from AUDIT.md:
- PRM_Calendar_Connections → Caelis\Calendar\Connections
- PRM_Calendar_Matcher → Caelis\Calendar\Matcher
- PRM_Calendar_Sync → Caelis\Calendar\Sync
- PRM_Google_Calendar_Provider → Caelis\Calendar\GoogleProvider
- PRM_CalDAV_Provider → Caelis\Calendar\CalDAVProvider
- PRM_Google_OAuth → Caelis\Calendar\GoogleOAuth
- PRM_Notification_Channel → Caelis\Notifications\Channel
- PRM_Email_Channel → Caelis\Notifications\EmailChannel
- PRM_Slack_Channel → Caelis\Notifications\SlackChannel
- PRM_Comment_Types → Caelis\Collaboration\CommentTypes
- PRM_Workspace_Members → Caelis\Collaboration\WorkspaceMembers
- PRM_Mentions → Caelis\Collaboration\Mentions
- PRM_Mention_Notifications → Caelis\Collaboration\MentionNotifications
- PRM_Reminders → Caelis\Collaboration\Reminders

Relevant source files:
@includes/class-calendar-sync.php
@includes/class-notification-channel.php
@includes/class-email-channel.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add namespaces to Calendar classes</name>
  <files>includes/class-calendar-connections.php, includes/class-calendar-matcher.php, includes/class-calendar-sync.php, includes/class-google-calendar-provider.php, includes/class-caldav-provider.php, includes/class-google-oauth.php</files>
  <action>
For each of the 6 calendar class files:

1. Add namespace declaration after ABSPATH check:
   ```php
   namespace Caelis\Calendar;
   ```

2. Rename the class to remove PRM_ prefix:
   - `class PRM_Calendar_Connections` → `class Connections`
   - `class PRM_Calendar_Matcher` → `class Matcher`
   - `class PRM_Calendar_Sync` → `class Sync`
   - `class PRM_Google_Calendar_Provider` → `class GoogleProvider`
   - `class PRM_CalDAV_Provider` → `class CalDAVProvider`
   - `class PRM_Google_OAuth` → `class GoogleOAuth`

3. Keep ABSPATH check before namespace declaration.

4. Do NOT update references to other classes yet - that happens in Plan 66-04.

Example for class-calendar-sync.php:
```php
<?php
/**
 * Calendar Sync Handler
 */

if ( ! defined( 'ABSPATH' ) ) {
    exit;
}

namespace Caelis\Calendar;

class Sync {
    // ... rest unchanged
}
```
  </action>
  <verify>Each calendar file has proper namespace: `grep -l "namespace Caelis\\\\Calendar" includes/class-calendar-*.php includes/class-google-calendar-provider.php includes/class-caldav-provider.php includes/class-google-oauth.php`</verify>
  <done>6 calendar classes have Caelis\Calendar namespace and renamed class names</done>
</task>

<task type="auto">
  <name>Task 2: Add namespaces to Notification and Collaboration classes</name>
  <files>includes/class-notification-channel.php, includes/class-email-channel.php, includes/class-slack-channel.php, includes/class-comment-types.php, includes/class-workspace-members.php, includes/class-mentions.php, includes/class-mention-notifications.php, includes/class-reminders.php</files>
  <action>
For the 3 notification class files, add namespace:
```php
namespace Caelis\Notifications;
```

Rename notification classes:
- `abstract class PRM_Notification_Channel` → `abstract class Channel`
- `class PRM_Email_Channel` → `class EmailChannel`
- `class PRM_Slack_Channel` → `class SlackChannel`

For EmailChannel and SlackChannel that extend PRM_Notification_Channel:
- Update `extends PRM_Notification_Channel` → `extends Channel`
(Same namespace, no use statement needed)

---

For the 5 collaboration class files, add namespace:
```php
namespace Caelis\Collaboration;
```

Rename collaboration classes:
- `class PRM_Comment_Types` → `class CommentTypes`
- `class PRM_Workspace_Members` → `class WorkspaceMembers`
- `class PRM_Mentions` → `class Mentions`
- `class PRM_Mention_Notifications` → `class MentionNotifications`
- `class PRM_Reminders` → `class Reminders`

Example for class-email-channel.php:
```php
<?php
/**
 * Email notification channel
 */

if ( ! defined( 'ABSPATH' ) ) {
    exit;
}

namespace Caelis\Notifications;

class EmailChannel extends Channel {
    // ... rest unchanged
}
```
  </action>
  <verify>Verify namespaces: `grep "namespace Caelis" includes/class-notification-channel.php includes/class-email-channel.php includes/class-slack-channel.php includes/class-comment-types.php includes/class-workspace-members.php includes/class-mentions.php includes/class-mention-notifications.php includes/class-reminders.php`</verify>
  <done>3 notification classes have Caelis\Notifications namespace, 5 collaboration classes have Caelis\Collaboration namespace, extends clauses updated for channel inheritance</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All 14 files have namespace declarations
- [ ] All class names are renamed (no PRM_ prefix)
- [ ] EmailChannel and SlackChannel use `extends Channel`
- [ ] ABSPATH checks remain before namespace
- [ ] `php -l` passes on all modified files
</verification>

<success_criteria>
- All tasks completed
- 6 Calendar classes namespaced as Caelis\Calendar\*
- 3 Notification classes namespaced as Caelis\Notifications\*
- 5 Collaboration classes namespaced as Caelis\Collaboration\*
- Notification channel inheritance chain preserved
- No PHP syntax errors
</success_criteria>

<output>
After completion, create `.planning/phases/66-psr4-autoloader/66-02-SUMMARY.md`
</output>
