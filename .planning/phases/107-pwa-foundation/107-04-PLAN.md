---
phase: 107-pwa-foundation
plan: 04
type: execute
wave: 3
depends_on: ["107-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can install Stadion to home screen on Android"
    - "User can Add to Home Screen on iOS with proper icons"
    - "App launches in standalone mode (no browser chrome)"
    - "Content displays correctly on iPhone X+ (not hidden behind notch)"
    - "App theme color matches user's configured accent color"
---

<objective>
Deploy PWA foundation to production and verify installation on iOS and Android devices.

Purpose: Confirm that all PWA foundation work is functional in production before moving to Phase 108 (Offline Support).

Output: Deployed production site with verified PWA installation on both platforms.
</objective>

<execution_context>
@/Users/joostdevalk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joostdevalk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/107-pwa-foundation/107-CONTEXT.md
@AGENTS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build and deploy to production</name>
  <files></files>
  <action>
1. Run production build:
   ```bash
   npm run build
   ```

2. Verify build output includes PWA files:
   ```bash
   ls dist/manifest.webmanifest dist/sw.js
   ```

3. Deploy to production using deploy script:
   ```bash
   bin/deploy.sh
   ```

4. Clear caches (included in deploy script, but verify):
   - SiteGround cache cleared
   - WordPress cache cleared

5. Verify deployment by checking production manifest:
   ```bash
   curl -s https://stadion.svawc.nl/wp-content/themes/stadion/dist/manifest.webmanifest | head -10
   ```
  </action>
  <verify>
    - curl returns valid JSON with "name":"Stadion"
    - curl -I returns 200 for manifest.webmanifest
  </verify>
  <done>
    Production site deployed with PWA manifest and service worker
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete PWA foundation: manifest, service worker, icons, iOS meta tags, safe area CSS, and dynamic theme color.
  </what-built>
  <how-to-verify>
## Android Testing (Chrome)

1. Open production URL in Chrome on Android device
2. Wait 30 seconds (or navigate to 2+ pages)
3. Look for "Add Stadion to Home screen" banner or menu option
4. If banner doesn't appear, tap Chrome menu (3 dots) -> "Install app" or "Add to Home screen"
5. Install the app
6. Open from home screen
7. Verify:
   - [ ] App opens in standalone mode (no browser address bar)
   - [ ] Stadion icon visible on home screen
   - [ ] App name shows as "Stadion"
   - [ ] Theme color (orange by default) shows in status bar

## iOS Testing (Safari)

1. Open production URL in Safari on iPhone
2. Tap Share button (square with arrow)
3. Scroll down and tap "Add to Home Screen"
4. Tap "Add" in top right
5. Open Stadion from home screen
6. Verify:
   - [ ] App opens without Safari browser chrome
   - [ ] Stadion icon visible on home screen
   - [ ] Status bar text is dark (readable on light background)
   - [ ] Content not hidden behind notch/Dynamic Island (on iPhone X+)

## Theme Color Test

1. In the installed app, go to Settings
2. Change accent color (e.g., to Indigo or Teal)
3. Observe the browser chrome / status bar color
4. Verify:
   - [ ] Status bar / chrome color updates to match new accent

## Offline Indicator Test (Basic)

1. With app installed, turn on Airplane Mode
2. Try to navigate within the app
3. Note behavior (will be improved in Phase 108)
4. Turn Airplane Mode off

## Results

Please report:
- Device model and OS version tested
- Any issues with installation
- Screenshots if possible
  </how-to-verify>
  <resume-signal>Type "approved" if all criteria pass, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
This plan is primarily verification - the checkpoint task contains all verification steps.
</verification>

<success_criteria>
- Production deployed with PWA assets
- Android install works (standalone mode, correct icon/name)
- iOS Add to Home Screen works (standalone mode, correct icon)
- Content visible on notched iPhones (safe area CSS working)
- Theme color updates when accent changed
- User approves verification checkpoint
</success_criteria>

<output>
After completion, create `.planning/phases/107-pwa-foundation/107-04-SUMMARY.md`
</output>
