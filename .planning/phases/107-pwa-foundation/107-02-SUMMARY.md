---
phase: 107
plan: 02
subsystem: pwa
tags: [ios, pwa, meta-tags, safe-area, viewport, css]

dependency_graph:
  requires: [107-01]
  provides: [ios-pwa-meta-tags, safe-area-css, viewport-fit-cover]
  affects: [107-03, 107-04]

tech_stack:
  added: []
  patterns:
    - iOS PWA meta tag injection via wp_head
    - CSS env() safe area utilities
    - viewport-fit=cover for edge-to-edge rendering

key_files:
  created: []
  modified:
    - index.php
    - functions.php
    - src/index.css

decisions:
  - id: status-bar-style
    choice: "default"
    reason: "Dark text on light backgrounds, per CONTEXT.md guidance"
  - id: theme-color-approach
    choice: "dual media queries"
    reason: "Light and dark mode support with (prefers-color-scheme) media queries"
  - id: safe-area-padding
    choice: "horizontal on body, vertical at component level"
    reason: "Avoid double-padding by applying top padding in Layout/header components"

metrics:
  duration: "8 minutes"
  completed: "2026-01-28"
---

# Phase 107 Plan 02: iOS PWA Meta Tags Summary

**One-liner:** iOS PWA support with apple-mobile-web-app meta tags, theme-color, and safe area CSS utilities for notch/Dynamic Island handling.

## What Was Done

### Task 1: Update viewport meta tag
- Added `viewport-fit=cover` to enable CSS `env(safe-area-inset-*)` values
- This is required for iOS to report safe area insets to CSS
- Without it, `env()` values would always be 0

### Task 2: Add PWA meta tags via wp_head
- Created `stadion_pwa_meta_tags()` function hooked to `wp_head` at priority 2
- Added iOS-specific meta tags:
  - `apple-mobile-web-app-capable` for standalone mode
  - `apple-mobile-web-app-status-bar-style: default` for dark text
  - `apple-mobile-web-app-title: Stadion`
- Added `apple-touch-icon` link (180x180px)
- Added manifest link to `dist/manifest.webmanifest`
- Added dual theme-color meta tags with light/dark mode media queries

### Task 3: Add safe area CSS
- Extended `html` min-height to include safe-area-inset-top
- Added horizontal safe area padding to `body`
- Created utility classes for flexible safe area handling:
  - `.safe-top`, `.safe-bottom`, `.safe-left`, `.safe-right`
  - `.safe-x`, `.safe-y`, `.safe-all`

## Commits

| Hash | Description |
|------|-------------|
| 9163558 | feat(107-02): add viewport-fit=cover for iOS safe area support |
| 220f398 | feat(107-02): add PWA meta tags for iOS Add to Home Screen |
| a4a84e1 | feat(107-02): add safe area CSS for iPhone notch/Dynamic Island |

## Verification Results

1. **viewport-fit=cover** - Present in index.php
2. **PWA meta tags** - stadion_pwa_meta_tags() function added with all required meta tags
3. **Safe area CSS** - 7 utility classes created, body has horizontal padding
4. **Build** - Successful, manifest.webmanifest generated
5. **Lint** - Pre-existing errors in unrelated files (not caused by this plan)

## Deviations from Plan

None - plan executed exactly as written.

## Files Modified

| File | Changes |
|------|---------|
| index.php | Added viewport-fit=cover to viewport meta tag |
| functions.php | Added stadion_pwa_meta_tags() function (28 lines) |
| src/index.css | Added safe area CSS utilities (33 lines) |

## Next Phase Readiness

**Ready for 107-03:** Install prompt UI infrastructure
- Meta tags are in place for iOS detection
- Safe area utilities available for UI components
- Theme color meta tags ready for dynamic updates

**Dependencies satisfied:**
- manifest.webmanifest generated by 107-01
- apple-touch-icon path configured (icon generation in 107-04)
