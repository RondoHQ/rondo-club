---
phase: 163-color-system-migration
plan: 02
type: execute
wave: 2
depends_on: ["163-01"]
files_modified:
  - src/hooks/useTheme.js
  - src/pages/Settings/Settings.jsx
  - src/App.jsx
  - package.json
  - package-lock.json
autonomous: true

must_haves:
  truths:
    - "useTheme hook only manages color scheme (light/dark/system) — no accent color state"
    - "Settings page has no color picker UI and no accent color selection"
    - "react-colorful package is uninstalled from node_modules and package.json"
    - "App.jsx still calls useTheme() for dark mode management"
  artifacts:
    - path: "src/hooks/useTheme.js"
      provides: "Simplified theme hook (color scheme only)"
      exports: ["useTheme", "COLOR_SCHEMES"]
    - path: "src/pages/Settings/Settings.jsx"
      provides: "Settings page without color picker"
  key_links:
    - from: "src/App.jsx"
      to: "src/hooks/useTheme.js"
      via: "useTheme() hook call"
      pattern: "useTheme\\(\\)"
    - from: "src/pages/Settings/Settings.jsx"
      to: "src/hooks/useTheme.js"
      via: "useTheme import for color scheme toggle"
      pattern: "import.*useTheme.*COLOR_SCHEMES"
---

<objective>
Simplify the useTheme hook to manage only color scheme (light/dark/system), remove the accent color picker from Settings, uninstall react-colorful, and clean up all accent color state management.

Purpose: Eliminates the React-side dynamic theming infrastructure. After Plan 01 removed accent CSS classes, this plan removes the JavaScript logic that drove the dynamic system.

Output: Simplified useTheme.js (~50 lines vs ~390), clean Settings page, react-colorful removed from dependencies.
</objective>

<execution_context>
@/Users/joostdevalk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joostdevalk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/163-color-system-migration/163-RESEARCH.md
@src/hooks/useTheme.js
@src/pages/Settings/Settings.jsx
@src/App.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Simplify useTheme hook and clean up Settings accent color UI</name>
  <files>src/hooks/useTheme.js, src/pages/Settings/Settings.jsx, src/App.jsx</files>
  <action>
**1. Rewrite src/hooks/useTheme.js:**

Replace the entire file with a simplified version that ONLY manages color scheme (light/dark/system). The new file should:

- Keep: `COLOR_SCHEMES` constant (`['light', 'dark', 'system']`)
- Keep: `getSystemColorScheme()` function
- Keep: localStorage persistence for color scheme preference (key: `theme-preferences`)
- Keep: System color scheme media query listener
- Keep: Dark mode class toggling on `document.documentElement`
- Remove: ALL accent color constants (`ACCENT_COLORS`, `ACCENT_HEX`, `ACCENT_HEX_DARK`)
- Remove: ALL color manipulation functions (`lightenHex`, `darkenHex`, `getClubHex`, `getClubHexDark`)
- Remove: `updateFavicon()` function (favicon will become static in Phase 165)
- Remove: `updateThemeColorMeta()` function (theme-color will become static in Phase 165)
- Remove: `clearClubColorVars()` and `injectClubColorVars()` functions
- Remove: `data-accent` attribute setting from `applyTheme()`
- Remove: `accentColor` from state, preferences, localStorage persistence
- Remove: `setAccentColor` callback
- Remove: Export of `ACCENT_COLORS`

The simplified `applyTheme()` should only toggle the `dark` class on `document.documentElement`.

The simplified `useTheme()` should return:
```javascript
{
  colorScheme,        // 'light' | 'dark' | 'system'
  effectiveColorScheme, // 'light' | 'dark' (resolved)
  setColorScheme,     // function
}
```

Export only: `useTheme`, `COLOR_SCHEMES`

**IMPORTANT:** During the transition between Phase 163 and Phase 165, favicon and theme-color meta tags will remain as they were at page load. This is acceptable — Phase 165 will set them to static brand values.

**2. Clean up src/pages/Settings/Settings.jsx:**

- Remove: `import { HexColorPicker, HexColorInput } from 'react-colorful';` (line 5)
- Update: `import { useTheme, COLOR_SCHEMES } from '@/hooks/useTheme';` — remove `ACCENT_COLORS` from import
- Update: Destructure from useTheme — remove `accentColor` and `setAccentColor`:
  `const { colorScheme, setColorScheme, effectiveColorScheme } = useTheme();`
- Remove: `clubColor` state and `originalClubColor` state (lines 718-719)
- Remove: The entire club color preview/save logic block (the useEffect that handles club color preview and the handleSaveClubColor function)
- Remove: `accentColorClasses` object (line 850 area)
- Remove: The entire "Accentkleur" section in the Appearance tab (the accent color picker grid and club color editor). This is the section that maps ACCENT_COLORS and shows the HexColorPicker.
- Keep: The "Kleurenschema" (color scheme) toggle section (light/dark/system buttons)
- Remove: Any references to `config.accentColor` or `window.rondoConfig.accentColor`

**3. Verify src/App.jsx:**

`src/App.jsx` calls `useTheme()` at the top of the App component (line 34). This should continue to work since useTheme still exports a function. The call `useTheme()` initializes dark mode — no changes needed if it only uses the hook without destructuring accent properties.

Check if App.jsx references `accentColor` — from the grep results it only has `useTheme()` and `import { useTheme }`. No changes needed.
  </action>
  <verify>
Run: `cd /Users/joostdevalk/Code/rondo/rondo-club && grep -c "accentColor\|ACCENT_COLORS\|setAccentColor\|accent_color\|react-colorful\|HexColor" src/hooks/useTheme.js src/pages/Settings/Settings.jsx src/App.jsx` — all files must return 0.
Run: `cd /Users/joostdevalk/Code/rondo/rondo-club && grep "export.*useTheme\|export.*COLOR_SCHEMES" src/hooks/useTheme.js` — must show both exports.
Run: `cd /Users/joostdevalk/Code/rondo/rondo-club && node -e "import('./src/hooks/useTheme.js')" 2>&1 || echo "Syntax check via build below"`
Run: `cd /Users/joostdevalk/Code/rondo/rondo-club && npm run build` — must succeed.
  </verify>
  <done>useTheme.js simplified to ~50 lines managing only color scheme. Settings page has no accent color picker, no HexColorPicker. App.jsx continues to initialize dark mode via useTheme().</done>
</task>

<task type="auto">
  <name>Task 2: Uninstall react-colorful dependency</name>
  <files>package.json, package-lock.json</files>
  <action>
Run `npm uninstall react-colorful` from the project root.

This removes:
- `react-colorful` from `package.json` dependencies
- `react-colorful` from `package-lock.json`
- `react-colorful` from `node_modules/`

After uninstalling, run `npm run build` to verify the build succeeds without the dependency. The build should be smaller since react-colorful's color picker components are no longer bundled.

Also verify no other files import from react-colorful:
`grep -rn "react-colorful" src/` — should return zero results (the import was removed in Task 1).
  </action>
  <verify>
Run: `cd /Users/joostdevalk/Code/rondo/rondo-club && grep "react-colorful" package.json` — must return nothing.
Run: `cd /Users/joostdevalk/Code/rondo/rondo-club && grep -rn "react-colorful" src/` — must return nothing.
Run: `cd /Users/joostdevalk/Code/rondo/rondo-club && npm run build` — must succeed.
  </verify>
  <done>react-colorful uninstalled. No imports remain. Build succeeds without the dependency.</done>
</task>

</tasks>

<verification>
1. `grep -c "accentColor\|ACCENT_COLORS\|setAccentColor" src/hooks/useTheme.js` returns 0
2. `grep -c "react-colorful\|HexColorPicker" src/pages/Settings/Settings.jsx` returns 0
3. `grep "react-colorful" package.json` returns nothing
4. useTheme.js exports only `useTheme` and `COLOR_SCHEMES`
5. `npm run build` succeeds
6. Settings page retains color scheme toggle (light/dark/system)
</verification>

<success_criteria>
- useTheme.js reduced from ~390 lines to ~60 lines, managing only color scheme
- Settings page Appearance tab shows only color scheme toggle, no accent color picker
- react-colorful removed from dependencies
- Dark mode toggle continues to work via useTheme hook
- Build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/163-color-system-migration/163-02-SUMMARY.md`
</output>
