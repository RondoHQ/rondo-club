---
phase: 172-data-anonymization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - includes/class-demo-anonymizer.php
  - functions.php
autonomous: true

must_haves:
  truths:
    - "Generator produces Dutch first names with gender awareness"
    - "Generator produces Dutch infixes (tussenvoegsel) with realistic distribution"
    - "Generator produces Dutch last names"
    - "Generator produces fake Dutch phone numbers in valid format"
    - "Generator produces fake Dutch addresses (street, postal code, city)"
    - "Generator produces fake email addresses derived from the fake name"
    - "Generator produces consistent data per person ref (same ref = same fake identity)"
  artifacts:
    - path: "includes/class-demo-anonymizer.php"
      provides: "Dutch fake data generator class"
      contains: "class DemoAnonymizer"
    - path: "functions.php"
      provides: "Class alias registration"
      contains: "RONDO_Demo_Anonymizer"
  key_links:
    - from: "includes/class-demo-anonymizer.php"
      to: "includes/class-demo-export.php"
      via: "Will be consumed by export in plan 02"
      pattern: "DemoAnonymizer"
---

<objective>
Create a Dutch fake data generator class that produces realistic anonymized PII for the demo fixture export.

Purpose: The anonymizer must generate consistent, realistic Dutch fake data so that exported demo fixtures look authentic but contain zero real personal information. Consistency means the same person ref always gets the same fake identity within an export run.

Output: `DemoAnonymizer` class with methods for generating fake Dutch names, addresses, phone numbers, and email addresses.
</objective>

<execution_context>
@/Users/joostdevalk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joostdevalk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/171-export-command-foundation/171-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DemoAnonymizer class with Dutch fake data generators</name>
  <files>includes/class-demo-anonymizer.php</files>
  <action>
Create a new PHP class `Rondo\Demo\DemoAnonymizer` in `includes/class-demo-anonymizer.php`.

**Class design:**
- Namespace: `Rondo\Demo`
- Constructor accepts a seed (integer) for reproducible randomization. Default seed: 42.
- Maintains an internal identity cache: `$identities = []` keyed by person `_ref` string.
- When generating data for a person ref, check cache first. If cached, return cached identity. This ensures consistency across multiple calls for the same person.

**Data arrays (hardcode as private static arrays):**

1. **Dutch first names** — Two arrays:
   - `$male_first_names`: At least 80 common Dutch male first names (Jan, Pieter, Willem, Daan, Sem, Lucas, Levi, Finn, Luuk, Milan, Bram, Lars, Jesse, Thomas, Tim, Stijn, Ruben, Thijs, Max, Sven, Niels, Joost, Jeroen, Mark, Erik, Peter, Kees, Henk, Bert, Rob, Martijn, Wouter, Jasper, Bas, Rick, Dennis, Stefan, Marcel, Arjan, Gerrit, Dirk, Frank, Hans, Michiel, Sander, Kevin, Jelle, Dave, Floris, Hugo, Maarten, Gijs, Casper, Timo, Niek, Bart, Freek, Wim, Anton, Paul, Jaap, Simon, David, Tom, Rens, Job, Sam, Arie, Cor, Piet, Frits, Guus, Johan, Marco, Raymond, Patrick, Vincent, Edwin, Gerard, Ben)
   - `$female_first_names`: At least 80 common Dutch female first names (Anna, Emma, Sophie, Julia, Sara, Eva, Lisa, Noa, Lotte, Fleur, Iris, Isa, Sanne, Femke, Mila, Eline, Roos, Vera, Lynn, Hanna, Linda, Monique, Sandra, Annemiek, Ingrid, Petra, Marieke, Esther, Ellen, Nicole, Miranda, Wendy, Birgit, Marloes, Anke, Anouk, Demi, Tess, Fenna, Nina, Maud, Amy, Yara, Lieke, Britt, Kim, Denise, Manon, Chantal, Diana, Ilse, Rianne, Wilma, Joke, Marian, Anja, Claudia, Astrid, Tineke, Greetje, Liesbeth, Hanneke, Janneke, Marjolein, Corina, Renate, Suzanne, Judith, Joyce, Silvia, Miriam, Simone, Pauline, Nienke, Elise, Merel, Renee, Daphne, Elisa, Amber)

2. **Dutch infixes (tussenvoegsel)** — with distribution weights:
   - ~40% chance of having an infix
   - Options with weights: "van" (30%), "de" (20%), "van de" (15%), "van der" (15%), "den" (5%), "van den" (10%), "ter" (3%), "te" (2%)

3. **Dutch last names** — At least 100 common Dutch last names (Jansen, De Vries, Van den Berg, Van Dijk, Bakker, Janssen, Visser, Smit, Meijer, De Boer, Mulder, De Groot, Bos, Vos, Peters, Hendriks, Van Leeuwen, Dekker, Brouwer, De Wit, Dijkstra, Smeets, De Graaf, Van der Meer, Van der Linden, Willems, De Jong, Maas, Vermeer, Van der Heijden, Scholten, Van der Veen, Post, Kuijpers, Jacobs, Van den Heuvel, Van der Wal, Hoekstra, Hermans, Bosman, Wolters, Sanders, De Bruin, Kok, Gerritsen, Van Wijk, Schouten, Van Beek, De Haan, Timmermans, Groen, Peeters, Koster, Blom, Beumer, Van Dam, Van der Berg, Schipper, Klein, Huisman, Jonker, Van Loon, Van Es, Prins, Van Vliet, Verhoeven, Van der Pol, Boom, Van der Steen, Hofman, Admiraal, Van Veen, Kuiper, Evers, Van der Horst, Koopman, Van Houten, Berends, Molenaar, Vink, De Ruiter, Van Schaik, Aarts, Van der Zanden, Reijnen, Driessen, Renssen, De Ridder, Claessen, Martens, Van Gelderen, Vonk, Rutten, Van der Poel, Willems, Boogaard, Tol, Van Rijn, Akkerman, Simons, Verhagen, Holterman)
   NOTE: Last names should NOT include "de"/"van"/"van der" prefixes since those come from the infix field.

4. **Dutch streets** — At least 50 Dutch street names (Kerkstraat, Dorpsstraat, Schoolstraat, Molenweg, Stationsweg, Hoofdstraat, Kastanjelaan, Lindenlaan, Berkenlaan, Eikenlaan, Beukenlaan, Populierenlaan, Wilgenlaan, Rozenlaan, Tulpenlaan, Julianastraat, Beatrixlaan, Wilhelminastraat, Oranjestraat, Nassaulaan, Marktplein, Raadhuisstraat, Kloosterstraat, Brinkstraat, Grotestraat, Nieuwstraat, Langestraat, Kortestraat, Hoogstraat, Achterstraat, Voorstraat, Torenstraat, Havenstraat, Dijkstraat, Kanaalweg, Lageweg, Hogeweg, Veldweg, Bosweg, Heideweg, Duinweg, Polderweg, Rivierweg, Parkstraat, Sportlaan, Industrieweg, Ambachtstraat, Handelsweg, Burgemeester Jansenlaan, Professor de Vriesstraat)

5. **Dutch cities** — At least 60 Dutch cities (Amsterdam, Rotterdam, Den Haag, Utrecht, Eindhoven, Groningen, Tilburg, Almere, Breda, Nijmegen, Apeldoorn, Haarlem, Arnhem, Zaanstad, Amersfoort, Haarlemmermeer, Den Bosch, Zoetermeer, Zwolle, Leiden, Maastricht, Dordrecht, Ede, Leeuwarden, Alphen aan den Rijn, Emmen, Westland, Delft, Deventer, Helmond, Hilversum, Oss, Sittard, Schiedam, Amstelveen, Gouda, Spijkenisse, Veenendaal, Zeist, Hardenberg, Assen, Purmerend, Roosendaal, Vlaardingen, Hoorn, Bergen op Zoom, Katwijk, Wageningen, Baarn, Bussum, Doetinchem, Middelburg, Goes, Kampen, Meppel, Steenwijk, Waalwijk, Weert, Venlo, Heerlen)

6. **Dutch postal code ranges** — Generate random 4-digit + 2 uppercase letters: range 1000-9999 + AA-ZZ

**Methods:**

`generate_identity( string $ref, string $gender = null ): array`
- Returns associative array with keys: first_name, infix, last_name, email, phone, address
- If gender is 'male' or 'female', pick from corresponding name list. Otherwise randomly pick gender.
- Cache result keyed by $ref.
- Uses seeded random to select from arrays.

`generate_first_name( string $gender ): string`
- Pick from male or female array based on gender parameter.

`generate_infix(): string|null`
- 40% chance returns an infix, 60% returns null.
- When returning infix, use weighted selection among options.

`generate_last_name(): string`
- Pick random last name from array.

`generate_phone(): string`
- Generate Dutch mobile: "06-" + 8 random digits formatted as "06-XXXXXXXX"
- Roughly 30% chance of landline: "0XX-XXXXXXX" (area codes 010-088 range)

`generate_email( string $first_name, string $infix, string $last_name ): string`
- Derive from the fake name: lowercase, strip diacritics.
- Format options (randomly selected): "first.last@example.com", "f.last@example.com", "first.last@rondo-demo.nl", "flast@example.com"
- Use domains: example.com, rondo-demo.nl, voorbeeld.nl (to make it obviously fake)

`generate_address(): array`
- Returns: ['street' => '...', 'house_number' => '...', 'postal_code' => '...', 'city' => '...']
- Street: random from array + random house number (1-250)
- Postal code: 4 random digits (1000-9999) + space + 2 uppercase letters
- City: random from array

`generate_relatiecode(): string`
- Generate a fake 7-digit relatiecode (Sportlink member number) as a string.

**Important implementation detail:**
- Use PHP `mt_srand()` with the seed in the constructor for reproducibility.
- Use `mt_rand()` for all random selections.
- The seeded RNG ensures the same export run always produces the same fake data.

Do NOT add any WordPress-specific functionality here. This is a pure data generator class with no WP dependencies.
  </action>
  <verify>
Run `php -l includes/class-demo-anonymizer.php` to check for syntax errors. The class should be a valid PHP file with no parse errors.
  </verify>
  <done>
A DemoAnonymizer class exists at includes/class-demo-anonymizer.php with all specified methods and hardcoded Dutch data arrays. The class is pure PHP with no WordPress dependencies and uses seeded randomization for reproducibility.
  </done>
</task>

<task type="auto">
  <name>Task 2: Register DemoAnonymizer class alias in functions.php</name>
  <files>functions.php</files>
  <action>
Add the class alias for backward compatibility, following the pattern used by DemoExport:

1. Add `use Rondo\Demo\DemoAnonymizer;` import near the existing `use Rondo\Demo\DemoExport;` line.
2. Add the class alias: `class_alias( DemoAnonymizer::class, 'RONDO_Demo_Anonymizer' );` near the existing DemoExport alias.

Follow the exact pattern already used in functions.php for other class aliases.
  </action>
  <verify>
Run `grep -n "DemoAnonymizer" functions.php` to confirm both the use statement and class_alias are present.
  </verify>
  <done>
The DemoAnonymizer class is registered in functions.php with a use statement and backward-compatible class alias, matching the existing pattern.
  </done>
</task>

</tasks>

<verification>
1. `php -l includes/class-demo-anonymizer.php` returns "No syntax errors"
2. `grep "class DemoAnonymizer" includes/class-demo-anonymizer.php` finds the class declaration
3. `grep "DemoAnonymizer" functions.php` shows both the use statement and class_alias
4. The class contains all required methods: generate_identity, generate_first_name, generate_infix, generate_last_name, generate_phone, generate_email, generate_address, generate_relatiecode
5. The class contains hardcoded Dutch data arrays for first names (male/female), last names, streets, cities
</verification>

<success_criteria>
A standalone Dutch fake data generator class exists that can produce realistic Dutch names, addresses, phone numbers, and email addresses with seeded reproducibility and per-ref caching. The class is registered in functions.php following existing patterns.
</success_criteria>

<output>
After completion, create `.planning/phases/172-data-anonymization/172-01-SUMMARY.md`
</output>
