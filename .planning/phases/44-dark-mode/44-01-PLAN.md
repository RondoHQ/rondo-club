---
phase: 44-dark-mode
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/index.css
  - src/components/layout/Layout.jsx
  - src/pages/Settings/Settings.jsx
  - src/App.jsx
autonomous: true
---

<objective>
Dark mode foundation: CSS base styles, Layout component, and Settings Appearance UI with color scheme toggle.

Purpose: Establish the dark mode foundation so toggling dark class produces visible changes across the app, and provide users with a settings UI to control their color scheme preference.
Output: Working dark mode toggle in Settings > Appearance, foundation styles for Layout and base components.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/43-infrastructure/43-01-SUMMARY.md

# Phase 43 established:
# - CSS custom properties for accent colors in src/index.css
# - Tailwind darkMode: 'class' enabled
# - useTheme hook with colorScheme/accentColor state + localStorage
# - REST API endpoints for theme persistence

# Existing patterns from codebase:
@src/index.css
@src/hooks/useTheme.js
@tailwind.config.js
@src/components/layout/Layout.jsx
@src/pages/Settings/Settings.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add dark mode variants to CSS base layer</name>
  <files>src/index.css</files>
  <action>
Update the @layer base and @layer components sections in src/index.css with dark mode variants:

1. In @layer base, update body:
   - Add: dark:bg-gray-900 dark:text-gray-100

2. In @layer components, update each class:
   - .btn-primary: Add dark:bg-primary-500 dark:hover:bg-primary-400 (already good contrast)
   - .btn-secondary: Add dark:bg-gray-800 dark:text-gray-200 dark:border-gray-600 dark:hover:bg-gray-700
   - .btn-danger: Already uses red, just ensure contrast (dark:bg-red-500 dark:hover:bg-red-400)
   - .input: Add dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100 dark:focus:ring-accent-500 dark:focus:border-accent-500
   - .label: Add dark:text-gray-300
   - .card: Add dark:bg-gray-800 dark:border-gray-700

3. Update .timeline-content styles for dark mode:
   - Links: Add dark:text-accent-400 dark:hover:text-accent-300

Use Tailwind dark: prefix syntax. Keep original light mode classes intact - just append dark variants.
  </action>
  <verify>npm run build succeeds; CSS output contains dark: prefixed classes</verify>
  <done>All component classes in index.css have dark: variants</done>
</task>

<task type="auto">
  <name>Task 2: Add dark mode to Layout component</name>
  <files>src/components/layout/Layout.jsx</files>
  <action>
Add dark: variants to the Layout component for sidebar, header, and main content area.

Key patterns to add throughout the file:
- bg-white → add dark:bg-gray-800
- bg-gray-50 → add dark:bg-gray-900
- bg-gray-100 → add dark:bg-gray-700
- border-gray-200 → add dark:border-gray-700
- border-gray-300 → add dark:border-gray-600
- text-gray-900 → add dark:text-gray-50
- text-gray-700 → add dark:text-gray-200
- text-gray-600 → add dark:text-gray-300
- text-gray-500 → add dark:text-gray-400
- text-gray-400 → add dark:text-gray-500
- hover:bg-gray-50 → add dark:hover:bg-gray-700
- hover:bg-gray-100 → add dark:hover:bg-gray-600
- divide-gray-100 → add dark:divide-gray-700
- divide-gray-200 → add dark:divide-gray-700

Focus areas:
1. Sidebar background and borders
2. Navigation items (active states, hover states)
3. Header/search area
4. Main content area background
5. Footer area
6. Dropdown menus and popovers
7. Mobile menu overlay

Preserve all existing classes - only add dark: variants.
  </action>
  <verify>npm run build succeeds; toggle dark class on html element and Layout shows dark colors</verify>
  <done>Layout component displays correctly in both light and dark modes</done>
</task>

<task type="auto">
  <name>Task 3: Create Settings Appearance section with color scheme toggle</name>
  <files>src/pages/Settings/Settings.jsx, src/App.jsx</files>
  <action>
Add an Appearance section to the Settings page with color scheme toggle.

1. In Settings.jsx:
   a. Import useTheme hook: import { useTheme, COLOR_SCHEMES } from '../../hooks/useTheme';
   b. Add useTheme() call in component to get colorScheme, setColorScheme, effectiveColorScheme
   c. Create new Appearance section in the settings (add as first section, before existing sections)
   d. Add segmented control/radio group for Light/Dark/System options:
      - Style: 3 buttons in a row with selected state highlighted
      - Selected button: bg-accent-500 text-white (or accent-600)
      - Unselected buttons: bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300
      - Use icons: Sun for Light, Moon for Dark, Monitor for System (from lucide-react)
      - On click: call setColorScheme(value)
   e. Show current effective mode below: "Currently using {effectiveColorScheme} mode"
   f. Add dark: variants to any new elements

2. Settings.jsx dark mode:
   Also add dark: variants to existing Settings page elements while you're there (same patterns as Task 2).

3. App.jsx:
   Import and call useTheme() at the App level to ensure theme is applied on app mount.
   Place useTheme() call in App component near the top, before the return statement.
   This ensures theme classes are applied before any content renders.
  </action>
  <verify>npm run dev; navigate to /settings; color scheme toggle visible and functional; switching modes applies dark class to html element</verify>
  <done>Settings > Appearance section shows color scheme toggle (Light/Dark/System); toggling changes effectiveColorScheme and applies dark class to html; useTheme called in App.jsx</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Dark mode toggle appears in Settings page
- [ ] Switching to Dark applies `class="dark"` to html element
- [ ] Switching to Light removes dark class
- [ ] System follows OS preference
- [ ] Layout component renders correctly in dark mode (sidebar, header, main area)
- [ ] Base component classes (.card, .btn-secondary, .input) show dark styles
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Foundation established: toggling dark mode shows visible changes in Layout and base components
- Settings UI allows user control over color scheme preference
  </success_criteria>

<output>
After completion, create `.planning/phases/44-dark-mode/44-01-SUMMARY.md`
</output>
