---
phase: 46-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/index.css
  - src/pages/Settings/Labels.jsx
  - src/pages/Settings/RelationshipTypes.jsx
  - src/pages/Settings/UserApproval.jsx
  - src/pages/Workspaces/WorkspacesList.jsx
  - src/components/VisibilitySelector.jsx
autonomous: false
---

<objective>
Add smooth theme transitions respecting prefers-reduced-motion and migrate remaining hardcoded primary-* color classes to accent-* for complete theme customization support.

Purpose: Complete the v3.8 Theme Customization milestone with polish and edge case fixes.
Output: Smooth, accessible theme transitions and 100% accent color coverage across all components.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/43-infrastructure/43-01-SUMMARY.md
@.planning/phases/45-accent-colors/45-04-SUMMARY.md
@Multi-Color.md

# Phase 45 established accent color patterns:
# - Interactive elements: accent-500/600/700
# - Focus rings: focus:ring-accent-500
# - Selection states: bg-accent-50 dark:bg-accent-900/30 with text-accent-600
# - Loading spinners: border-accent-600 dark:border-accent-400

@src/index.css
@tailwind.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add smooth theme transitions with prefers-reduced-motion support</name>
  <files>src/index.css</files>
  <action>
Add CSS transitions for theme changes at the base layer:

1. In the `@layer base` section after the body styles, add transition properties for smooth color changes:
   - Add `transition-property: background-color, border-color, color;`
   - Add `transition-duration: 150ms;`
   - Add `transition-timing-function: ease-in-out;`
   - Apply to `html` and `*` selector (or targeted elements like body, .card, .btn)

2. Add a `@media (prefers-reduced-motion: reduce)` block that sets all transitions to `none` to respect user accessibility preferences.

3. Apply transitions specifically to theme-affected elements:
   - body (background, text)
   - .card (background, border)
   - .btn (background, color, border)
   - .input (background, border)

Keep transitions fast (150ms) to feel snappy while providing visual continuity.

Example structure:
```css
@layer base {
  /* Existing styles... */

  /* Theme transition support */
  body,
  .card,
  .btn,
  .input {
    transition-property: background-color, border-color, color;
    transition-duration: 150ms;
    transition-timing-function: ease-in-out;
  }

  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      transition-duration: 0ms !important;
      animation-duration: 0ms !important;
    }
  }
}
```
  </action>
  <verify>
1. npm run build succeeds
2. Inspect dist/assets/*.css and confirm transition-property rules are present
3. Confirm @media (prefers-reduced-motion) block is present in compiled CSS
  </verify>
  <done>Theme transitions are smooth by default, instant when user prefers reduced motion</done>
</task>

<task type="auto">
  <name>Task 2: Migrate remaining primary-* classes to accent-*</name>
  <files>src/pages/Settings/Labels.jsx, src/pages/Settings/RelationshipTypes.jsx, src/pages/Settings/UserApproval.jsx, src/pages/Workspaces/WorkspacesList.jsx, src/components/VisibilitySelector.jsx</files>
  <action>
Replace all remaining `primary-*` color classes with `accent-*` equivalents. These were missed during Phase 45.

Files and specific replacements:

**src/pages/Settings/Labels.jsx** (3 instances):
- Line 190: `border-primary-500 text-primary-600 dark:text-primary-400` → `border-accent-500 text-accent-600 dark:text-accent-400`
- Line 246: `border-primary-600 dark:border-primary-400` → `border-accent-600 dark:border-accent-400`
- Line 308: `hover:text-primary-600 dark:hover:text-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/30` → `hover:text-accent-600 dark:hover:text-accent-400 hover:bg-accent-50 dark:hover:bg-accent-900/30`

**src/pages/Settings/RelationshipTypes.jsx** (4 instances):
- Line 121: `bg-primary-50 dark:bg-primary-900/30` → `bg-accent-50 dark:bg-accent-900/30`
- Line 132: `bg-primary-50 dark:bg-primary-900/30` → `bg-accent-50 dark:bg-accent-900/30`
- Line 333: `border-primary-600 dark:border-primary-400` → `border-accent-600 dark:border-accent-400`
- Line 499: `hover:text-primary-600 dark:hover:text-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/30` → `hover:text-accent-600 dark:hover:text-accent-400 hover:bg-accent-50 dark:hover:bg-accent-900/30`

**src/pages/Settings/UserApproval.jsx** (1 instance):
- Line 81: `text-primary-600 dark:text-primary-400` → `text-accent-600 dark:text-accent-400`

**src/pages/Workspaces/WorkspacesList.jsx** (1 instance):
- Line 84: `border-primary-600 dark:border-primary-400` → `border-accent-600 dark:border-accent-400`

**src/components/VisibilitySelector.jsx** (1 instance):
- Line 141: `hover:bg-primary-50 dark:hover:bg-primary-900/30` → `hover:bg-accent-50 dark:hover:bg-accent-900/30`

Use find-and-replace within each file. Do NOT change orange-* classes (those are semantic for awaiting status).
  </action>
  <verify>
1. grep -r "primary-[0-9]" src/ returns 0 results
2. npm run build succeeds
3. npm run lint passes
  </verify>
  <done>All interactive color classes use accent-* instead of primary-*, theme changes affect all elements consistently</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete theme customization system with smooth transitions and full accent color coverage across all components</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:5173/settings?tab=appearance
    3. Test Color Scheme Toggle:
       - Switch between Light, Dark, System
       - Confirm transitions are smooth (not instant jumps)
       - Confirm all UI elements update together
    4. Test Accent Colors:
       - Click each of the 8 accent color swatches
       - For each color, verify:
         - Primary buttons change color
         - Links change color
         - Selected tabs/states change color
         - Loading spinners change color
         - Focus rings change color when tabbing
    5. Test Reduced Motion:
       - In browser DevTools, set "Emulate CSS media feature prefers-reduced-motion" to "reduce"
       - Switch themes again - changes should be instant (no transitions)
    6. Test Edge Cases:
       - Visit /settings?tab=labels and confirm edit button hover uses accent color
       - Visit /settings?tab=relationship-types and confirm selected state uses accent color
       - Visit /workspaces and trigger loading state (refresh) - spinner should use accent color
    7. Test Each Theme Combination (sample 4 of 24):
       - Light + Orange (default)
       - Dark + Teal
       - System + Violet
       - Dark + Rose
       - Confirm no visual issues in any combination
  </how-to-verify>
  <resume-signal>Type "approved" if all theme combinations work correctly, or describe any visual issues found</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without errors
- [ ] npm run lint passes with no warnings
- [ ] grep -r "primary-[0-9]" src/ returns 0 results
- [ ] Theme transitions are smooth (150ms)
- [ ] prefers-reduced-motion disables transitions
- [ ] All accent colors display correctly
- [ ] Human verification of theme combinations passed
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Theme transitions are smooth and respect accessibility preferences
- All components respond to accent color changes
- No hardcoded primary-* classes remain in src/
- Human verification passed for representative theme combinations
</success_criteria>

<output>
After completion, create `.planning/phases/46-polish/46-01-SUMMARY.md`
</output>
