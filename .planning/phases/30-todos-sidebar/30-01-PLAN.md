---
phase: 30-todos-sidebar
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/pages/People/PersonDetail.jsx]
autonomous: true
---

<objective>
Create a persistent todos sidebar in PersonDetail that displays across all tabs.

Purpose: Provide instant visibility of todos regardless of which tab is active, improving task tracking while viewing person details.
Output: PersonDetail with sidebar layout showing todos persistently on the right side.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-header-enhancement/29-01-SUMMARY.md

@src/pages/People/PersonDetail.jsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create sidebar layout structure</name>
  <files>src/pages/People/PersonDetail.jsx</files>
  <action>
Modify the PersonDetail page layout to use a two-column flex layout after the header and tabs:

1. Wrap the tab content area (`<div className="space-y-6">`) and a new sidebar in a flex container:
```jsx
<div className="flex gap-6">
  {/* Main content - existing tab content */}
  <div className="flex-1 min-w-0">
    {/* Profile Tab */}
    {/* Timeline Tab */}
    {/* Work Tab */}
  </div>

  {/* Todos Sidebar - always visible */}
  <aside className="w-80 flex-shrink-0 hidden lg:block">
    {/* Todos content moved here */}
  </aside>
</div>
```

2. The sidebar should be:
   - Fixed width (w-80 = 320px)
   - Hidden on smaller screens (hidden lg:block)
   - Non-shrinking (flex-shrink-0)

3. Main content should be:
   - Flexible (flex-1)
   - min-w-0 to prevent overflow issues with columns layout
  </action>
  <verify>npm run build succeeds, page renders with two-column layout on large screens</verify>
  <done>Flex container wraps tab content and sidebar placeholder, sidebar visible on lg+ screens</done>
</task>

<task type="auto">
  <name>Task 2: Move todos to persistent sidebar</name>
  <files>src/pages/People/PersonDetail.jsx</files>
  <action>
Move the todos display from the Timeline tab to the new sidebar:

1. Cut the entire todos card from Timeline tab (lines ~1853-1943):
```jsx
{/* Todos */}
<div className="card p-6 break-inside-avoid mb-6">
  ...
</div>
```

2. Paste it into the sidebar `<aside>` element, adjusting styling:
   - Remove `break-inside-avoid mb-6` (not needed in sidebar)
   - Keep `card p-6` for consistent styling
   - The sidebar should use `sticky top-6` to stay visible while scrolling

3. Sidebar structure:
```jsx
<aside className="w-80 flex-shrink-0 hidden lg:block">
  <div className="sticky top-6">
    <div className="card p-6">
      <div className="flex items-center justify-between mb-3">
        <h2 className="font-semibold">Todos</h2>
        <button onClick={() => { setEditingTodo(null); setShowTodoModal(true); }} className="btn-secondary text-sm" title="Add todo">
          <Plus className="w-4 h-4" />
        </button>
      </div>
      {/* Existing todos list JSX */}
    </div>
  </div>
</aside>
```

4. The todos section should no longer appear in the Timeline tab - remove it entirely from there.
  </action>
  <verify>npm run lint passes, todos appear in sidebar on all tabs, Timeline tab no longer shows todos card</verify>
  <done>Todos display in persistent sidebar, visible across Profile/Timeline/Work tabs, Timeline tab has only Timeline card</done>
</task>

<task type="auto">
  <name>Task 3: Add open todos count badge to sidebar header</name>
  <files>src/pages/People/PersonDetail.jsx</files>
  <action>
Add a badge showing count of open (non-completed) todos:

1. Calculate open todo count (add near existing sortedTodos useMemo):
```jsx
const openTodosCount = useMemo(() => {
  return sortedTodos.filter(todo => todo.status !== 'completed').length;
}, [sortedTodos]);
```

2. Update the sidebar header to show the count:
```jsx
<div className="flex items-center justify-between mb-3">
  <div className="flex items-center gap-2">
    <h2 className="font-semibold">Todos</h2>
    {openTodosCount > 0 && (
      <span className="bg-primary-100 text-primary-700 text-xs font-medium px-2 py-0.5 rounded-full">
        {openTodosCount}
      </span>
    )}
  </div>
  <button ...>
    <Plus className="w-4 h-4" />
  </button>
</div>
```

The badge should:
- Only appear when there are open todos
- Use primary color scheme (bg-primary-100, text-primary-700)
- Be small and rounded (text-xs, rounded-full)
  </action>
  <verify>npm run build succeeds, badge appears with correct count, disappears when all todos completed</verify>
  <done>Open todos count badge displays next to "Todos" header, updates reactively</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes with no warnings
- [ ] On large screens (lg+): sidebar visible on all three tabs (Profile, Timeline, Work)
- [ ] On medium/small screens: sidebar hidden, page displays normally
- [ ] Todos CRUD operations still work (create, edit, toggle status, delete)
- [ ] Todo modals still open and close correctly
- [ ] Open todos count badge appears when there are open todos
- [ ] Sticky behavior works - sidebar stays visible while scrolling main content
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Todos sidebar visible across all PersonDetail tabs on large screens
- Sidebar hidden gracefully on smaller screens
- Open todos count badge functional
</success_criteria>

<output>
After completion, create `.planning/phases/30-todos-sidebar/30-01-SUMMARY.md`
</output>
