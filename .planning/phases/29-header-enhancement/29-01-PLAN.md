# Plan 29-01: Add Role/Job Display to Person Header

## Objective

Display the person's current position (job title and team) prominently in the header section of PersonDetail, providing immediate context about who the person is professionally.

## Current State

The PersonDetail header (`src/pages/People/PersonDetail.jsx` lines 1290-1320) displays:
- Person name (with deceased indicator if applicable)
- Favorite star
- Nickname (if set)
- Gender symbol, pronouns, age
- Labels

Work history exists in `person.acf.work_history` as a repeater field with:
- `team` (post object ID)
- `job_title` (text)
- `is_current` (boolean)
- `start_date`, `end_date` (dates)

Team data is already fetched via `teamQueries` and available in `teamMap` (lines 1053-1065).

## Design

### Layout

Add current position info below the name, before nickname/demographics:

```
[Photo]  John Doe ★
         CEO at Acme Corp
         "Johnny" — ♂ — he/him — 42 years old
         [Labels]
```

If multiple current positions exist, show all (comma-separated or stacked):

```
         CEO at Acme Corp, Advisor at StartupX
```

If no current position exists, don't show anything in that line.

### Styling

- Job title in normal weight
- "at" separator in gray
- Team name as a clickable link to the team page
- Text size: `text-base` (smaller than name)
- Color: `text-gray-600` for the overall line

---

## Tasks

### Task 1: Extract Current Position(s)

Create a `useMemo` to filter current jobs from `sortedWorkHistory`:

```javascript
const currentPositions = useMemo(() => {
  if (!sortedWorkHistory?.length) return [];
  return sortedWorkHistory.filter(job => job.is_current);
}, [sortedWorkHistory]);
```

### Task 2: Add Position Display to Header

After the name/favorite row (line ~1299) and before nickname, add:

```jsx
{currentPositions.length > 0 && (
  <p className="text-base text-gray-600">
    {currentPositions.map((job, idx) => (
      <span key={idx}>
        {idx > 0 && ', '}
        {job.job_title}
        {job.team && teamMap[job.team] && (
          <>
            <span className="text-gray-400"> at </span>
            <Link
              to={`/teams/${job.team}`}
              className="text-primary-600 hover:text-primary-700 hover:underline"
            >
              {teamMap[job.team].name}
            </Link>
          </>
        )}
        {job.job_title && !job.team && job.team_name_text && (
          // Fallback for jobs with team name but no linked team
          <>
            <span className="text-gray-400"> at </span>
            <span>{job.team_name_text}</span>
          </>
        )}
      </span>
    ))}
  </p>
)}
```

### Task 3: Handle Edge Cases

1. **Job title only** (no team linked): Show just the title
2. **Team only** (no job title): Show "Works at [Team]"
3. **Neither**: Skip that position in display
4. **Multiple current positions**: Show all, comma-separated
5. **No current positions**: Don't render anything

---

## Files to Modify

- `src/pages/People/PersonDetail.jsx` — Add useMemo and JSX for current position display

## Verification

1. `npm run build` — no errors
2. `npm run lint` — passes
3. Manual test cases:
   - Person with one current job (title + team)
   - Person with multiple current jobs
   - Person with job title only (no team linked)
   - Person with no current positions
   - Team link navigates correctly

---

## Notes

- Uses existing `teamMap` populated by `teamQueries` — no additional API calls needed
- Respects existing data model; no backend changes required
- Simple, focused change to header area only
