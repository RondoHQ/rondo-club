# Milestone v2.5: Performance

**Status:** âœ… SHIPPED 2026-01-13
**Phases:** 20
**Total Plans:** 3

## Overview

Reduce bundle size from 1.6MB to under 500KB through code splitting, vendor chunking, and lazy loading of heavy libraries.

**Result:** Initial load reduced from 1,646 KB to 435 KB (73% reduction)

## Phases

### Phase 20: Bundle Optimization

**Goal**: Implement vendor chunking and route-based lazy loading to reduce bundle size
**Depends on**: v2.4 Bug Fixes complete
**Plans**: 3 plans

Plans:
- [x] 20-01: Vendor chunking (vendor + utils chunks)
- [x] 20-02: Route lazy loading (16 pages)
- [x] 20-03: Heavy library lazy loading (vis-network, TipTap)

**Details:**

#### Plan 20-01: Vendor Chunking
- Added `manualChunks` configuration to vite.config.js
- Created `vendor` chunk: react, react-dom, react-router-dom, @tanstack/react-query (210 KB)
- Created `utils` chunk: date-fns, clsx, zustand, axios, react-hook-form (96 KB)
- Stable dependencies now cached separately from application code

#### Plan 20-02: Route Lazy Loading
- Converted all 16 page imports to React.lazy() dynamic imports
- Added PageLoader spinner component for loading states
- Wrapped routes in Suspense with fallback
- Main chunk reduced from 1,336 KB to 87 KB (93% reduction)

#### Plan 20-03: Heavy Library Lazy Loading
- Lazy loaded vis-network in FamilyTree page (526 KB deferred)
- Lazy loaded TipTap in NoteModal and QuickActivityModal (371 KB deferred)
- Extracted richTextUtils.js to break static import chain
- Initial load achieved: 435 KB (under 500 KB target)

---

## Milestone Summary

**Key Decisions:**

| Decision | Rationale |
|----------|-----------|
| Vendor chunk (React ecosystem) + Utils chunk | Stable deps cached separately from app code |
| Route-based lazy loading with React.lazy + Suspense | Pages load on demand, reducing initial load |
| Extract richTextUtils.js from RichTextEditor | Break static import chain for proper code splitting |
| Component-level Suspense for heavy libs | vis-network and TipTap load only when needed |

**Performance Results:**

| Metric | Before | After | Change |
|--------|--------|-------|--------|
| Initial JS | 1,646 KB | 435 KB | -73% |
| Initial Gzip | 480 KB | 128 KB | -73% |
| Main chunk | 1,646 KB | 87 KB | -95% |

**Chunk Breakdown:**

| Chunk | Size | Purpose |
|-------|------|---------|
| vendor.js | 210 KB | React, React Router, TanStack Query |
| utils.js | 96 KB | date-fns, axios, zustand, etc. |
| main.js | 87 KB | App shell |
| 16 page chunks | varies | Load on navigation |
| TreeVisualization | 526 KB | Load on family tree view |
| RichTextEditor | 371 KB | Load on note/activity modal |

**Issues Resolved:**
- None (clean execution)

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
