# Milestone v2.0: Multi-User

**Status:** ✅ SHIPPED 2026-01-13
**Phases:** 7-11
**Total Plans:** 20

## Overview

Transform Stadion from a single-user personal CRM into a multi-user platform combining Clay.earth's intimate relationship focus with Twenty CRM's collaborative features. Adds workspaces, sharing, and team collaboration while preserving privacy.

## Phases

### Phase 7: Data Model & Visibility System

**Goal:** Create foundational data structures for multi-user collaboration
**Depends on:** v1.0 Tech Debt Cleanup
**Plans:** 4 plans

Plans:
- [x] 07-01: Workspace CPT and taxonomy registration
- [x] 07-02: Visibility ACF field group for Person/Team/Important Date
- [x] 07-03: RONDO_Workspace_Members class for membership management
- [x] 07-04: RONDO_Access_Control updates for visibility checking

**Key deliverables:**
- Workspace CPT with REST API support
- `workspace_access` taxonomy linking contacts to workspaces
- `_visibility` post meta (private/workspace/shared)
- Membership storage in user meta `_workspace_memberships`

---

### Phase 8: Workspace & Team Infrastructure

**Goal:** Build workspace management and invitation system
**Depends on:** Phase 7
**Plans:** 3 plans

Plans:
- [x] 08-01: Workspace REST API endpoints
- [x] 08-02: Invitation system with email notifications
- [x] 08-03: Workspace term sync on publish

**Key deliverables:**
- Workspace CRUD REST endpoints
- Member management (add/remove/role change)
- 7-day expiring invitation tokens
- Email invitation templates
- Auto-sync workspace_access taxonomy terms

---

### Phase 9: Sharing UI & Permissions Interface

**Goal:** Create React components for sharing and visibility management
**Depends on:** Phase 8
**Plans:** 6 plans

Plans:
- [x] 09-01: VisibilitySelector component
- [x] 09-02: ShareModal component
- [x] 09-03: WorkspacesList page
- [x] 09-04: WorkspaceDetail page
- [x] 09-05: WorkspaceSettings page
- [x] 09-06: List view filtering integration

**Key deliverables:**
- ShareModal with user search and permission levels
- VisibilitySelector dropdown (private/workspace/shared)
- Full workspace management pages
- List filtering by workspace and share status
- TanStack Query hooks for workspaces

---

### Phase 10: Collaborative Features

**Goal:** Enable team collaboration with notes, mentions, and notifications
**Depends on:** Phase 9
**Plans:** 5 plans

Plans:
- [x] 10-01: Note visibility controls
- [x] 10-02: @Mentions infrastructure
- [x] 10-03: Mention notifications
- [x] 10-04: Workspace iCal feed
- [x] 10-05: Workspace activity digest

**Key deliverables:**
- Private/shared toggle for notes
- MentionInput component with react-mentions
- Workspace member autocomplete
- Mention notification preferences (digest/immediate/never)
- Workspace-scoped iCal calendar feeds
- Daily digest includes mentions and workspace activity

---

### Phase 11: Migration, Testing & Polish

**Goal:** Migration tools and documentation for production deployment
**Depends on:** Phase 10
**Plans:** 2 plans

Plans:
- [x] 11-01: Multi-user migration CLI
- [x] 11-02: Multi-user documentation

**Key deliverables:**
- `wp prm multiuser migrate` command
- `wp prm multiuser validate` command
- `docs/multi-user.md` comprehensive guide
- Updated `docs/access-control.md`

---

## Milestone Summary

**Key Decisions:**

| Decision | Rationale | Outcome |
|----------|-----------|---------|
| Workspaces as CPT | Leverages WordPress CRUD, REST API, revisions | ✓ Good |
| Membership in user meta | Easy "my workspaces" query, survives workspace queries | ✓ Good |
| workspace_access taxonomy | Native WP query support, efficient lookups | ✓ Good |
| Visibility in post meta | Simple flag per contact, easy filtering | ✓ Good |
| Default visibility = private | Backward compatible, preserves single-user behavior | ✓ Good |
| Invitation tokens 32-char | Secure, URL-safe, no special characters | ✓ Good |
| Invites expire 7 days | Reasonable timeframe for action | ✓ Good |
| Mention markup @[Name](id) | react-mentions standard format | ✓ Good |
| Mentions default to digest | Reduces notification fatigue | ✓ Good |

**Issues Resolved:**
- Backward compatibility with single-user mode
- Permission chain complexity (author > private > workspace > shared > deny)
- Workspace calendar scope (contacts shared with workspace only)

**Issues Deferred:**
- N+1 query optimization for workspace listings
- Real-time collaboration (WebSockets)
- Mobile app workspace support

**Technical Debt Incurred:**
- None significant — clean implementation following WordPress patterns

---

_For current project status, see .planning/ROADMAP.md_
