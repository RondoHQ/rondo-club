# Milestone v13.0: Discipline Cases

**Status:** SHIPPED 2026-02-03
**Phases:** 132-134
**Total Plans:** 5

## Overview

This milestone adds discipline case tracking to Stadion. Cases are synced from Sportlink (read-only in UI) and displayed in a dedicated list page and on person profiles. Access is restricted via a new `fairplay` capability, allowing sensitive disciplinary data to be visible only to authorized users.

## Phases

### Phase 132: Data Foundation

**Goal**: Backend infrastructure for discipline case data storage and API access
**Depends on**: Nothing (foundation phase)
**Requirements**: DATA-01, DATA-02, DATA-03, DATA-04
**Plans**: 1 plan

Plans:
- [x] 132-01-PLAN.md — Register discipline_case CPT, seizoen taxonomy, and ACF fields

**Details:**
- `discipline_case` CPT with Dutch labels (Tuchtzaak/Tuchtzaken)
- `seizoen` taxonomy (non-hierarchical, REST-enabled)
- ACF field group with 11 fields for discipline case data
- Unique dossier_id validation filter
- Current season helper methods (`set_current_season`, `get_current_season`)

### Phase 133: Access Control

**Goal**: Capability-based access restriction for discipline case data
**Depends on**: Phase 132
**Requirements**: ACCESS-01, ACCESS-02, ACCESS-03, ACCESS-04
**Plans**: 1 plan

Plans:
- [x] 133-01-PLAN.md — Register fairplay capability and implement UI access control

**Details:**
- `fairplay` capability registered for administrators
- REST API exposes `can_access_fairplay` in user endpoint
- FairplayRoute component protects sensitive routes
- Conditional navigation (Tuchtzaken menu item)
- Conditional person detail tab (Tuchtzaken tab)

### Phase 134: Discipline Cases UI

**Goal**: Complete user interface for viewing discipline cases
**Depends on**: Phase 132, Phase 133
**Requirements**: LIST-01, LIST-02, LIST-03, LIST-04, LIST-05, PERSON-01, PERSON-02, PERSON-03, PERSON-04
**Plans**: 3 plans

Plans:
- [x] 134-01-PLAN.md — API integration and React hooks for discipline cases
- [x] 134-02-PLAN.md — List page with table view and season filter
- [x] 134-03-PLAN.md — Person detail tab integration

**Details:**
- API client methods: getDisciplineCases, getSeasons, getCurrentSeason
- TanStack Query hooks: useDisciplineCases, usePersonDisciplineCases, useSeasons, useCurrentSeason
- REST endpoint: GET /rondo/v1/current-season
- DisciplineCaseTable reusable component with expandable rows
- DisciplineCasesList page with season filter dropdown
- PersonDetail Tuchtzaken tab shows person's discipline cases

---

## Milestone Summary

**Key Decisions:**
- Use Post Object field for person link (not Relationship field) — cleaner REST response
- Store single charge code (not multi-select) — matches Sportlink data model
- seizoen as shared taxonomy — enables future reuse across features
- Client-side person filtering — more reliable than ACF meta queries
- FairplayRoute wrapper component — follows existing route protection patterns

**Issues Resolved:**
- None — clean implementation

**Issues Deferred:**
- Capability management UI (CAPMGMT-01, CAPMGMT-02) — deferred to future milestone
- List enhancements: team filter, export, search (LISTEXT-01/02/03) — deferred to future milestone

**Technical Debt Incurred:**
- None — all phases implemented cleanly with no TODOs or stubs

---

*For current project status, see .planning/ROADMAP.md*
